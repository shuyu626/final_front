import{_ as Ve}from"./inputText-Bqz_RjiJ.js";import{G as ye,a6 as be,a7 as _e,K as xe,_ as he,a8 as we,a9 as ke,s as x,n as u,A as te,N as Ce,aa as le,b as e,ab as Se,d as Pe,i as ze,O as Ee,r as se,o as f,c as I,g as r,e as A,w as a,m as X,v as Ue,x as $e,ac as oe,l as c,F as R,p as Me,a as p,C as re,V as ne,T as ie,h as Fe,f as Te,k as Be,j as Ie,t as Y,a5 as Ae,B as q,R as Re,y as qe,ad as Oe,D as De,E as Ge}from"./index-CBnRXN3v.js";import{c as Le,a as z,e as Ne,u as je,b as _,V as Qe}from"./index.esm--TZUbTsY.js";import{_ as He}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as de}from"./VContainer-C-AwBdJC.js";import{V as Z,a as d}from"./VRow-bDIBFcJw.js";import{V as Ke}from"./VPagination-kdY7kwiS.js";import{V as We,a as ue}from"./VSelect-CnYgL3Au.js";import{V as Je}from"./VTextarea-C0pveaq7.js";import{V as Xe}from"./VBreadcrumbs-2gCPkSDU.js";import{V as Ye,a as Ze}from"./VSlideGroupItem-5PD-TUFg.js";import{d as ea}from"./VMenu-14Iye73x.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./ssrBoot-BRbhGmI-.js";const aa=ye({id:String,text:String,...be(_e({closeOnBack:!1,location:"end",locationStrategy:"connected",eager:!0,minWidth:0,offset:10,openOnClick:!1,openOnHover:!0,origin:"auto",scrim:!1,scrollStrategy:"reposition",transition:!1}),["absolute","persistent"])},"VTooltip"),ta=xe()({name:"VTooltip",props:aa(),emits:{"update:modelValue":o=>!0},setup(o,O){let{slots:V}=O;const w=he(o,"modelValue"),{scopeId:k}=we(),D=ke(),E=x(()=>o.id||`v-tooltip-${D}`),U=u(),C=x(()=>o.location.split(" ").length>1?o.location:o.location+" center"),$=x(()=>o.origin==="auto"||o.origin==="overlap"||o.origin.split(" ").length>1||o.location.split(" ").length>1?o.origin:o.origin+" center"),M=x(()=>o.transition?o.transition:w.value?"scale-transition":"fade-transition"),v=x(()=>te({"aria-describedby":E.value},o.activatorProps));return Ce(()=>{const G=le.filterProps(o);return e(le,te({ref:U,class:["v-tooltip",o.class],style:o.style,id:E.value},G,{modelValue:w.value,"onUpdate:modelValue":g=>w.value=g,transition:M.value,absolute:!0,location:C.value,origin:$.value,persistent:!0,role:"tooltip",activatorProps:v.value,_disableGlobalStack:!0},k),{activator:V.activator,default:function(){var S;for(var g=arguments.length,F=new Array(g),y=0;y<g;y++)F[y]=arguments[y];return((S=V.default)==null?void 0:S.call(V,...F))??o.text}})}),Se({},U)}}),h=o=>(De("data-v-4f3f1984"),o=o(),Ge(),o),la=h(()=>c("label",{class:"form-label"},"活動名稱：",-1)),sa=h(()=>c("label",{class:"form-label"},"活動地點：",-1)),oa=h(()=>c("label",{class:"form-label"},"活動類別：",-1)),ra=h(()=>c("label",{class:"form-label"},"活動時間：",-1)),na=h(()=>c("label",{class:"form-label"},"主辦單位：",-1)),ia=h(()=>c("label",{class:"form-label"},"活動介紹：",-1)),da={class:"mx-auto"},ua={class:"text-center"},ca={class:"mx-auto",style:{width:"100%"}},ma={class:"d-flex justify-content-center b-1 mt-2 mb-2 bg-white img-container"},fa={class:"text-center my-5"},ce=12,pa={__name:"findEvent",setup(o){const O=Pe(),{api:V,apiAuth:w}=Me(),k=ze(),D=u([{title:"首頁",disabled:!1,href:"/"},{title:"活動分享",disabled:!0}]),E=["兒童","青少年","育兒","長照","精神","照顧","就學","就業","身障","親職教育","早療","紓壓","居住","醫療","司法","社工","其他"],U=u([{name:"兒童",selected:!1},{name:"青少年",selected:!1},{name:"育兒",selected:!1},{name:"長照",selected:!1},{name:"精神",selected:!1},{name:"照顧",selected:!1},{name:"就學",selected:!1},{name:"就業",selected:!1},{name:"身障",selected:!1},{name:"親職教育",selected:!1},{name:"早療",selected:!1},{name:"紓壓",selected:!1},{name:"居住",selected:!1},{name:"醫療",selected:!1},{name:"司法",selected:!1},{name:"社工",selected:!1},{name:"其他",selected:!1}]),C=u(1),$=u(1),M=u(null),v=u(!1),G=s=>{v.value=!0},g=()=>{v.value=!1,ee(),M.value.deleteFileRecord()};Ee(()=>{v||ee()});const F=Le({title:z().required("活動標題必填"),date:z().required("活動日期必填"),address:z().required("活動地點必填"),category:Ne().required("活動分類必填"),organizer:z().required("主辦單位必填"),description:z().required("活動介紹必填")}),{handleSubmit:y,isSubmitting:S,resetForm:ee}=je({validationSchema:F,initialValues:{title:"",date:"",address:"",category:[],organizer:"",description:""}}),L=_("title"),N=_("date"),j=_("address"),Q=_("category"),H=_("organizer"),K=_("description"),b=u([]),ae=u([]),me=y(async s=>{var t,i,m;if(!((t=b.value[0])!=null&&t.error)&&!(b.value.length<1))try{const n=new FormData;n.append("title",s.title),n.append("date",s.date),n.append("address",s.address),n.append("category",s.category),n.append("organizer",s.organizer),n.append("description",s.description),b.value.length>0&&n.append("image",b.value[0].file),console.log(s.category),await w.post("/event",n),k({text:"新增成功",snackbarProps:{color:"green"}}),g(),J()}catch(n){console.log(n),k({text:((m=(i=n==null?void 0:n.response)==null?void 0:i.data)==null?void 0:m.message)||"發生錯誤",snackbarProps:{color:"red"}})}}),T=u([]),fe=s=>{const t=T.value.indexOf(s);t===-1?T.value.push(s):T.value.splice(t,1)},pe=(s,t)=>{fe(s),t()},ve=x(()=>{const s=B.value?B.value.toLowerCase():"";return W.value.filter(t=>{const i=T.value.every(n=>t.category.includes(n)),m=t.title.toLowerCase().includes(s)||t.organizer.toLowerCase().includes(s);return i&&m})}),B=u(""),W=u([]),J=async()=>{var s,t;try{const{data:i}=await V.get("/event",{params:{itemssPerPage:ce,page:C.value}});$.value=Math.ceil(i.result.total/ce),W.value.splice(0,W.value.length,...i.result.data)}catch(i){console.log(i),k({text:((t=(s=i==null?void 0:i.response)==null?void 0:s.data)==null?void 0:t.message)||"發生錯誤",snackbarProps:{color:"red"}})}};return J(),(s,t)=>{const i=se("vue-file-agent"),m=Ve,n=se("router-link");return f(),I(R,null,[r(O).isLogin?(f(),A(X,{key:0,onClick:t[0]||(t[0]=l=>G()),class:"bg-third b-1 p-0",variant:"text",id:"create"},{default:a(()=>[e(re,{size:"x-large"},{default:a(()=>[p("mdi-plus")]),_:1}),e(ta,{activator:"parent",location:"top"},{default:a(()=>[p(" 新增活動 ")]),_:1})]),_:1})):Ue("",!0),e($e,{"max-width":"700",modelValue:v.value,"onUpdate:modelValue":t[10]||(t[10]=l=>v.value=l)},{default:a(()=>[e(ne,null,{default:a(()=>[e(de,null,{default:a(()=>[e(ie,{class:"font-weight-black text-center text-h4"},{default:a(()=>[p("新增活動")]),_:1}),e(Fe,null,{default:a(()=>[e(Qe,{onSubmit:Te(r(me),["prevent"]),disabled:r(S)},{default:a(()=>[e(Z,null,{default:a(()=>[e(d,null,{default:a(()=>[e(i,{modelValue:b.value,"onUpdate:modelValue":t[1]||(t[1]=l=>b.value=l),"raw-model-value":ae.value,"onUpdate:rawModelValue":t[2]||(t[2]=l=>ae.value=l),accept:"image/jpeg,image/png",deletable:"","max-size":"1MB","help-text":"選擇檔案或拖曳到這裡","error-text":{type:"檔案格式不支援",size:"檔案大小不能超過 1MB"},ref_key:"fileAgent",ref:M},null,8,["modelValue","raw-model-value"])]),_:1})]),_:1}),e(Z,null,{default:a(()=>[e(d,{cols:"4",class:"my-auto text-center"},{default:a(()=>[la]),_:1}),e(d,{cols:"8"},{default:a(()=>[e(m,{modelValue:r(L).value.value,"onUpdate:modelValue":t[3]||(t[3]=l=>r(L).value.value=l),"error-messages":r(L).errorMessage.value,density:s.$vuetify.display.xs?"compact":"comfortable"},null,8,["modelValue","error-messages","density"])]),_:1}),e(d,{cols:"4",class:"my-auto text-center"},{default:a(()=>[sa]),_:1}),e(d,{cols:"8"},{default:a(()=>[e(m,{modelValue:r(j).value.value,"onUpdate:modelValue":t[4]||(t[4]=l=>r(j).value.value=l),"error-messages":r(j).errorMessage.value,density:s.$vuetify.display.xs?"compact":"comfortable"},null,8,["modelValue","error-messages","density"])]),_:1}),e(d,{cols:"4",class:"my-auto text-center"},{default:a(()=>[oa]),_:1}),e(d,{cols:"8"},{default:a(()=>[e(We,{modelValue:r(Q).value.value,"onUpdate:modelValue":t[5]||(t[5]=l=>r(Q).value.value=l),"error-messages":r(Q).errorMessage.value,label:"選擇",variant:"outlined",density:s.$vuetify.display.xs?"compact":"comfortable",dense:"",items:E,"hide-details":"",multiple:""},null,8,["modelValue","error-messages","density"])]),_:1}),e(d,{cols:"4",class:"my-auto text-center px-0"},{default:a(()=>[ra]),_:1}),e(d,{cols:"8"},{default:a(()=>[e(m,{modelValue:r(N).value.value,"onUpdate:modelValue":t[6]||(t[6]=l=>r(N).value.value=l),"error-messages":r(N).errorMessage.value,density:s.$vuetify.display.xs?"compact":"comfortable"},null,8,["modelValue","error-messages","density"])]),_:1}),e(d,{cols:"4",class:"my-auto text-center"},{default:a(()=>[na]),_:1}),e(d,{cols:"8"},{default:a(()=>[e(m,{modelValue:r(H).value.value,"onUpdate:modelValue":t[7]||(t[7]=l=>r(H).value.value=l),"error-messages":r(H).errorMessage.value,density:s.$vuetify.display.xs?"compact":"comfortable"},null,8,["modelValue","error-messages","density"])]),_:1}),e(d,{cols:"4",class:"text-center"},{default:a(()=>[ia]),_:1}),e(d,{cols:"8"},{default:a(()=>[e(Je,{"auto-grow":"",label:"輸入文字",variant:"outlined",clearable:"","hide-details":"",modelValue:r(K).value.value,"onUpdate:modelValue":t[8]||(t[8]=l=>r(K).value.value=l),"error-messages":r(K).errorMessage.value,density:s.$vuetify.display.xs?"compact":"comfortable"},null,8,["modelValue","error-messages","density"])]),_:1})]),_:1}),e(Be,null,{default:a(()=>[c("div",da,[e(X,{variant:"text",class:"rounded-xl b-1 bg-accent",density:"comfortable",type:"submit",loading:r(S)},{default:a(()=>[p("送出")]),_:1},8,["loading"]),e(X,{text:"取消",variant:"text",class:"rounded-xl b-1 bg-info",density:"comfortable",onClick:t[9]||(t[9]=l=>g())})])]),_:1})]),_:1},8,["onSubmit","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(de,null,{default:a(()=>[e(Xe,{items:D.value},{divider:a(()=>[e(re,{icon:"mdi-chevron-right"})]),_:1},8,["items"])]),_:1}),e(oe,{"max-width":"700px",class:"mx-auto"},{default:a(()=>[e(Ie,{variant:"outlined",label:"搜尋","prepend-inner-icon":"mdi-magnify","hide-details":"","single-line":"",density:"comfortable",clearable:"",class:"bg-white mx-5 mt-5 my-5",modelValue:B.value,"onUpdate:modelValue":t[11]||(t[11]=l=>B.value=l)},null,8,["modelValue"])]),_:1}),c("div",ua,[e(oe,{"max-width":"900",class:"mx-auto"},{default:a(()=>[e(Ye,{class:"w-100 mx-auto d-inline-block"},{default:a(()=>[e(ea,{"show-arrows":"",multiple:"","mobile-breakpoint":"xxl"},{default:a(()=>[(f(!0),I(R,null,Y(U.value,l=>(f(),A(Ze,{key:l.name},{default:a(({isSelected:P,toggle:ge})=>[e(ue,{style:Ae({backgroundColor:P?"#616161":"#EEEEEE",color:P?"white":"black"}),class:"ma-2",onClick:()=>pe(l.name,ge)},{default:a(()=>[p(q(l.name),1)]),_:2},1032,["style","onClick"])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),c("div",ca,[e(Z,{class:"my-3 d-flex"},{default:a(()=>[(f(!0),I(R,null,Y(ve.value,l=>(f(),A(d,{cols:"12",sm:"6",md:"4",lg:"3",key:l._id,class:"mx-0"},{default:a(()=>[e(n,{to:"/event/"+l._id,style:{"text-decoration":"none"}},{default:a(()=>[e(ne,{variant:"flat",color:"third",class:"b-1 card-size"},{default:a(()=>[e(Re,{class:"p-5 text-left"},{default:a(()=>[c("div",ma,[e(qe,{src:l.image,contain:""},null,8,["src"])]),e(ie,{class:"font-weight-black",style:{"font-size":"1.1rem"}},{default:a(()=>[p(q(l.title),1)]),_:2},1024),e(Oe,{style:{width:"200px"},class:"font-weight-black"},{default:a(()=>[p(q(l.organizer),1)]),_:2},1024),(f(!0),I(R,null,Y(l.category,P=>(f(),A(ue,{density:"compact",class:"mt-2 me-1",key:P},{default:a(()=>[p(q(P),1)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),_:2},1032,["to"])]),_:2},1024))),128))]),_:1})])]),c("div",fa,[e(Ke,{modelValue:C.value,"onUpdate:modelValue":[t[12]||(t[12]=l=>C.value=l),J],length:$.value,rounded:"circle"},null,8,["modelValue","length"])])],64)}}},Ea=He(pa,[["__scopeId","data-v-4f3f1984"]]);export{Ea as default};
