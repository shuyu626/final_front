import{_ as Q}from"./appButton-CTVatjU1.js";import{_ as $}from"./resourceDialog-rylncUf2.js";import{q as H,i as J,n as u,t as K,P as I,r as O,o as i,c as h,b as e,w as t,F as V,D as W,g as X,e as g,x as Y,a6 as z,a5 as L,a as d,v as w,j as Z,p as ee,C as b,V as ae,l as le,z as te,T as se,a7 as oe,h as ne}from"./index-Cmg5EJpm.js";import{_ as re}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as P,a as ue}from"./VContainer-rTUoaqtf.js";import{V as ie}from"./VNavigationDrawer-Cy5UADmv.js";import{V as me}from"./VBreadcrumbs-ATQeAySf.js";import{a as de,b as U}from"./VTooltip-D9eIfujP.js";import{V as ce}from"./VSlideGroup-DBRkrNvd.js";import{a as B}from"./VSelect-DKdnXkFj.js";import{V as D,a as C}from"./VRow-C0U_Zj0G.js";import{V as fe}from"./VPagination-CyGom7i_.js";import{a as pe}from"./_commonjsHelpers-D9ffGxaA.js";import{V as M}from"./VCheckbox-BH_diFur.js";import"./inputText-DdAYUr74.js";import"./index.esm-CdhQwqON.js";import"./ssrBoot-tKZiGofa.js";const _e={class:"d-flex justify-content-center b-1 item-img"},T=8,ve={__name:"shareMaterial",setup(he){const{mobile:A}=H(),{api:N}=ee(),q=J(),F=u([{title:"首頁",disabled:!1,to:"/"},{title:"我想分享",disabled:!0}]),r=u([{name:"食品",selected:!1},{name:"服飾配件",selected:!1},{name:"日用品",selected:!1},{name:"家具",selected:!1},{name:"輔具",selected:!1},{name:"教育用品",selected:!1},{name:"嬰幼兒用品",selected:!1},{name:"電器",selected:!1},{name:"休閒用品",selected:!1},{name:"其他",selected:!1}]),n=u(!0),f=u([]),c=u(""),k=u(1),E=u(1),p=u([]),m=()=>{let o=r.value.filter(a=>a.selected).map(a=>a.name);const s=c.value?c.value.toLowerCase():"";n.value?f.value=p.value.filter(a=>a.name.toLowerCase().includes(s)||a.organizer.toLowerCase().includes(s)):o.length===0&&s.trim()===""?f.value=[]:f.value=p.value.filter(a=>{const x=o.length===0||o.includes(a.category),y=a.name.toLowerCase().includes(s)||a.organizer.toLowerCase().includes(s);return x&&y})},S=()=>{r.value.forEach(o=>{o.selected=n.value}),m()};K(()=>{S()});const G=(o,s)=>{n.value?(n.value=!1,r.value.forEach(a=>{a.selected=a===o})):(o.selected=!o.selected,n.value=r.value.every(a=>a.selected)),s(),m()},R=o=>{n.value=!n.value,r.value.forEach(s=>{s.selected=n.value}),o&&o(),m()};I(c,()=>{m()}),I(()=>r.value.map(o=>o.selected),()=>{m(),n.value=r.value.every(o=>o.selected)},{deep:!0});const _=async()=>{var o,s;try{const{data:a}=await N.get("/material/share",{params:{itemsPerPage:T,page:k.value}});E.value=Math.ceil(a.result.total/T),p.value.splice(0,p.value.length,...a.result.data),m()}catch(a){console.log(a),q({text:((s=(o=a==null?void 0:a.response)==null?void 0:o.data)==null?void 0:s.message)||"發生錯誤",snackbarProps:{color:"red"}})}};return _(),(o,s)=>{const a=$,x=O("router-link"),y=Q;return i(),h(V,null,[e(P,{class:"h-100"},{default:t(()=>[e(me,{items:F.value},{divider:t(()=>[e(W,{icon:"mdi-chevron-right"})]),_:1},8,["items"]),X(A)?(i(),g(a,{key:0,onUpdate:_})):Y("",!0),e(z,{"max-width":"900",class:"mx-auto d-xl-none d-lg-block"},{default:t(()=>[e(de,{class:"w-100 mx-auto d-inline-block"},{default:t(()=>[e(ce,{"show-arrows":"",multiple:"","mobile-breakpoint":"xxl"},{default:t(()=>[e(U,null,{default:t(({toggle:l})=>[e(B,{style:L({backgroundColor:n.value?"#616161":"#EEEEEE",color:n.value?"white":"black"}),class:"ma-2",onClick:()=>R(l)},{default:t(()=>[d(" 全部 ")]),_:2},1032,["style","onClick"])]),_:1}),(i(!0),h(V,null,w(r.value,l=>(i(),g(U,{key:l.name},{default:t(({isSelected:v,toggle:j})=>[e(B,{style:L({backgroundColor:n.value||v?"#616161":"#EEEEEE",color:n.value||v?"white":"black"}),class:"ma-2",onClick:()=>G(l,j)},{default:t(()=>[d(b(l.name),1)]),_:2},1032,["style","onClick"])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),e(D,{class:"pl-lg-15 h-100"},{default:t(()=>[(i(!0),h(V,null,w(f.value,l=>(i(),g(C,{key:l.id,cols:"12",md:"6"},{default:t(()=>[e(ae,{variant:"flat"},{default:t(()=>[e(D,{class:"align-content-center h-100 my-4"},{default:t(()=>[e(C,{cols:"6",sm:"7",md:"6",class:"ml-5 ml-sm-0"},{default:t(()=>[e(x,{to:"/material/share/"+l._id},{default:t(()=>[le("div",_e,[e(te,{src:l.image,contain:""},null,8,["src"])])]),_:2},1032,["to"])]),_:2},1024),e(C,{cols:"5",sm:"5",md:"5"},{default:t(()=>[e(se,{class:"text-h6 text-md-h6 font-weight-bold ms-md-1"},{default:t(()=>[d(b(l.name),1)]),_:2},1024),e(oe,{style:{"font-size":"16px"},class:"ms-md-1"},{default:t(()=>[d(b(l.organizer),1)]),_:2},1024),e(ne,{style:{"font-size":"15px"},class:"ms-md-1 pt-sm-1 pb-sm-2"},{default:t(()=>[d("數量："+b(l.quantity),1)]),_:2},1024),e(y,{text:"詳細說明",class:"bg-third ms-md-4 ms-3",to:"/material/share/"+l._id},null,8,["to"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),e(C,{cols:"12"},{default:t(()=>[e(fe,{modelValue:k.value,"onUpdate:modelValue":[s[0]||(s[0]=l=>k.value=l),_],length:E.value,rounded:"circle"},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1}),e(ie,{class:"bg-primary b-1 text-center",width:"300"},{default:t(()=>[e(a,{"card-title":"分享物資","number-title":"數量","description-title":"物資概況",onUpdate:_}),e(z,null,{default:t(()=>[e(Z,{variant:"outlined",label:"搜尋","prepend-inner-icon":"mdi-magnify","hide-details":"","single-line":"",density:"comfortable",clearable:"",width:"250",class:"bg-white mx-auto mt-5 my-5",modelValue:c.value,"onUpdate:modelValue":s[1]||(s[1]=l=>c.value=l)},null,8,["modelValue"])]),_:1}),e(pe,{class:"text-h5 font-weight-black text-left ml-2"},{default:t(()=>[d("物資類別")]),_:1}),e(ue,{thickness:"2",length:"250",class:"mx-auto"}),e(P,null,{default:t(()=>[e(M,{modelValue:n.value,"onUpdate:modelValue":s[2]||(s[2]=l=>n.value=l),label:"所有物品",onChange:s[3]||(s[3]=l=>S()),"hide-details":"",density:"comfortable"},null,8,["modelValue"]),(i(!0),h(V,null,w(r.value,l=>(i(),g(M,{key:l.name,modelValue:l.selected,"onUpdate:modelValue":v=>l.selected=v,label:l.name,onChange:m,"hide-details":"",class:"ml-5",density:"comfortable"},null,8,["modelValue","onUpdate:modelValue","label"]))),128))]),_:1})]),_:1})],64)}}},Me=re(ve,[["__scopeId","data-v-f9df6f82"]]);export{Me as default};
