import{_ as P}from"./appButton-NIRzHUQR.js";import{d as L,a3 as E,i as N,n as x,P as T,o as f,e as v,w as a,b as e,C as A,y as D,V as O,T as R,a as t,B as r,h as n,g as k,a4 as V,a5 as M,v as w,c as U,t as q,F as G,m as H,l as g,p as J,D as K,E as Q}from"./index-BYCDU5qd.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as X,a as Y}from"./VContainer-Cm1k3jue.js";import{V as Z}from"./VBreadcrumbs-yxURR4-b.js";import{a as l,V as b}from"./VRow-C1zMKUOG.js";const B=m=>(K("data-v-309ae299"),m=m(),Q(),m),$=B(()=>g("h2",{class:"info"},"活動介紹",-1)),ee={class:"b-1 info pa-4 mb-5"},ae=B(()=>g("h3",{class:"info d-sm-none mb-2"},"活動介紹",-1)),te={style:{"white-space":"pre-line"},class:"text-sm-body-1 w-100"},se={__name:"[id]",props:{event:Object,isFavorite:Boolean},setup(m){const _=L(),{api:F,apiAuth:h}=J(),C=E(),p=N(),I=x([{title:"首頁",disabled:!1,to:"/"},{title:"活動分享",disabled:!1,to:"/event/findEvent"},{title:"物資詳情",disabled:!0}]),s=x({_id:"",title:"",date:"",address:"",category:"",organizer:"",description:"",image:""}),i=x(m.isFavorite),S=async()=>{var o,u;try{const{data:c}=await F.get("/event/"+C.params.id);Object.assign(s.value,c.result),console.log(s.value.category),_.isLogin&&(i.value=await j(s.value._id))}catch(c){console.log(c),p({text:((u=(o=c==null?void 0:c.response)==null?void 0:o.data)==null?void 0:u.message)||"發生錯誤",snackbarProps:{color:"red"}})}},j=async o=>{var u,c;try{const{data:d}=await h.get("/user/mark");return d.some(z=>z._id===o)}catch(d){return console.log(d),p({text:((c=(u=d==null?void 0:d.response)==null?void 0:u.data)==null?void 0:c.message)||"發生錯誤",snackbarProps:{color:"red"}}),!1}},y=async()=>{if(!_.isLogin){p({text:"請登入後再收藏活動",snackbarProps:{color:"red"}});return}try{const o=await h.post("/user/toggleFavorite",{eventId:s.value._id});i.value=o.data.isFavorite,console.log(i.value),p({text:o.data.isFavorite?"已收藏":"取消收藏",snackbarProps:{color:o.data.isFavorite?"#F5B4B4":"info"}})}catch(o){console.error("收藏操作失败",o),p({text:"收藏操作失败",snackbarProps:{color:"red"}})}};return T(S),(o,u)=>{const c=P;return f(),v(X,null,{default:a(()=>[e(Z,{items:I.value},{divider:a(()=>[e(A,{icon:"mdi-chevron-right"})]),_:1},8,["items"]),e(b,{"justify-center":"",class:"mt-2 flex-column flex-sm-row"},{default:a(()=>[e(l,{cols:"12",sm:"6",md:"5",lg:"6",class:"w-66 w-sm-100 d-flex justify-center align-start mx-auto",style:{"margin-top":"20px"}},{default:a(()=>[e(D,{src:s.value.image,class:"image",contain:""},null,8,["src"])]),_:1}),e(l,{cols:"12",sm:"6",md:"7",lg:"6"},{default:a(()=>[e(O,{variant:"flat",class:"d-none d-sm-block"},{default:a(()=>[e(R,{class:"card-title",style:{"white-space":"pre-line"}},{default:a(()=>[t("活動名稱："+r(s.value.title),1)]),_:1}),e(Y,{thickness:"0"}),e(n,{class:"card-text"},{default:a(()=>[t("活動時間")]),_:1}),e(n,{class:"card-text"},{default:a(()=>[t(r(s.value.date),1)]),_:1}),e(n,{class:"card-text"},{default:a(()=>[t("活動地點")]),_:1}),e(n,{class:"card-text"},{default:a(()=>[t(r(s.value.address),1)]),_:1}),e(n,{class:"card-text"},{default:a(()=>[t("活動類別")]),_:1}),e(n,{class:"card-text"},{default:a(()=>[t(r(Object.values(s.value.category).join(", ")),1)]),_:1}),e(n,{class:"card-text"},{default:a(()=>[t("主辦單位")]),_:1}),e(n,{class:"card-text"},{default:a(()=>[t(r(s.value.organizer),1)]),_:1}),e(n),e(n),e(n),k(_).isLogin?(f(),v(c,{key:0,"prepend-icon":i.value?"mdi-bookmark":"mdi-bookmark-outline",text:i.value?"已收藏":"我要收藏",class:V([i.value?"me-15":"me-15 bg-info","text-body-3"]),style:M(i.value?{backgroundColor:"#F5B4B4"}:{}),onClick:y,width:"125",height:"32",ripple:!1},null,8,["prepend-icon","text","class","style"])):w("",!0)]),_:1}),e(b,{class:"pl-4 d-flex d-sm-none"},{default:a(()=>[e(l,{cols:"12",class:"font-weight-black card-title",style:{"white-space":"pre-line"}},{default:a(()=>[t("活動名稱："+r(s.value.title),1)]),_:1}),e(l,{cols:"4",class:"card-text"},{default:a(()=>[t("活動時間")]),_:1}),e(l,{cols:"8",class:"card-text"},{default:a(()=>[t(r(s.value.date),1)]),_:1}),e(l,{cols:"4",class:"card-text"},{default:a(()=>[t("活動地點")]),_:1}),e(l,{cols:"8",class:"card-text"},{default:a(()=>[t(r(s.value.address),1)]),_:1}),e(l,{cols:"4",class:"card-text"},{default:a(()=>[t("活動類別")]),_:1}),(f(!0),U(G,null,q(s.value.category,d=>(f(),v(l,{cols:"8",class:"card-text",key:d},{default:a(()=>[t(r(d),1)]),_:2},1024))),128)),e(l,{cols:"4",class:"card-text"},{default:a(()=>[t("主辦單位")]),_:1}),e(l,{cols:"8",class:"card-text"},{default:a(()=>[t(r(s.value.organizer),1)]),_:1}),e(l,{cols:"12",class:"mt-6",style:{position:"relative"}},{default:a(()=>[k(_).isLogin?(f(),v(H,{key:0,color:"medium-emphasis",icon:i.value?"mdi-heart":"mdi-heart-outline",class:V([i.value?"me-5 mb-2 bg-red-lighten-4":"me-5 mb-2 bg-info","bg-transparent xs-btn m-0"]),size:"small",onClick:y,elevation:"0",variant:"text"},null,8,["icon","class"])):w("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),e(b,null,{default:a(()=>[e(l,{cols:"12",class:"d-none d-sm-flex mt-lg-2 py-0"},{default:a(()=>[$]),_:1}),e(l,{cols:"12"},{default:a(()=>[g("div",ee,[ae,g("p",te,r(s.value.description),1)])]),_:1})]),_:1})]),_:1})}}},ue=W(se,[["__scopeId","data-v-309ae299"]]);export{ue as default};
