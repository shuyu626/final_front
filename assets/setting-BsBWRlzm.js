import{a as N,V as o,_ as Ge}from"./breadcrumbs-BLWK-pqN.js";import{i as pe,n as i,N as qe,r as re,o as $,c as D,b as e,w as t,R as xe,S as be,l as d,A as P,a as L,m as ee,V as ce,T as _e,h as Pe,f as Ue,g as s,k as Ie,x as ze,F as O,p as ge,u as Qe,e as ie,t as te,j as Le,as as Te,C as Ye,D as Ze,Q as Je,O as Xe,ar as et,v as tt}from"./index-CzRNNlIw.js";import{c as Se,a as T,u as Ce,b as M,V as Me,f as Ee,e as ve}from"./index.esm-CSTT7WTR.js";import{_ as Ae}from"./inputText-BZbIDHrA.js";import{_ as $e}from"./search-DtELWfcf.js";import{V as Ve}from"./VDataTableServer-BW9JOVPs.js";import{V as ke,a as se}from"./VContainer-WFWzqaWf.js";import{V as Be}from"./VSelect-Ccr-Nzxg.js";import{V as Re}from"./VTextarea-CvnaPNSj.js";import{_ as lt}from"./appButton-xI9T9Bdk.js";import{_ as je}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as Ke,a as He}from"./VToolbar-gysEO12v.js";import{_ as at}from"./submitButton-DK8pJ4DP.js";import{V as st,a as ot,c as nt}from"./leaflet-src-YpobalhV.js";import{a as fe,V as ye}from"./VChip-CAAVSUsS.js";import{a as rt,b as we,c as ut,V as he}from"./VTabs-dOmAhbVz.js";import{V as dt}from"./VNavigationDrawer-DrA-xpNF.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./VPagination-eq3Eeb7z.js";import"./VMenu-B5b_jg2J.js";import"./ssrBoot-D1ab97FM.js";import"./VSlideGroup-BvokDqPp.js";const it=d("h2",{class:"my-5 bg-accent text-center"},"活動管理",-1),ct={style:{width:"220px"}},mt={style:{width:"350px"},class:"py-2"},pt={style:{width:"80px"}},gt=d("label",{class:"form-label"},"活動名稱：",-1),vt=d("label",{class:"form-label"},"活動地點：",-1),ft=d("label",{class:"form-label"},"活動類別：",-1),yt=d("label",{class:"form-label"},"活動時間：",-1),bt=d("label",{class:"form-label"},"主辦單位：",-1),xt=d("label",{class:"form-label"},"活動介紹：",-1),_t={class:"mx-auto"},Vt={__name:"eventTable",setup(G){const{api:me,apiAuth:I}=ge(),V=pe(),W=i(null),U=i([]),w=i([]),h=i(10),B=i([{key:"createdAt",order:"desc"}]),q=i(1),z=i([]),S=[{title:"圖片",align:"center",sortable:!1,key:"image"},{title:"活動名稱",align:"center",sortable:!1,key:"title"},{title:"活動地點",align:"center",sortable:!1,key:"address"},{title:"活動類別",align:"center",sortable:!0,key:"category"},{title:"活動時間",align:"center",sortable:!0,key:"date"},{title:"主辦單位",align:"center",sortable:!1,key:"organizer"},{title:"活動介紹",align:"center",sortable:!1,key:"description"},{title:"操作",align:"center",sortable:!1,key:"action"}],A=i(!0),p=i(0),_=i(""),n=async u=>{var l,k,f,c;u&&(q.value=1),A.value=!0;try{const{data:x}=await I.get("/user/event",{params:{page:q.value,itemsPerPage:h.value,sortBy:((l=B.value[0])==null?void 0:l.key)||"createdAt",sortOrder:((k=B.value[0])==null?void 0:k.order)||"desc",search:_.value}});z.value.splice(0,z.value.length,...x.result.data),p.value=x.result.total}catch(x){console.log(x),V({text:((c=(f=x==null?void 0:x.response)==null?void 0:f.data)==null?void 0:c.message)||"發生錯誤",snackbarProps:{color:"red"}})}A.value=!1};n();const g=["兒童","青少年","育兒","長照","精神","照顧","就學","就業","身障","親職教育","早療","紓壓","居住","醫療","司法","社工","其他"],v=i({open:!1,id:""}),y=u=>{v.value.open=!0,v.value.id=u._id,K.value.value=u.title,b.value.value=u.date,C.value.value=u.address,H.value.value=u.category,Z.value.value=u.organizer,J.value.value=u.description},Q=()=>{v.value.open=!1,R(),W.value.deleteFileRecord()},le=Se({title:T().required("活動標題必填"),date:T().required("活動日期必填"),address:T().required("活動地點必填"),category:T().required("活動分類必填").test("isCategory","商品分類錯誤",u=>g.includes(u)),organizer:T().required("主辦單位必填"),description:T().required("活動介紹必填")}),{handleSubmit:F,isSubmitting:E,resetForm:R}=Ce({validationSchema:le,initialValues:{title:"",date:"",address:"",category:"",organizer:"",description:""}}),K=M("title"),b=M("date"),C=M("address"),H=M("category"),Z=M("organizer"),J=M("description"),ue=F(async u=>{var l,k,f;if(!((l=U.value[0])!=null&&l.error)&&!(U.value.length<1))try{const c=new FormData;c.append("title",u.title),c.append("date",u.date),c.append("address",u.address),c.append("category",u.category),c.append("organizer",u.organizer),c.append("description",u.description),U.value.length>0&&c.append("image",U.value[0].file),await I.patch("/event/"+v.value.id,c),V({text:"新增成功",snackbarProps:{color:"green"}}),Q()}catch(c){console.log(c),V({text:((f=(k=c==null?void 0:c.response)==null?void 0:k.data)==null?void 0:f.message)||"發生錯誤",snackbarProps:{color:"red"}})}});qe(_,()=>{n(!0)});const de=async u=>{var l,k;try{await I.delete(`/event/${u._id}`),V({text:"刪除成功",snackbarProps:{color:"green"}}),n(!0)}catch(f){console.log(f),V({text:((k=(l=f==null?void 0:f.response)==null?void 0:l.data)==null?void 0:k.message)||"發生錯誤",snackbarProps:{color:"red"}})}};return(u,l)=>{const k=$e,f=re("router-link"),c=re("vue-file-agent"),x=Ae;return $(),D(O,null,[it,e(Ve,{"items-per-page":h.value,"onUpdate:itemsPerPage":[l[3]||(l[3]=a=>h.value=a),l[6]||(l[6]=a=>n(!1))],"sort-by":B.value,"onUpdate:sortBy":[l[4]||(l[4]=a=>B.value=a),l[7]||(l[7]=a=>n(!1))],page:q.value,"onUpdate:page":[l[5]||(l[5]=a=>q.value=a),l[8]||(l[8]=a=>n(!1))],items:z.value,headers:S,loading:A.value,"items-length":p.value,search:_.value,hover:"",class:"w-75 mx-auto rounded-lg mb-15"},{top:t(()=>[e(k,{modelValue:_.value,"onUpdate:modelValue":l[0]||(l[0]=a=>_.value=a),onClickAppend:l[1]||(l[1]=a=>n(!0)),onKeydown:l[2]||(l[2]=xe(a=>n(!0),["enter"])),"max-width":"100%",class:"my-5"},null,8,["modelValue"])]),"item.image":t(({item:a})=>[e(f,{to:"/event/"+a._id,style:{"text-decoration":"none"}},{default:t(()=>[e(be,{src:a.image,width:"100px","max-height":"140px",class:"my-5"},null,8,["src"])]),_:2},1032,["to"])]),"item.address":t(({item:a})=>[d("td",ct,P(a.address),1)]),"item.category":t(({item:a})=>[d("td",null,P(a.category.join(" , ")),1)]),"item.description":t(({item:a})=>[d("td",mt,P(a.description),1)]),"item.action":t(({item:a})=>[d("td",pt,[L(P(a.action)+" ",1),e(ee,{icon:"mdi-pencil",variant:"text",color:"blue",onClick:oe=>y(a)},null,8,["onClick"]),e(ee,{icon:"mdi-delete",variant:"text",color:"blue",onClick:oe=>de(a)},null,8,["onClick"])])]),_:2},1032,["items-per-page","sort-by","page","items","loading","items-length","search"]),e(ze,{"max-width":"700",modelValue:v.value.open,"onUpdate:modelValue":l[18]||(l[18]=a=>v.value.open=a)},{default:t(()=>[e(ce,null,{default:t(()=>[e(ke,null,{default:t(()=>[e(_e,{class:"font-weight-black text-center text-h4"},{default:t(()=>[L("新增活動")]),_:1}),e(Pe,null,{default:t(()=>[e(Me,{onSubmit:Ue(s(ue),["prevent"]),disabled:s(E)},{default:t(()=>[e(N,null,{default:t(()=>[e(o,null,{default:t(()=>[e(c,{modelValue:U.value,"onUpdate:modelValue":l[9]||(l[9]=a=>U.value=a),"raw-model-value":w.value,"onUpdate:rawModelValue":l[10]||(l[10]=a=>w.value=a),accept:"image/jpeg,image/png",deletable:"","max-size":"1MB","help-text":"選擇檔案或拖曳到這裡","error-text":{type:"檔案格式不支援",size:"檔案大小不能超過 1MB"},ref_key:"fileAgent",ref:W},null,8,["modelValue","raw-model-value"])]),_:1})]),_:1}),e(N,null,{default:t(()=>[e(o,{cols:"12",md:"3",class:"my-auto text-center"},{default:t(()=>[gt]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(x,{modelValue:s(K).value.value,"onUpdate:modelValue":l[11]||(l[11]=a=>s(K).value.value=a),"error-messages":s(K).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-center"},{default:t(()=>[vt]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(x,{modelValue:s(C).value.value,"onUpdate:modelValue":l[12]||(l[12]=a=>s(C).value.value=a),"error-messages":s(C).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-center"},{default:t(()=>[ft]),_:1}),e(o,{cols:"12",md:"3"},{default:t(()=>[e(Be,{modelValue:s(H).value.value,"onUpdate:modelValue":l[13]||(l[13]=a=>s(H).value.value=a),"error-messages":s(H).errorMessage.value,label:"選擇",variant:"outlined",density:"comfortable",dense:"",width:"140",items:g,"hide-details":""},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"3",class:"my-auto text-center px-0"},{default:t(()=>[yt]),_:1}),e(o,{cols:"3"},{default:t(()=>[e(x,{modelValue:s(b).value.value,"onUpdate:modelValue":l[14]||(l[14]=a=>s(b).value.value=a),"error-messages":s(b).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-center"},{default:t(()=>[bt]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(x,{modelValue:s(Z).value.value,"onUpdate:modelValue":l[15]||(l[15]=a=>s(Z).value.value=a),"error-messages":s(Z).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"text-center"},{default:t(()=>[xt]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(Re,{label:"輸入文字",variant:"outlined",clearable:"","hide-details":"",modelValue:s(J).value.value,"onUpdate:modelValue":l[16]||(l[16]=a=>s(J).value.value=a),"error-messages":s(J).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(Ie,null,{default:t(()=>[d("div",_t,[e(ee,{variant:"text",class:"rounded-xl b-1",density:"comfortable",type:"submit",loading:s(E)},{default:t(()=>[L("送出")]),_:1},8,["loading"]),e(ee,{text:"取消",variant:"text",class:"rounded-xl b-1",density:"comfortable",onClick:l[17]||(l[17]=a=>Q())})])]),_:1})]),_:1},8,["onSubmit","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}},kt=d("h2",{class:"my-5 bg-accent text-center"},"我要分享",-1),wt={style:{width:"250px"},class:"py-2"},ht={style:{width:"80px"}},$t=d("label",{class:"form-label"},"物資名稱",-1),Pt={class:"form-label"},Ut=d("label",{class:"form-label"},"物資類別",-1),St={class:"form-label"},Ct=d("label",{class:"form-label"},"單位名稱",-1),Mt={class:"mx-auto"},qt={__name:"shareTable",props:{cardTitle:{type:String,default:"發布需求"},numberTitle:{type:String,default:"需求量"},descriptionTitle:{type:String,default:"需求介紹"},type:{type:String,default:"share"}},setup(G){const{api:me,apiAuth:I}=ge(),V=pe(),W=G,U=i(null),w=i([]),h=i([]),B=i(8),q=i([{key:"createdAt",order:"desc"}]),z=i(1),S=i([]),A=[{title:"圖片",align:"center",sortable:!1,key:"image"},{title:"名稱",align:"center",sortable:!1,key:"name"},{title:"數量",align:"center",sortable:!1,key:"quantity"},{title:"分類",align:"center",sortable:!0,key:"category"},{title:"概況",align:"center",sortable:!1,key:"description"},{title:"單位",align:"center",sortable:!1,key:"organizer"},{title:"操作",align:"center",sortable:!1,key:"action"}],p=i(!0),_=i(0),n=i(""),g=async u=>{var l,k,f,c;u&&(z.value=1),p.value=!0;try{const{data:x}=await I.get("/user/share",{params:{page:z.value,itemsPerPage:B.value,sortBy:((l=q.value[0])==null?void 0:l.key)||"createdAt",sortOrder:((k=q.value[0])==null?void 0:k.order)||"desc",search:n.value}});console.log(x),S.value.splice(0,S.value.length,...x.result.data),_.value=x.result.total}catch(x){console.log(x),V({text:((c=(f=x==null?void 0:x.response)==null?void 0:f.data)==null?void 0:c.message)||"發生錯誤",snackbarProps:{color:"red"}})}p.value=!1};g();const v=["食品","服飾配件","日用品","家具","輔具","教育用品","嬰幼兒用品","電器","休閒用品","其他"],y=i({open:!1,id:""}),Q=u=>{y.value.open=!0,y.value.id=u._id,b.value.value=u.name,C.value.value=u.quantity,H.value.value=u.category,Z.value.value=u.description,J.value.value=u.organizer},le=()=>{y.value.open=!1,K(),U.value.deleteFileRecord()},F=Se({name:T().required("物品名稱必填"),quantity:Ee().min(1,"物品數量不符").required("物品數量必填"),category:T().required("物品分類必填").test("isCategory","商品分類錯誤",u=>v.includes(u)),description:T().required("物資介紹必填"),organizer:T().required("單位名稱必填")}),{handleSubmit:E,isSubmitting:R,resetForm:K}=Ce({validationSchema:F,initialValues:{name:"",quantity:"0",category:"",description:"",organizer:""}}),b=M("name"),C=M("quantity"),H=M("category"),Z=M("description"),J=M("organizer"),ue=E(async u=>{var l,k,f;if(!((l=w.value[0])!=null&&l.error)&&!(w.value.length<1))try{const c=new FormData;c.append("name",u.name),c.append("quantity",u.quantity),c.append("category",u.category),c.append("description",u.description),c.append("organizer",u.organizer),c.append("type",W.type),w.value.length>0&&c.append("image",w.value[0].file),console.log(c),await I.patch("/material/"+y.value.id,c),V({text:"新增成功",snackbarProps:{color:"green"}}),le()}catch(c){console.log(c),V({text:((f=(k=c==null?void 0:c.response)==null?void 0:k.data)==null?void 0:f.message)||"發生錯誤",snackbarProps:{color:"red"}})}});qe(n,()=>{g(!0)});const de=async u=>{var l,k;try{await I.delete(`/Material/${u._id}`),V({text:"刪除成功",snackbarProps:{color:"green"}}),g(!0)}catch(f){console.log(f),V({text:((k=(l=f==null?void 0:f.response)==null?void 0:l.data)==null?void 0:k.message)||"發生錯誤",snackbarProps:{color:"red"}})}};return(u,l)=>{const k=$e,f=re("router-link"),c=re("vue-file-agent"),x=Ae;return $(),D(O,null,[kt,e(Ve,{"items-per-page":B.value,"onUpdate:itemsPerPage":[l[3]||(l[3]=a=>B.value=a),l[6]||(l[6]=a=>g(!1))],"sort-by":q.value,"onUpdate:sortBy":[l[4]||(l[4]=a=>q.value=a),l[7]||(l[7]=a=>g(!1))],page:z.value,"onUpdate:page":[l[5]||(l[5]=a=>z.value=a),l[8]||(l[8]=a=>g(!1))],items:S.value,headers:A,loading:p.value,"items-length":_.value,search:n.value,hover:"",class:"w-75 mx-auto b-1 rounded-lg mb-15"},{top:t(()=>[e(k,{class:"my-5",modelValue:n.value,"onUpdate:modelValue":l[0]||(l[0]=a=>n.value=a),onClickAppend:l[1]||(l[1]=a=>g(!0)),onKeydown:l[2]||(l[2]=xe(a=>g(!0),["enter"])),"max-width":"100%"},null,8,["modelValue"])]),"item.image":t(({item:a})=>[e(f,{to:"/material/share/"+a._id,style:{"text-decoration":"none"}},{default:t(()=>[e(be,{src:a.image,width:"80px","max-height":"100px"},null,8,["src"])]),_:2},1032,["to"])]),"item.description":t(({item:a})=>[d("td",wt,P(a.description),1)]),"item.action":t(({item:a})=>[d("td",ht,[L(P(a.action)+" ",1),e(ee,{icon:"mdi-pencil",variant:"text",color:"blue",onClick:oe=>Q(a)},null,8,["onClick"]),e(ee,{icon:"mdi-delete",variant:"text",color:"blue",onClick:oe=>de(a)},null,8,["onClick"])])]),_:2},1032,["items-per-page","sort-by","page","items","loading","items-length","search"]),e(ze,{"max-width":"600",modelValue:y.value.open,"onUpdate:modelValue":l[17]||(l[17]=a=>y.value.open=a)},{default:t(()=>[e(ce,null,{default:t(()=>[e(ke,null,{default:t(()=>[e(_e,{class:"font-weight-black text-center text-h4"},{default:t(()=>[L(P(G.cardTitle),1)]),_:1}),e(Pe,null,{default:t(()=>[e(Me,{onSubmit:Ue(s(ue),["prevent"]),disabled:s(R)},{default:t(()=>[e(N,null,{default:t(()=>[e(o,null,{default:t(()=>[e(c,{modelValue:w.value,"onUpdate:modelValue":l[9]||(l[9]=a=>w.value=a),"raw-model-value":h.value,"onUpdate:rawModelValue":l[10]||(l[10]=a=>h.value=a),accept:"image/jpeg,image/png",deletable:"","max-size":"1MB","help-text":"選擇檔案或拖曳到這裡","error-text":{type:"檔案格式不支援",size:"檔案大小不能超過 1MB"},ref_key:"fileAgent",ref:U},null,8,["modelValue","raw-model-value"])]),_:1})]),_:1}),e(N,null,{default:t(()=>[e(o,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:t(()=>[$t]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(x,{modelValue:s(b).value.value,"onUpdate:modelValue":l[11]||(l[11]=a=>s(b).value.value=a),"error-messages":s(b).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:t(()=>[d("label",Pt,P(G.numberTitle),1)]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(x,{modelValue:s(C).value.value,"onUpdate:modelValue":l[12]||(l[12]=a=>s(C).value.value=a),"error-messages":s(C).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:t(()=>[Ut]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(Be,{modelValue:s(H).value.value,"onUpdate:modelValue":l[13]||(l[13]=a=>s(H).value.value=a),"error-messages":s(H).errorMessage.value,label:"選擇",variant:"outlined",density:"comfortable",dense:"",items:v,"hide-details":""},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:t(()=>[d("label",St,P(G.descriptionTitle),1)]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(x,{modelValue:s(Z).value.value,"onUpdate:modelValue":l[14]||(l[14]=a=>s(Z).value.value=a),"error-messages":s(Z).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:t(()=>[Ct]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(x,{modelValue:s(J).value.value,"onUpdate:modelValue":l[15]||(l[15]=a=>s(J).value.value=a),"error-messages":s(J).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(Ie,null,{default:t(()=>[d("div",Mt,[e(ee,{variant:"text",class:"rounded-xl b-1",density:"comfortable",type:"submit",loading:s(R)},{default:t(()=>[L("送出")]),_:1},8,["loading"]),e(ee,{text:"取消",variant:"text",class:"rounded-xl b-1",density:"comfortable",onClick:l[16]||(l[16]=a=>le())})])]),_:1})]),_:1},8,["onSubmit","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}},zt=d("h2",{class:"my-5 bg-accent text-center"},"我要募資",-1),At={style:{width:"250px"},class:"py-2"},Tt={style:{width:"80px"}},It=d("label",{class:"form-label"},"物資名稱",-1),Bt={class:"form-label"},Ft=d("label",{class:"form-label"},"物資類別",-1),Dt={class:"form-label"},Lt=d("label",{class:"form-label"},"單位名稱",-1),Et={class:"mx-auto"},Rt={__name:"findTable",props:{cardTitle:{type:String,default:"發布需求"},numberTitle:{type:String,default:"需求量"},descriptionTitle:{type:String,default:"需求介紹"},type:{type:String,default:"share"}},setup(G){const{api:me,apiAuth:I}=ge(),V=pe(),W=G,U=i(null),w=i([]),h=i([]),B=i(8),q=i([{key:"createdAt",order:"desc"}]),z=i(1),S=i([]),A=[{title:"圖片",align:"center",sortable:!1,key:"image"},{title:"名稱",align:"center",sortable:!1,key:"name"},{title:"數量",align:"center",sortable:!1,key:"quantity"},{title:"分類",align:"center",sortable:!0,key:"category"},{title:"概況",align:"center",sortable:!1,key:"description"},{title:"單位",align:"center",sortable:!1,key:"organizer"},{title:"操作",align:"center",sortable:!1,key:"action"}],p=i(!0),_=i(0),n=i(""),g=async u=>{var l,k,f,c;u&&(z.value=1),p.value=!0;try{const{data:x}=await I.get("/user/find",{params:{page:z.value,itemsPerPage:B.value,sortBy:((l=q.value[0])==null?void 0:l.key)||"createdAt",sortOrder:((k=q.value[0])==null?void 0:k.order)||"desc",search:n.value}});S.value.splice(0,S.value.length,...x.result.data),_.value=x.result.total}catch(x){console.log(x),V({text:((c=(f=x==null?void 0:x.response)==null?void 0:f.data)==null?void 0:c.message)||"發生錯誤",snackbarProps:{color:"red"}})}p.value=!1};g();const v=["食品","服飾配件","日用品","家具","輔具","教育用品","嬰幼兒用品","電器","休閒用品","其他"],y=i({open:!1,id:""}),Q=u=>{y.value.open=!0,y.value.id=u._id,b.value.value=u.name,C.value.value=u.quantity,H.value.value=u.category,Z.value.value=u.description,J.value.value=u.organizer},le=()=>{y.value.open=!1,K(),U.value.deleteFileRecord()},F=Se({name:T().required("物品名稱必填"),quantity:Ee().min(1,"物品數量不符").required("物品數量必填"),category:T().required("物品分類必填").test("isCategory","商品分類錯誤",u=>v.includes(u)),description:T().required("物資介紹必填"),organizer:T().required("單位名稱必填")}),{handleSubmit:E,isSubmitting:R,resetForm:K}=Ce({validationSchema:F,initialValues:{name:"",quantity:"0",category:"",description:"",organizer:""}}),b=M("name"),C=M("quantity"),H=M("category"),Z=M("description"),J=M("organizer"),ue=E(async u=>{var l,k,f;if(!((l=w.value[0])!=null&&l.error)&&!(w.value.length<1))try{const c=new FormData;c.append("name",u.name),c.append("quantity",u.quantity),c.append("category",u.category),c.append("description",u.description),c.append("organizer",u.organizer),c.append("type",W.type),w.value.length>0&&c.append("image",w.value[0].file),console.log(c),await I.patch("/material/"+y.value.id,c),V({text:"新增成功",snackbarProps:{color:"green"}}),le()}catch(c){console.log(c),V({text:((f=(k=c==null?void 0:c.response)==null?void 0:k.data)==null?void 0:f.message)||"發生錯誤",snackbarProps:{color:"red"}})}});qe(n,()=>{g(!0)});const de=async u=>{var l,k;try{await I.delete(`/Material/${u._id}`),V({text:"刪除成功",snackbarProps:{color:"green"}}),g(!0)}catch(f){console.log(f),V({text:((k=(l=f==null?void 0:f.response)==null?void 0:l.data)==null?void 0:k.message)||"發生錯誤",snackbarProps:{color:"red"}})}};return(u,l)=>{const k=$e,f=re("router-link"),c=re("vue-file-agent"),x=Ae;return $(),D(O,null,[zt,e(Ve,{"items-per-page":B.value,"onUpdate:itemsPerPage":[l[3]||(l[3]=a=>B.value=a),l[6]||(l[6]=a=>g(!1))],"sort-by":q.value,"onUpdate:sortBy":[l[4]||(l[4]=a=>q.value=a),l[7]||(l[7]=a=>g(!1))],page:z.value,"onUpdate:page":[l[5]||(l[5]=a=>z.value=a),l[8]||(l[8]=a=>g(!1))],items:S.value,headers:A,loading:p.value,"items-length":_.value,search:n.value,hover:"",class:"w-75 mx-auto b-1 rounded-lg mb-15"},{top:t(()=>[e(k,{modelValue:n.value,"onUpdate:modelValue":l[0]||(l[0]=a=>n.value=a),onClickAppend:l[1]||(l[1]=a=>g(!0)),onKeydown:l[2]||(l[2]=xe(a=>g(!0),["enter"])),"max-width":"100%",class:"my-5"},null,8,["modelValue"])]),"item.image":t(({item:a})=>[e(f,{to:"/material/find/"+a._id,style:{"text-decoration":"none"}},{default:t(()=>[e(be,{src:a.image,width:"80px","max-height":"100px"},null,8,["src"])]),_:2},1032,["to"])]),"item.description":t(({item:a})=>[d("td",At,P(a.description),1)]),"item.action":t(({item:a})=>[d("td",Tt,[L(P(a.action)+" ",1),e(ee,{icon:"mdi-pencil",variant:"text",color:"blue",onClick:oe=>Q(a)},null,8,["onClick"]),e(ee,{icon:"mdi-delete",variant:"text",color:"blue",onClick:oe=>de(a)},null,8,["onClick"])])]),_:2},1032,["items-per-page","sort-by","page","items","loading","items-length","search"]),e(ze,{"max-width":"600",modelValue:y.value.open,"onUpdate:modelValue":l[17]||(l[17]=a=>y.value.open=a)},{default:t(()=>[e(ce,null,{default:t(()=>[e(ke,null,{default:t(()=>[e(_e,{class:"font-weight-black text-center text-h4"},{default:t(()=>[L(P(G.cardTitle),1)]),_:1}),e(Pe,null,{default:t(()=>[e(Me,{onSubmit:Ue(s(ue),["prevent"]),disabled:s(R)},{default:t(()=>[e(N,null,{default:t(()=>[e(o,null,{default:t(()=>[e(c,{modelValue:w.value,"onUpdate:modelValue":l[9]||(l[9]=a=>w.value=a),"raw-model-value":h.value,"onUpdate:rawModelValue":l[10]||(l[10]=a=>h.value=a),accept:"image/jpeg,image/png",deletable:"","max-size":"1MB","help-text":"選擇檔案或拖曳到這裡","error-text":{type:"檔案格式不支援",size:"檔案大小不能超過 1MB"},ref_key:"fileAgent",ref:U},null,8,["modelValue","raw-model-value"])]),_:1})]),_:1}),e(N,null,{default:t(()=>[e(o,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:t(()=>[It]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(x,{modelValue:s(b).value.value,"onUpdate:modelValue":l[11]||(l[11]=a=>s(b).value.value=a),"error-messages":s(b).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:t(()=>[d("label",Bt,P(G.numberTitle),1)]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(x,{modelValue:s(C).value.value,"onUpdate:modelValue":l[12]||(l[12]=a=>s(C).value.value=a),"error-messages":s(C).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:t(()=>[Ft]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(Be,{modelValue:s(H).value.value,"onUpdate:modelValue":l[13]||(l[13]=a=>s(H).value.value=a),"error-messages":s(H).errorMessage.value,label:"選擇",variant:"outlined",density:"comfortable",dense:"",items:v,"hide-details":""},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:t(()=>[d("label",Dt,P(G.descriptionTitle),1)]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(x,{modelValue:s(Z).value.value,"onUpdate:modelValue":l[14]||(l[14]=a=>s(Z).value.value=a),"error-messages":s(Z).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:t(()=>[Lt]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(x,{modelValue:s(J).value.value,"onUpdate:modelValue":l[15]||(l[15]=a=>s(J).value.value=a),"error-messages":s(J).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(Ie,null,{default:t(()=>[d("div",Et,[e(ee,{variant:"text",class:"rounded-xl b-1",density:"comfortable",type:"submit",loading:s(R)},{default:t(()=>[L("送出")]),_:1},8,["loading"]),e(ee,{text:"取消",variant:"text",class:"rounded-xl b-1",density:"comfortable",onClick:l[16]||(l[16]=a=>le())})])]),_:1})]),_:1},8,["onSubmit","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}},jt=G=>(Ye("data-v-ab2ef7b8"),G=G(),Ze(),G),Kt={id:"profile",class:"b-1 w-50 text-center mx-auto rounded-lg"},Ht={id:"img",style:{width:"160px",height:"160px"},class:"rounded-circle d-flex justify-center align-center bg-grey-lighten-5 mx-auto my-5 b-1"},Nt=jt(()=>d("div",{id:"upload"},"編輯",-1)),Ot={key:0,style:{"font-size":"18px"}},Wt={style:{"font-size":"18px"}},Gt={key:0,style:{"font-size":"18px"}},Qt={__name:"accountTable",setup(G){const me=Qe(),{apiAuth:I}=ge(),V=pe(),W=i(null),U=i([]),w=i([]),h=i([]);(async()=>{var F,E;try{const{data:R}=await I.get("/user/profile");h.value=[R.result],h.value[0].password="********",h.value[0].newUsername=h.value[0].username,h.value[0].newPassword="",console.log(h.value)}catch(R){V({text:((E=(F=R==null?void 0:R.response)==null?void 0:F.data)==null?void 0:E.message)||"發生錯誤",snackbarProps:{color:"red"}})}})();const q=Se({newUsername:T().min(3,"服務單位長度不符").max(20,"服務單位長度不符"),newPassword:T().min(6,"使用者密碼長度不符").max(20,"使用者密碼長度不符")}),{handleSubmit:z,isSubmitting:S}=Ce({validationSchema:q}),{value:A,errorMessage:p}=M("newUsername"),{value:_,errorMessage:n}=M("newPassword"),g=z(async()=>{var F,E;try{const R=h.value[0],K=new FormData;A.value&&A.value!==R.username&&K.append("username",A.value),_.value&&_.value!==""&&K.append("password",_.value),U.value.length!==0&&K.append("image",U.value[0].file);for(let[C,H]of K.entries())console.log(`${C}:`,H);if(K.get("username")===null&&K.get("password")===null&&K.get("image")===null){V({text:"沒有任何變更",snackbarProps:{color:"accent"}});return}console.log(K);const b=await I.patch("/user/change",K);b.data.success?(V({text:"資料修改成功",snackbarProps:{color:"green"}}),me.push("/")):V({text:b.data.message||"發生錯誤",snackbarProps:{color:"red"}})}catch(R){V({text:((E=(F=R==null?void 0:R.response)==null?void 0:F.data)==null?void 0:E.message)||"發生錯誤",snackbarProps:{color:"red"}})}}),v=F=>{F.isEditing=!F.isEditing},y=F=>{F.isEditing=!1},Q=F=>{F.passwordisEditing=!F.passwordisEditing},le=F=>{F.passwordisEditing=!1};return(F,E)=>{const R=re("vue-file-agent"),K=lt;return $(),ie(ce,{flat:""},{default:t(()=>[e(Me,{onSubmit:Ue(s(g),["prevent"]),disabled:s(S)},{default:t(()=>[e(Pe,null,{default:t(()=>[d("div",Kt,[e(Ke,{color:"info",class:"mb-10 rounded-t-lg bb-1",prominent:""},{default:t(()=>[e(He,{class:"ms-0 font-weight-bold"},{default:t(()=>[L("基本資料")]),_:1})]),_:1}),e(R,{id:"account",class:"d-flex justify-center mb-5",accept:"image/jpeg,image/png",deletable:"","max-size":"1MB","help-text":"上傳大頭照","error-text":{type:"檔案格式不支援",size:"檔案大小不能超過 1MB"},modelValue:U.value,"onUpdate:modelValue":E[0]||(E[0]=b=>U.value=b),"raw-model-value":w.value,"onUpdate:rawModelValue":E[1]||(E[1]=b=>w.value=b),ref_key:"fileAgent",ref:W},null,8,["modelValue","raw-model-value"]),($(!0),D(O,null,te(h.value,b=>($(),D(O,{key:b.id},[d("div",Ht,[e(be,{src:b.avatar,cover:""},null,8,["src"])]),Nt],64))),128)),e(ke,null,{default:t(()=>[e(N,{class:"mb-5 px-15 text-left"},{default:t(()=>[e(o,{md:"2"}),e(o,{cols:"12",md:"3",class:"my-auto form-label",style:{"font-size":"18px"}},{default:t(()=>[L("服務單位")]),_:1}),($(!0),D(O,null,te(h.value,b=>($(),D(O,{key:b.id},[e(o,{cols:"12",md:"4",class:"my-auto"},{default:t(()=>[b.isEditing?($(),ie(Le,{key:1,class:"form-label",style:{"font-size":"18px"},variant:"outlined","single-line":"",density:"comfortable",clearable:"",dense:"",modelValue:s(A),"onUpdate:modelValue":E[2]||(E[2]=C=>Te(A)?A.value=C:null),"error-messages":s(p),onKeydown:xe(C=>y(b),["enter"])},null,8,["modelValue","error-messages","onKeydown"])):($(),D("p",Ot,P(b.username),1))]),_:2},1024),e(o,{md:"3",class:"ps-10"},{default:t(()=>[e(ee,{onClick:C=>v(b),icon:"mdi-pencil",variant:"text",color:"blue-grey-darken-1"},null,8,["onClick"])]),_:2},1024)],64))),128)),e(se)]),_:1}),e(N,{class:"mb-5 px-15 text-left"},{default:t(()=>[e(o,{md:"2"}),e(o,{cols:"12",md:"3",class:"my-auto form-label",style:{"font-size":"18px"}},{default:t(()=>[L("電子信箱")]),_:1}),($(!0),D(O,null,te(h.value,b=>($(),ie(o,{key:b.id,cols:"12",md:"4",class:"my-auto"},{default:t(()=>[d("p",Wt,P(b.email),1)]),_:2},1024))),128)),e(se)]),_:1}),e(N,{class:"mb-5 px-15 text-left"},{default:t(()=>[e(o,{md:"2"}),e(o,{cols:"12",md:"3",class:"my-auto form-label",style:{"font-size":"18px"}},{default:t(()=>[L("密碼")]),_:1}),($(!0),D(O,null,te(h.value,b=>($(),D(O,{key:b.id},[e(o,{cols:"12",md:"4",class:"my-auto"},{default:t(()=>[b.passwordisEditing?($(),ie(Le,{key:1,class:"form-label",style:{"font-size":"18px"},variant:"outlined","single-line":"",density:"comfortable",clearable:"",dense:"",modelValue:s(_),"onUpdate:modelValue":E[3]||(E[3]=C=>Te(_)?_.value=C:null),"error-messages":s(n),onKeydown:xe(C=>le(b),["enter"])},null,8,["modelValue","error-messages","onKeydown"])):($(),D("p",Gt,P(b.password),1))]),_:2},1024),e(o,{md:"3",class:"ps-10"},{default:t(()=>[e(ee,{onClick:C=>Q(b),icon:"mdi-pencil",variant:"text",color:"blue-grey-darken-1"},null,8,["onClick"])]),_:2},1024)],64))),128)),e(se)]),_:1}),e(K,{text:"提交",class:"mx-auto bg-accent my-5"})]),_:1})])]),_:1})]),_:1},8,["onSubmit","disabled"])]),_:1})}}},Yt=je(Qt,[["__scopeId","data-v-ab2ef7b8"]]),Zt={__name:"shareReplyTable",setup(G){const{api:me,apiAuth:I}=ge(),V=pe(),W=i(8),U=i([{key:"createdAt",order:"desc"}]),w=i(1),h=i([]),B=[{title:"物資",align:"center",sortable:!1,key:"image"},{title:"索取者聯絡資訊",align:"center",sortable:!1,key:"donations"}],q=i(!0),z=i(0),S=async A=>{var p,_,n,g;A&&(w.value=1),q.value=!0;try{const{data:v}=await I.get("/user/share",{params:{page:w.value,itemsPerPage:W.value,sortBy:((p=U.value[0])==null?void 0:p.key)||"createdAt",sortOrder:((_=U.value[0])==null?void 0:_.order)||"desc"}});console.log(v);const y=v.result.data.filter(Q=>Q.donations&&Q.donations.length>0);y.value>0&&(h.value.splice(0,h.value.length,...y),z.value=v.result.total)}catch(v){console.log(v),V({text:((g=(n=v==null?void 0:v.response)==null?void 0:n.data)==null?void 0:g.message)||"發生錯誤",snackbarProps:{color:"red"}})}q.value=!1};return S(),(A,p)=>{const _=re("router-link");return $(),ie(Ve,{"items-per-page":W.value,"onUpdate:itemsPerPage":[p[0]||(p[0]=n=>W.value=n),p[3]||(p[3]=n=>S(!1))],"sort-by":U.value,"onUpdate:sortBy":[p[1]||(p[1]=n=>U.value=n),p[4]||(p[4]=n=>S(!1))],page:w.value,"onUpdate:page":[p[2]||(p[2]=n=>w.value=n),p[5]||(p[5]=n=>S(!1))],items:h.value,headers:B,loading:q.value,"items-length":z.value,hover:"",class:"w-75 mx-auto rounded-lg mb-15"},{"item.image":t(({item:n})=>[e(o,{cols:"12",md:"4",class:"mx-auto",style:{width:"300px"}},{default:t(()=>[e(_,{to:"/material/share/"+n._id,style:{"text-decoration":"none"}},{default:t(()=>[e(be,{src:n.image,width:"250px","max-height":"200px",class:"my-5"},null,8,["src"])]),_:2},1032,["to"])]),_:2},1024)]),"item.donations":t(({item:n})=>[e(o,null,{default:t(()=>[($(!0),D(O,null,te(n.donations,(g,v)=>($(),ie(ce,{class:"mb-2",outlined:"",variant:"text",key:v},{default:t(()=>[e(_e,null,{default:t(()=>[e(N,{"no-gutters":""},{default:t(()=>[e(o,{cols:"3",class:"text-body-1 text-left"},{default:t(()=>[L("數量: "+P(g.quantity),1)]),_:2},1024),e(o,{cols:"5",class:"text-body-1 text-left"},{default:t(()=>[L("服務單位: "+P(g.donator),1)]),_:2},1024),e(o,{cols:"4",class:"text-body-1 text-left"},{default:t(()=>[L("聯絡電話: "+P(g.phone),1)]),_:2},1024)]),_:2},1024),e(se,{class:"100%"})]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["items-per-page","sort-by","page","items","loading","items-length"])}}},Jt={__name:"findReplyTable",setup(G){const{api:me,apiAuth:I}=ge(),V=pe(),W=i(8),U=i([{key:"createdAt",order:"desc"}]),w=i(1),h=i([]),B=[{title:"物資",align:"center",sortable:!1,key:"image"},{title:"捐贈者聯絡資訊",align:"center",sortable:!1,key:"donations"}],q=i(!0),z=i(0),S=async A=>{var p,_,n,g;A&&(w.value=1),q.value=!0;try{const{data:v}=await I.get("/user/find",{params:{page:w.value,itemsPerPage:W.value,sortBy:((p=U.value[0])==null?void 0:p.key)||"createdAt",sortOrder:((_=U.value[0])==null?void 0:_.order)||"desc"}});console.log(v),h.value.splice(0,h.value.length,...v.result.data),z.value=v.result.total}catch(v){console.log(v),V({text:((g=(n=v==null?void 0:v.response)==null?void 0:n.data)==null?void 0:g.message)||"發生錯誤",snackbarProps:{color:"red"}})}q.value=!1};return S(),(A,p)=>{const _=re("router-link");return $(),ie(Ve,{"items-per-page":W.value,"onUpdate:itemsPerPage":[p[0]||(p[0]=n=>W.value=n),p[3]||(p[3]=n=>S(!1))],"sort-by":U.value,"onUpdate:sortBy":[p[1]||(p[1]=n=>U.value=n),p[4]||(p[4]=n=>S(!1))],page:w.value,"onUpdate:page":[p[2]||(p[2]=n=>w.value=n),p[5]||(p[5]=n=>S(!1))],items:h.value,headers:B,loading:q.value,"items-length":z.value,hover:"",class:"w-75 mx-auto rounded-lg mb-15"},{"item.image":t(({item:n})=>[e(o,{cols:"12",md:"4",class:"mx-auto",style:{width:"300px"}},{default:t(()=>[e(_,{to:"/material/find/"+n._id,style:{"text-decoration":"none"}},{default:t(()=>[e(be,{src:n.image,width:"250px","max-height":"200px",class:"my-5"},null,8,["src"])]),_:2},1032,["to"])]),_:2},1024)]),"item.donations":t(({item:n})=>[e(o,null,{default:t(()=>[($(!0),D(O,null,te(n.donations,(g,v)=>($(),ie(ce,{class:"mb-2",outlined:"",variant:"text",key:v},{default:t(()=>[e(_e,null,{default:t(()=>[e(N,{"no-gutters":""},{default:t(()=>[e(o,{cols:"3",class:"text-body-1 text-left"},{default:t(()=>[L("數量: "+P(g.quantity),1)]),_:2},1024),e(o,{cols:"5",class:"text-body-1 text-left"},{default:t(()=>[L("服務單位: "+P(g.donator),1)]),_:2},1024),e(o,{cols:"4",class:"text-body-1 text-left"},{default:t(()=>[L("聯絡電話: "+P(g.phone),1)]),_:2},1024)]),_:2},1024),e(se,{class:"100%"})]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["items-per-page","sort-by","page","items","loading","items-length"])}}},Xt=d("h2",{class:"my-5 bg-accent text-center mx-auto w-75"},"地標管理",-1),el={style:{width:"240px"}},tl={style:{width:"120px"}},ll={style:{width:"300px"},class:"text-left"},al={style:{width:"200px"},class:"text-center"},sl={style:{width:"350px"},class:"py-2 text-left"},ol={style:{width:"80px"}},nl={class:"px-6 my-2"},rl=d("label",{class:"form-label"},"服務地址",-1),ul=d("label",{class:"form-label"},"服務名稱",-1),dl=d("label",{class:"form-label"},"服務電話",-1),il=d("label",{class:"form-label"},"服務項目",-1),cl=d("p",null,"服務對象",-1),ml=d("p",null,"長期照顧",-1),pl=d("p",null,"身心障礙",-1),gl=d("p",null,"兒童及少年",-1),vl=d("p",null,"社會救助",-1),fl=d("p",null,"婦女",-1),yl=d("p",null,"其他",-1),bl=d("label",{class:"form-label"},"服務介紹",-1),xl={__name:"landmarkTable",setup(G){const{api:me,apiAuth:I}=ge(),V=pe(),W=["長期照顧","身心障礙","婦女","兒童及少年","保護性服務"],U=["日照中心","護理之家","居家服務","交通接送","家庭托顧"],w=["身心障礙者服務中心","輔具中心","職業重建中心","小作所","庇護工場"],h=["少年福利服務中心","親子館","課後班"],B=["經濟補助","待用餐","基金會","社會福利中心"],q=["婦女福利服務中心","新住民家庭服務中心"],z=i(10),S=i([{key:"createdAt",order:"desc"}]),A=i(1),p=i([]),_=[{title:"服務名稱",align:"center",sortable:!1,key:"name"},{title:"地址",align:"center",sortable:!0,key:"address"},{title:"聯絡電話",align:"center",sortable:!1,key:"tel"},{title:"服務項目",align:"center",sortable:!0,key:"categories"},{title:"服務介紹",align:"center",sortable:!1,key:"description"},{title:"操作",align:"center",sortable:!1,key:"action"}],n=i(!0),g=i(0),v=i(""),y=async j=>{var m,X,Y,ae;j&&(A.value=1),n.value=!0;try{const{data:ne}=await I.get("/user/landmark",{params:{page:A.value,itemsPerPage:z.value,sortBy:((m=S.value[0])==null?void 0:m.key)||"createdAt",sortOrder:((X=S.value[0])==null?void 0:X.order)||"desc",search:v.value}});console.log(ne),p.value.splice(0,p.value.length,...ne.result.data),g.value=ne.result.total}catch(ne){console.log(ne),V({text:((ae=(Y=ne==null?void 0:ne.response)==null?void 0:Y.data)==null?void 0:ae.message)||"發生錯誤",snackbarProps:{color:"red"}})}n.value=!1};y();const Q=i({open:!1}),le=j=>{Q.value.open=!0,Q.value.id=j._id,C.value.value=j.name,H.value.value=j.tel,f.value.value=j.description},F=()=>{Q.value.open=!1,b()},E=Se({name:T().required("服務單位必填"),address:T().required("服務地址必填"),tel:T(),category5:ve().of(T()).required("分類必填"),category2:ve().of(T()).required("分類必填"),category3:ve().of(T()).required("分類必填"),category4:ve().of(T()).required("分類必填"),category5:ve().of(T()).required("分類必填"),category6:ve().of(T()).required("分類必填"),category7:ve().of(T()).required("分類必填"),description:T()}),{handleSubmit:R,isSubmitting:K,resetForm:b}=Ce({validationSchema:E,initialValues:{name:"",address:"",tel:"",category1:[],category2:[],category3:[],category4:[],category5:[],category6:[],category7:[],description:""}}),C=M("name"),H=M("tel"),Z=M("category1"),J=M("category2"),ue=M("category3"),de=M("category4"),u=M("category5"),l=M("category6"),k=M("category7"),f=M("description"),{value:c,errorMessage:x}=M("address"),a="AIzaSyAyML8H2ENbc_kzs_ZSI6qYf7CCbBt0dAA";console.log(a);const oe=i(null),Fe=i(null),De=async()=>{if(!c.value){alert("找不到地址~");return}const j=`https://maps.googleapis.com/maps/api/geocode/json?address=${encodeURIComponent(c.value)}&key=${a}`;try{const X=(await Je.get(j)).data;if(console.log(X),X.results&&X.results.length>0){const Y=X.results[0].geometry.location.lat,ae=X.results[0].geometry.location.lng;oe.value=Y,Fe.value=ae,console.log(oe.value),console.log(X.results),console.log(Y),console.log(ae)}else alert("找不到地址~")}catch(m){console.error("新增地標錯誤:",m),alert("新增地標失敗~")}},Ne=R(async j=>{var m,X;try{await De(),console.log(oe.value);const Y=[...j.category1,...j.category2,...j.category3,...j.category4,...j.category5,...j.category6,...j.category7],ae={name:j.name,address:j.address,tel:j.tel,categories:Y,description:j.description,lat:oe.value,lng:Fe.value};console.log(ae),await I.patch("landmark/"+Q.value.id,ae),V({text:"修改成功",snackbarProps:{color:"green"}}),F(),b(),y(!0)}catch(Y){console.log(Y),V({text:((X=(m=Y==null?void 0:Y.response)==null?void 0:m.data)==null?void 0:X.message)||"發生錯誤",snackbarProps:{color:"red"}})}});qe(v,()=>{y(!0)});const Oe=async j=>{var m,X;try{await I.delete(`/landmark/${j._id}`),V({text:"刪除成功",snackbarProps:{color:"green"}}),y(!0)}catch(Y){console.log(Y),V({text:((X=(m=Y==null?void 0:Y.response)==null?void 0:m.data)==null?void 0:X.message)||"發生錯誤",snackbarProps:{color:"red"}})}};return(j,m)=>{const X=$e,Y=$e,ae=Ae,ne=at;return $(),D(O,null,[Xt,e(Ve,{"items-per-page":z.value,"onUpdate:itemsPerPage":[m[3]||(m[3]=r=>z.value=r),m[6]||(m[6]=r=>y(!1))],"sort-by":S.value,"onUpdate:sortBy":[m[4]||(m[4]=r=>S.value=r),m[7]||(m[7]=r=>y(!1))],page:A.value,"onUpdate:page":[m[5]||(m[5]=r=>A.value=r),m[8]||(m[8]=r=>y(!1))],items:p.value,headers:_,loading:n.value,"items-length":g.value,search:v.value,hover:"",class:"w-75 mx-auto rounded-lg mb-15"},{top:t(()=>[e(X,{class:"my-5",modelValue:v.value,"onUpdate:modelValue":m[0]||(m[0]=r=>v.value=r),onClickAppend:m[1]||(m[1]=r=>y(!0)),onKeydown:m[2]||(m[2]=xe(r=>y(!0),["enter"])),"max-width":"100%"},null,8,["modelValue"])]),"item.name":t(({item:r})=>[d("td",el,P(r.name),1)]),"item.tel":t(({item:r})=>[d("td",tl,P(r.tel),1)]),"item.address":t(({item:r})=>[d("td",ll,P(r.address),1)]),"item.categories":t(({item:r})=>[d("td",al,P(r.categories.join(" , ")),1)]),"item.description":t(({item:r})=>[d("td",sl,P(r.description),1)]),"item.action":t(({item:r})=>[d("td",ol,[L(P(r.action)+" ",1),e(ee,{icon:"mdi-pencil",variant:"text",color:"blue",onClick:We=>le(r)},null,8,["onClick"]),e(ee,{icon:"mdi-delete",variant:"text",color:"blue",onClick:We=>Oe(r)},null,8,["onClick"])])]),_:2},1032,["items-per-page","sort-by","page","items","loading","items-length","search"]),e(ze,{"max-width":"700",modelValue:Q.value.open,"onUpdate:modelValue":m[20]||(m[20]=r=>Q.value.open=r)},{default:t(()=>[e(ce,null,{default:t(()=>[e(Ke,{color:"secondary",prominent:"",class:"bb-1"},{default:t(()=>[e(He,{class:"mt-3 text-center font-weight-bold"},{default:t(()=>[L(" 修改地標 ")]),_:1})]),_:1}),d("div",nl,[e(Me,{onSubmit:Ue(s(Ne),["prevent"]),disabled:s(K)},{default:t(()=>[e(N,{class:"my-1"},{default:t(()=>[e(o,{cols:"12",md:"3",class:"my-auto text-center ps-6"},{default:t(()=>[rl]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(Y,{modelValue:s(c),"onUpdate:modelValue":m[9]||(m[9]=r=>Te(c)?c.value=r:null),"error-messages":s(x),label:"輸入資源地址","max-width":"1000px"},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-center ps-6"},{default:t(()=>[ul]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(ae,{modelValue:s(C).value.value,"onUpdate:modelValue":m[10]||(m[10]=r=>s(C).value.value=r),"error-messages":s(C).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-center ps-6"},{default:t(()=>[dl]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(ae,{modelValue:s(H).value.value,"onUpdate:modelValue":m[11]||(m[11]=r=>s(H).value.value=r),"error-messages":s(H).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"mt-2 text-center ps-6"},{default:t(()=>[il]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(st,{variant:"accordion"},{default:t(()=>[e(ot,{title:"選擇類別"},{default:t(()=>[e(nt,null,{default:t(()=>[e(ke,null,{default:t(()=>[e(N,null,{default:t(()=>[e(o,null,{default:t(()=>[cl,d("div",null,[e(fe,{modelValue:s(Z).value.value,"onUpdate:modelValue":m[12]||(m[12]=r=>s(Z).value.value=r),"error-messages":s(Z).errorMessage.value,column:"",multiple:""},{default:t(()=>[($(),D(O,null,te(W,r=>e(ye,{text:r,value:r,filter:"",density:"compact"},null,8,["text","value"])),64))]),_:1},8,["modelValue","error-messages"])]),e(se)]),_:1})]),_:1}),e(N,null,{default:t(()=>[e(o,null,{default:t(()=>[ml,d("div",null,[e(fe,{modelValue:s(J).value.value,"onUpdate:modelValue":m[13]||(m[13]=r=>s(J).value.value=r),"error-messages":s(J).errorMessage.value,column:"",multiple:""},{default:t(()=>[($(),D(O,null,te(U,r=>e(ye,{text:r,value:r,filter:"",density:"compact"},null,8,["text","value"])),64))]),_:1},8,["modelValue","error-messages"])]),e(se)]),_:1})]),_:1}),e(N,null,{default:t(()=>[e(o,null,{default:t(()=>[pl,d("div",null,[e(fe,{modelValue:s(ue).value.value,"onUpdate:modelValue":m[14]||(m[14]=r=>s(ue).value.value=r),"error-messages":s(ue).errorMessage.value,column:"",multiple:""},{default:t(()=>[($(),D(O,null,te(w,r=>e(ye,{text:r,value:r,filter:"",density:"compact"},null,8,["text","value"])),64))]),_:1},8,["modelValue","error-messages"])]),e(se)]),_:1})]),_:1}),e(N,null,{default:t(()=>[e(o,null,{default:t(()=>[gl,d("div",null,[e(fe,{modelValue:s(de).value.value,"onUpdate:modelValue":m[15]||(m[15]=r=>s(de).value.value=r),"error-messages":s(de).errorMessage.value,column:"",multiple:""},{default:t(()=>[($(),D(O,null,te(h,r=>e(ye,{text:r,value:r,filter:"",density:"compact"},null,8,["text","value"])),64))]),_:1},8,["modelValue","error-messages"])]),e(se)]),_:1})]),_:1}),e(N,null,{default:t(()=>[e(o,null,{default:t(()=>[vl,d("div",null,[e(fe,{modelValue:s(u).value.value,"onUpdate:modelValue":m[16]||(m[16]=r=>s(u).value.value=r),"error-messages":s(u).errorMessage.value,column:"",multiple:""},{default:t(()=>[($(),D(O,null,te(B,r=>e(ye,{text:r,value:r,filter:"",density:"compact"},null,8,["text","value"])),64))]),_:1},8,["modelValue","error-messages"])]),e(se)]),_:1})]),_:1}),e(N,null,{default:t(()=>[e(o,null,{default:t(()=>[fl,d("div",null,[e(fe,{modelValue:s(k).value.value,"onUpdate:modelValue":m[17]||(m[17]=r=>s(k).value.value=r),"error-messages":s(k).errorMessage.value,column:"",multiple:""},{default:t(()=>[($(),D(O,null,te(q,r=>e(ye,{text:r,value:r,filter:"",density:"compact"},null,8,["text","value"])),64))]),_:1},8,["modelValue","error-messages"])]),e(se)]),_:1})]),_:1}),e(N,null,{default:t(()=>[e(o,null,{default:t(()=>[yl,e(fe,{modelValue:s(l).value.value,"onUpdate:modelValue":m[18]||(m[18]=r=>s(l).value.value=r),"error-messages":s(l).errorMessage.value,column:"",multiple:""},{default:t(()=>[e(ye,{value:"其他",text:"其他",filter:"",density:"compact"})]),_:1},8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(o,{cols:"12",md:"3",class:"text-center ps-6"},{default:t(()=>[bl]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(Re,{style:{"white-space":"pre-line"},variant:"outlined",clearable:"",modelValue:s(f).value.value,"onUpdate:modelValue":m[19]||(m[19]=r=>s(f).value.value=r),"error-messages":s(f).errorMessage.value,"hide-details":""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(N,null,{default:t(()=>[e(o,{class:"text-center"},{default:t(()=>[e(ne,{type:"submit",class:"b-1 bg-accent mb-8",onClick:De})]),_:1})]),_:1})]),_:1},8,["onSubmit","disabled"])])]),_:1})]),_:1},8,["modelValue"])],64)}}},_l={class:"d-flex flex-row"},Vl={class:"mx-auto mb-5 rounded-lg"},kl={class:"mx-auto mb-5 rounded-lg"},wl={class:"mx-auto mb-5 rounded-lg"},hl={class:"mx-auto mb-5 rounded-lg"},$l={__name:"setting",setup(G){const{api:me,apiAuth:I}=ge(),V=pe();i(null),i([]),i([]);const W=["會員中心","基本資料"],U=["會員中心","地標管理"],w=["會員中心","貼文管理"],h=["會員中心","活動收藏"],B=i("option-1"),q=["會員中心","物資管理"],z=i("true"),S=i([]),A=async()=>{try{const{data:_}=await I.get("/user/mark");S.value=_.map(n=>({...n,isFavorite:!0}))}catch(_){console.error("Failed to fetch favorite event details:",_)}},p=async _=>{try{await I.patch("/user/mark",{eventId:_}),S.value=S.value.filter(n=>n._id!==_),V({text:"取消收藏",snackbarProps:{color:"info"}})}catch(n){console.error("取消收藏失败",n),V({text:"取消收藏失败",snackbarProps:{color:"red"}})}};return Xe(()=>{A()}),(_,n)=>{const g=Ge,v=re("router-link");return $(),D(O,null,[e(dt,{class:"b-1 text-center",width:"250"},{default:t(()=>[e(rt,{modelValue:B.value,"onUpdate:modelValue":n[0]||(n[0]=y=>B.value=y),color:"teal-darken-4",direction:"vertical","show-arrows":""},{default:t(()=>[e(we,{"prepend-icon":"mdi-account",text:"基本資料",value:"option-1",height:"100",class:"text-body-1 ms-1"}),e(we,{"prepend-icon":"mdi-lock",text:"地標管理",value:"option-2",height:"100",class:"text-body-1 ms-1"}),e(we,{"prepend-icon":"mdi-access-point",text:"貼文管理",value:"option-3",height:"100",class:"text-body-1 ms-1"}),e(we,{"prepend-icon":"mdi-book-cog",text:"活動收藏",value:"option-4",height:"100",class:"text-body-1 ms-1"}),e(we,{"prepend-icon":"mdi-package-variant-closed-check",text:"物資管理",value:"option-5",height:"100",class:"text-body-1 ms-1"})]),_:1},8,["modelValue"])]),_:1}),e(ce,{class:"h-100"},{default:t(()=>[d("div",_l,[e(ke,null,{default:t(()=>[e(ut,{modelValue:B.value,"onUpdate:modelValue":n[1]||(n[1]=y=>B.value=y),class:"my-10"},{default:t(()=>[e(he,{value:"option-1"},{default:t(()=>[e(g,{title:W}),e(Yt)]),_:1}),e(he,{value:"option-2"},{default:t(()=>[e(g,{title:U}),e(xl)]),_:1}),e(he,{value:"option-3"},{default:t(()=>[e(g,{title:w}),d("div",Vl,[e(Rt)]),d("div",kl,[e(qt)]),d("div",wl,[e(Vt)])]),_:1}),e(he,{value:"option-4"},{default:t(()=>[e(g,{title:h}),($(!0),D(O,null,te(S.value,y=>($(),D("div",{class:"w-66 mx-auto b-1 rounded-lg my-5",key:y._id},[e(ce,{variant:"flat",class:"rounded-lg"},{default:t(()=>[e(N,{class:"align-center my-4 ps-10"},{default:t(()=>[e(o,{cols:"3",class:"align-self-start"},{default:t(()=>[e(v,{to:"/event/"+y._id,style:{"text-decoration":"none"}},{default:t(()=>[e(be,{src:y.image,class:"b-1 rounded-lg",width:"250px",height:"280px",cover:""},null,8,["src"])]),_:2},1032,["to"])]),_:2},1024),e(o,{cols:"7",class:"align-self-start"},{default:t(()=>[e(_e,null,{default:t(()=>[L(P(y.title),1)]),_:2},1024),e(et,null,{default:t(()=>[L(P(y.organizer),1)]),_:2},1024),e(Pe,{style:{"white-space":"pre-line"}},{default:t(()=>[L(P(y.description),1)]),_:2},1024)]),_:2},1024),e(o,{cols:"2",class:"align-self-start mt-2"},{default:t(()=>[z.value?($(),ie(ee,{key:0,id:"btn",text:"取消收藏","prepend-icon":"mdi-bookmark",variant:"outlined",style:{"background-color":"#F5B4B4"},onClick:Q=>p(y._id)},null,8,["onClick"])):tt("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]),_:1}),e(he,{value:"option-5"},{default:t(()=>[e(g,{title:q}),d("div",hl,[e(Zt),e(Jt)])]),_:1})]),_:1},8,["modelValue"])]),_:1})])]),_:1})],64)}}},Gl=je($l,[["__scopeId","data-v-2e937919"]]);export{Gl as default};
