import{_ as ne}from"./inputText-CMFXtWBw.js";import{_ as de}from"./appButton-BDEmHFZI.js";import{i as K,a5 as O,n as x,P as ce,o as S,e as M,w as a,b as e,l,c as j,F as ie,t as E,au as R,B as P,x as b,z as ue,f as Q,g as n,av as me,m as z,a as D,p as W,D as X,E as Y,y as _e,V as L,T as G,k as H,h as fe,A as pe,aw as ve}from"./index-CBalmzPI.js";import{c as Z,a as N,u as ee,b as I,V as ae,f as be}from"./index.esm-BCERKO5v.js";import{_ as te}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as d,a as g}from"./VRow-C3pH8_4g.js";import{a as se,V as J}from"./VContainer-D3aEslrv.js";import{V as ge}from"./VTextarea-CUZCd_WE.js";import{V as he}from"./VBreadcrumbs-DOUMiQ5f.js";import{V as ye}from"./VNumberInput-D2OGYNf3.js";import"./_commonjsHelpers-Cpj98o6Y.js";const le=p=>(X("data-v-43c68dcf"),p=p(),Y(),p),xe=le(()=>l("div",{class:"b-1 info-margin text-center text-body-1 pa-2 bg-accent rounded-t-lg font-weight-bold",style:{width:"150px",padding:"0","border-bottom":"0px"}},"留言板",-1)),Ve={class:"b-1 pa-5 info-margin"},we={class:"pa-4"},ke={class:"ml-1"},$e={class:"ml-16 text-body-2"},Se={key:0,class:"text-center text-body-2 mt-4 mx-auto"},qe=le(()=>l("h1",{style:{color:"#bfbfbf"},class:"mb-15"}," 目前暫無任何留言 ",-1)),Ce=[qe],Ie={class:"pa-4"},Be={__name:"comment",setup(p){const{api:U,apiAuth:V}=W(),w=K(),h=O(),y=Z({comment:N().required("留言內容必填")}),{handleSubmit:B,isSubmitting:q,resetForm:T}=ee({validationSchema:y,initialValues:{comment:""}}),o=x([]),k=async()=>{try{const{data:i}=await V.get("/comment/"+h.params.id);console.log(i),o.value=i.result,console.log(o.value[0].user.username)}catch(i){console.log(i)}};ce(()=>{k()});const C=I("comment"),A=B(async i=>{var c,s;try{const u={content:i.comment,materialId:h.params.id};console.log(u),await V.post("comment/",u),w({text:"新增成功",snackbarProps:{color:"green"}}),T(),k()}catch(u){console.log(u),w({text:((s=(c=u==null?void 0:u.response)==null?void 0:c.data)==null?void 0:s.message)||"發生錯誤",snackbarProps:{color:"red"}})}}),$=x([]);return(async()=>{var i,c;try{const{data:s}=await V.get("/user/profile");$.value=[s.result],console.log($.value)}catch(s){w({text:((c=(i=s==null?void 0:s.response)==null?void 0:i.data)==null?void 0:c.message)||"發生錯誤",snackbarProps:{color:"red"}})}})(),(i,c)=>(S(),M(g,{class:"mt-10"},{default:a(()=>[e(d,null,{default:a(()=>[xe,l("div",Ve,[(S(!0),j(ie,null,E(o.value,s=>(S(),M(g,{key:s._id},{default:a(()=>[l("div",we,[e(R,{color:"primary b-1",class:"me-3",size:"large"},{default:a(()=>[e(P,{src:s.user.avatar||"default-avatar-url"},null,8,["src"])]),_:2},1024),l("span",ke,b(s.user.username),1),l("p",$e,b(s.content),1)])]),_:2},1024))),128)),e(g,{class:"my-10"},{default:a(()=>[o.value.length===0?(S(),j("div",Se,Ce)):ue("",!0),e(se)]),_:1}),e(g,{class:"my-2"},{default:a(()=>[l("div",Ie,[e(ae,{onSubmit:Q(n(A),["prevent"]),disabled:n(q)},{default:a(()=>[e(ge,{ref:"textarea",modelValue:n(C).value.value,"onUpdate:modelValue":c[0]||(c[0]=s=>n(C).value.value=s),"error-messages":n(C).errorMessage.value,placeholder:"請輸入您的留言或提問",variant:"outlined",width:"600",maxlength:"20",counter:""},me({_:2},[E($.value,s=>({name:"prepend",fn:a(()=>[e(R,{color:"primary ",class:"me-1 b-1",size:"large"},{default:a(()=>[e(P,{src:s.avatar},null,8,["src"])]),_:2},1024)])}))]),1032,["modelValue","error-messages"]),e(z,{type:"submit",variant:"text",class:"rounded-md b-1 bg-accent mt-2",density:"comfortable",ripple:!1},{default:a(()=>[D("送出")]),_:1})]),_:1},8,["onSubmit","disabled"])])]),_:1})])]),_:1})]),_:1}))}},Te=te(Be,[["__scopeId","data-v-43c68dcf"]]),v=p=>(X("data-v-49238841"),p=p(),Y(),p),Ae={style:{width:"360px",height:"360px"},class:"b-1 pa-2 d-flex justify-center"},Fe=v(()=>l("label",{class:"form-label"},"需求單位",-1)),Me=v(()=>l("label",{class:"form-label"},"物資類別",-1)),Pe=v(()=>l("label",{class:"form-label"},"需求介紹",-1)),ze=v(()=>l("label",{class:"form-label"},"所需數量",-1)),De=v(()=>l("p",null,"2包",-1)),Ne={class:"b-1 bg-white rounded-sm pt-5 mt-1"},Ue=v(()=>l("label",{class:"form-label"},"捐贈數量",-1)),je=v(()=>l("label",{class:"form-label"},"單位／姓名",-1)),Ee=v(()=>l("label",{class:"form-label"},"聯絡電話",-1)),Re={class:"mx-auto"},Le={__name:"[id]",setup(p){const{api:U,apiAuth:V}=W(),w=O(),h=K(),y=x(!1),B=m=>{y.value=!0},q=()=>{y.value=!1},T=x([{title:"首頁",disabled:!1,href:"/"},{title:"我要募資",disabled:!1,href:"/material/find/findMaterial"},{title:"物資詳情",disabled:!0}]),o=x({_id:"",name:"",quantity:0,category:"",description:"",image:""}),k=x(null);(async()=>{var m,t;try{const{data:r}=await U.get("/material/"+w.params.id);o.value._id=r.result._id,o.value.name=r.result.name,o.value.quantity=r.result.quantity,o.value.category=r.result.category,o.value.description=r.result.description,o.value.organizer=r.result.organizer,o.value.image=r.result.image}catch(r){console.log(r),h({text:((t=(m=r==null?void 0:r.response)==null?void 0:m.data)==null?void 0:t.message)||"發生錯誤",snackbarProps:{color:"red"}})}})();const A=Z({donator:N().required("服務單位必填"),quantity:be().min(1,"數量不符").required("數量必填"),phone:N().required("聯絡電話必填")}),{handleSubmit:$,isSubmitting:F,resetForm:i}=ee({validationSchema:A,initialValues:{donator:"",quantity:0,phone:""}}),c=I("donator"),s=I("quantity"),u=I("phone"),oe=$(async m=>{var t,r;try{console.log(o.value._id);const _={donator:m.donator,quantity:m.quantity,phone:m.phone,id:o.value._id};console.log(_),await V.post("material/donate",_),h({text:"新增成功",snackbarProps:{color:"green"}}),q()}catch(_){console.log(_),h({text:((r=(t=_==null?void 0:_.response)==null?void 0:t.data)==null?void 0:r.message)||"發生錯誤",snackbarProps:{color:"red"}})}});function re(m){const t=document.querySelector(m);t&&(t.scrollIntoView({behavior:"smooth"}),ve(()=>{k.value.focus()}))}return(m,t)=>{const r=de,_=ne;return S(),M(J,{style:{padding:"0.5rem 15rem 3rem 15rem"}},{default:a(()=>[e(he,{items:T.value},{divider:a(()=>[e(_e,{icon:"mdi-chevron-right"})]),_:1},8,["items"]),e(g,{"justify-center":"",class:"mt-5"},{default:a(()=>[e(d,{cols:"5",class:"d-flex justify-center align-center"},{default:a(()=>[l("div",Ae,[e(P,{src:o.value.image,"max-width":"330","max-height":"330",contain:""},null,8,["src"])])]),_:1}),e(d,{cols:"5"},{default:a(()=>[e(L,{variant:"flat",id:"resourceCard"},{default:a(()=>[e(G,{class:"font-weight-black mb-3 text-h5"},{default:a(()=>[D("物資名稱："+b(o.value.name),1)]),_:1}),e(se,{thickness:"0"}),e(g,null,{default:a(()=>[e(d,{cols:"12",md:"3",class:"my-auto"},{default:a(()=>[Fe]),_:1}),e(d,{cols:"12",md:"9"},{default:a(()=>[l("p",null,b(o.value.organizer),1)]),_:1}),e(d,{cols:"12",md:"3",class:"my-auto"},{default:a(()=>[Me]),_:1}),e(d,{cols:"12",md:"9"},{default:a(()=>[l("p",null,b(o.value.category),1)]),_:1}),e(d,{cols:"12",md:"3"},{default:a(()=>[Pe]),_:1}),e(d,{cols:"12",md:"9"},{default:a(()=>[l("p",null,b(o.value.description),1)]),_:1}),e(d,{cols:"12",md:"3",class:"my-auto"},{default:a(()=>[ze]),_:1}),e(d,{cols:"12",md:"9",class:"my-auto"},{default:a(()=>[De]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(r,{text:"我要留言",width:"90",class:"me-4 bg-third",onClick:t[0]||(t[0]=f=>re("#msg"))}),e(r,{text:"我要捐贈",width:"90",class:"bg-third",onClick:t[1]||(t[1]=f=>B(null))}),e(pe,{"max-width":"700px",modelValue:y.value,"onUpdate:modelValue":t[6]||(t[6]=f=>y.value=f)},{default:a(()=>[e(L,{class:"bg-third"},{default:a(()=>[e(J,null,{default:a(()=>[e(H,{class:"pa-0"},{default:a(()=>[e(z,{id:"close",icon:"$close",variant:"text",onClick:t[2]||(t[2]=f=>q())})]),_:1}),e(G,{class:"font-weight-black text-left text-h5 py-0"},{default:a(()=>[D("物資名稱："+b(o.value.name),1)]),_:1}),l("div",Ne,[e(fe,null,{default:a(()=>[e(ae,{onSubmit:Q(n(oe),["prevent"]),disabled:n(F)},{default:a(()=>[e(g,null,{default:a(()=>[e(d,{cols:"12",md:"3",class:"my-auto text-center"},{default:a(()=>[Ue]),_:1}),e(d,{cols:"12",md:"9"},{default:a(()=>[e(n(ye),{"control-variant":"stacked",variant:"outlined",density:"comfortable",inset:"",label:"輸入數量","hide-details":"",min:0,modelValue:n(s).value.value,"onUpdate:modelValue":t[3]||(t[3]=f=>n(s).value.value=f),"error-messages":n(s).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(d,{cols:"12",md:"3",class:"my-auto text-center"},{default:a(()=>[je]),_:1}),e(d,{cols:"12",md:"9"},{default:a(()=>[e(_,{modelValue:n(c).value.value,"onUpdate:modelValue":t[4]||(t[4]=f=>n(c).value.value=f),"error-messages":n(c).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(d,{cols:"12",md:"3",class:"my-auto text-center"},{default:a(()=>[Ee]),_:1}),e(d,{cols:"12",md:"9"},{default:a(()=>[e(_,{modelValue:n(u).value.value,"onUpdate:modelValue":t[5]||(t[5]=f=>n(u).value.value=f),"error-messages":n(u).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(H,null,{default:a(()=>[l("div",Re,[e(z,{type:"submit",text:"送出",variant:"text",class:"rounded-xl b-1 bg-primary",density:"comfortable",loading:n(F)},null,8,["loading"])])]),_:1})]),_:1},8,["onSubmit","disabled"])]),_:1})])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Te,{id:"msg",ref_key:"textarea",ref:k},null,512)]),_:1})}}},aa=te(Le,[["__scopeId","data-v-49238841"]]);export{aa as default};
