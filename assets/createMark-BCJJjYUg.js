import{_ as ue}from"./submitButton-zsRC6bWi.js";import{_ as ie}from"./inputText-21tOsGNw.js";import{i as de,n as V,P as pe,o as v,e as me,w as l,b as e,y as ge,l as c,a as fe,f as ve,g as a,at as ye,c as x,t as b,F as A,V as _e,p as he,a5 as Ve,R as xe,D as be,E as Ae}from"./index-DOKjEeaw.js";import{c as Me,a as d,e as y,u as Se,b as p,V as Ue}from"./index.esm-DOR69wP7.js";import{l as i,V as $e,a as we,c as ke}from"./leaflet-src-BnlyGmY2.js";import{_ as ze}from"./search-BOiWTyLp.js";import{_ as Ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as Pe}from"./VBreadcrumbs-D7xO5Q_I.js";import{V as qe,a as Te}from"./VToolbar-BBlboDfp.js";import{a as g,V as u}from"./VRow-DEu2eCRv.js";import{V as Ee,b as _,a as h}from"./VSelect-Cln8gt1B.js";import{V as G,a as M}from"./VContainer-CAztc7wg.js";import{V as Ie}from"./VTextarea-0oifa1gI.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./VMenu-DznRLCu2.js";import"./ssrBoot-D7mdbICF.js";const m=$=>(be("data-v-c6d238a1"),$=$(),Ae(),$),Be={id:"map",ref:"map"},Le={class:"px-6"},Fe=m(()=>c("label",{class:"form-label"},"服務名稱",-1)),Ne=m(()=>c("label",{class:"form-label"},"服務電話",-1)),He=m(()=>c("label",{class:"form-label"},"服務類別",-1)),Re=m(()=>c("label",{class:"form-label"},"服務項目",-1)),We=m(()=>c("p",null,"服務對象",-1)),je=m(()=>c("p",null,"長期照顧",-1)),Oe=m(()=>c("p",null,"身心障礙",-1)),De=m(()=>c("p",null,"兒童及少年",-1)),Ze=m(()=>c("p",null,"社會救助",-1)),Ge=m(()=>c("p",null,"婦女",-1)),Ke=m(()=>c("p",null,"其他",-1)),Ye=m(()=>c("label",{class:"form-label"},"服務介紹",-1)),Je={__name:"createMark",setup($){const{api:Qe,apiAuth:j}=he();Ve();const z=de(),K=V([{title:"首頁",disabled:!1,href:"/"},{title:"新增資源",disabled:!0}]),Y=["長期照顧","身心障礙","婦女","兒童及少年","心理衛生","保護性服務","社會救助","綜合","其他"],J=["日照中心","護理之家","居家服務","交通接送","家庭托顧"],Q=["身心障礙者服務中心","輔具中心","職業重建中心","小作所","庇護工場"],X=["少年福利服務中心","親子館","課後班"],ee=["經濟補助","待用餐","基金會","社會福利中心"],oe=["婦女福利服務中心","新住民家庭服務中心"],le=V(["長期照顧","身心障礙","婦女","兒童及少年","心理衛生","保護性服務","社會救助","綜合","其他"]),ae=Me({name:d().required("服務單位必填"),address:d().required("服務地址必填"),tel:d(),cl:d(),category5:y().of(d()).required("分類必填"),category2:y().of(d()).required("分類必填"),category3:y().of(d()).required("分類必填"),category4:y().of(d()).required("分類必填"),category5:y().of(d()).required("分類必填"),category6:y().of(d()).required("分類必填"),category7:y().of(d()).required("分類必填"),description:d()}),{handleSubmit:te,isSubmitting:se,resetForm:re}=Se({validationSchema:ae,initialValues:{name:"",address:"",tel:"",cl:"",category1:[],category2:[],category3:[],category4:[],category5:[],category6:[],category7:[],description:""}}),C=p("name"),P=p("tel"),q=p("cl"),T=p("category1"),E=p("category2"),I=p("category3"),B=p("category4"),L=p("category5"),F=p("category6"),N=p("category7"),H=p("description"),{value:S,errorMessage:ne}=p("address"),O="AIzaSyAyML8H2ENbc_kzs_ZSI6qYf7CCbBt0dAA";console.log(O);const f=V(null),U=V(null),R=V(null);pe(()=>{f.value=i.map("map").setView([25.049183268037577,121.51342818384893],12),i.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(f.value)});const D=async()=>{if(!S.value){alert("找不到地址~");return}const r=`https://maps.googleapis.com/maps/api/geocode/json?address=${encodeURIComponent(S.value)}&key=${O}`;try{const n=(await xe.get(r)).data;if(console.log(n),n.results&&n.results.length>0){const s=n.results[0].geometry.location.lat,o=n.results[0].geometry.location.lng;U.value=s,R.value=o,console.log(U.value),console.log(n.results),console.log(s),console.log(o)}else alert("找不到地址~")}catch(t){console.error("新增地標錯誤:",t),alert("新增地標失敗~")}},ce=te(async r=>{var t,n;try{await D(),console.log(U.value);const s=[...r.category1,...r.category2,...r.category3,...r.category4,...r.category5,...r.category6,...r.category7],o={name:r.name,address:r.address,tel:r.tel,cl:r.cl,categories:s,description:r.description,lat:U.value,lng:R.value};console.log(o),await j.post("landmark/",o),z({text:"新增成功",snackbarProps:{color:"green"}}),f.value.eachLayer(Z=>{Z instanceof i.Marker&&f.value.removeLayer(Z)});const W=w[r.cl]||w.綜合,eo=i.marker([U.value,R.value],{icon:W}).bindPopup(`<h2 style="margin:5px 0 5px 0;text-decoration: underline;">${r.name}</h2>
        <h3 style="margin: 2px 0 2px 0;color:gray;">${r.address}</h3>
        <h3 style="margin: 2px 0 2px 0;color:gray;">${r.tel}</h3>
        <h4 style="margin: 2px 0 2px 0;color:gray;">類別：${s.join(" | ")}</h4>
        <p style="margin: 2px 0 2px 0;color:gray;">簡介：<br>${r.description}</p>`,{className:"custom-popup-class",maxWidth:400,minWidth:100,maxHeight:250,minHeight:100,closeOnClick:!1,autoPan:!0}).addTo(f.value).openpopup();re()}catch(s){console.log(s),z({text:((n=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:n.message)||"發生錯誤",snackbarProps:{color:"red"}})}}),w={服務對象:i.icon({iconUrl:"https://cdn-icons-png.flaticon.com/512/2377/2377871.png",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]}),長期照顧:i.icon({iconUrl:"https://cdn-icons-png.flaticon.com/512/12264/12264430.png",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]}),身心障礙:i.icon({iconUrl:"https://cdn-icons-png.flaticon.com/512/17573/17573294.png",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]}),兒童及少年:i.icon({iconUrl:"https://cdn-icons-png.flaticon.com/512/5759/5759522.png",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]}),心理衛生:i.icon({iconUrl:"https://cdn-icons-png.flaticon.com/512/4010/4010654.png",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]}),婦女:i.icon({iconUrl:"https://cdn-icons-png.flaticon.com/512/7457/7457069.png",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]}),社會救助:i.icon({iconUrl:"https://cdn-icons-png.flaticon.com/512/784/784791.png",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]}),綜合:i.icon({iconUrl:"https://cdn-icons-png.flaticon.com/512/5153/5153858.png",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]}),其他:i.icon({iconUrl:"https://cdn-icons-png.flaticon.com/512/5672/5672993.png",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]})},k=V([]);return(async()=>{var r,t;try{const{data:n}=await j.get("/landmark");k.value.splice(0,k.value.length,...n.result.data),console.log(n),f.value.eachLayer(s=>{s instanceof i.Marker&&f.value.removeLayer(s)}),console.log(k.value),k.value.forEach(s=>{const o=s.cl,W=w[o]||w.綜合;i.marker([s.lat,s.lng],{icon:W}).bindPopup(`<h2 style="margin:5px 0 5px 0;text-decoration: underline;">${s.name}</h2>
        <h3 style="margin: 2px 0 2px 0;color:gray;">${s.address}</h3>
        <h3 style="margin: 2px 0 2px 0;color:gray;">${s.tel}</h3>
        <h4 style="margin: 2px 0 2px 0;color:gray;">類別：${s.categories.join(" | ")}</h4>
        <p style="margin: 2px 0 2px 0;color:gray;">簡介：<br>${s.description}</p>`,{className:"custom-popup-class",maxWidth:400,minWidth:100,maxHeight:250,minHeight:100,closeOnClick:!1,autoPan:!1}).addTo(f.value)})}catch(n){console.log(n),z({text:((t=(r=n==null?void 0:n.response)==null?void 0:r.data)==null?void 0:t.message)||"發生錯誤",snackbarProps:{color:"red"}})}})(),(r,t)=>{const n=ie,s=ue;return v(),me(G,null,{default:l(()=>[e(Pe,{items:K.value},{divider:l(()=>[e(ge,{icon:"mdi-chevron-right"})]),_:1},8,["items"]),c("div",Be,null,512),e(_e,{width:"500px",variant:"outlined",class:"overflow-y-auto"},{default:l(()=>[e(qe,{color:"secondary bb-1",prominent:""},{default:l(()=>[e(Te,null,{default:l(()=>[fe(" 新增資源 ")]),_:1})]),_:1}),c("div",Le,[e(Ue,{onSubmit:ve(a(ce),["prevent"]),disabled:a(se)},{default:l(()=>[e(ze,{class:"mx-auto my-5",modelValue:a(S),"onUpdate:modelValue":t[0]||(t[0]=o=>ye(S)?S.value=o:null),"error-messages":a(ne),label:"輸入資源地址"},null,8,["modelValue","error-messages"]),e(g,{class:"my-5"},{default:l(()=>[e(u,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:l(()=>[Fe]),_:1}),e(u,{cols:"12",md:"9"},{default:l(()=>[e(n,{modelValue:a(C).value.value,"onUpdate:modelValue":t[1]||(t[1]=o=>a(C).value.value=o),"error-messages":a(C).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(u,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:l(()=>[Ne]),_:1}),e(u,{cols:"12",md:"9"},{default:l(()=>[e(n,{modelValue:a(P).value.value,"onUpdate:modelValue":t[2]||(t[2]=o=>a(P).value.value=o),"error-messages":a(P).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(u,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:l(()=>[He]),_:1}),e(u,{cols:"12",md:"9",class:"my-auto"},{default:l(()=>[e(Ee,{items:le.value,label:"服務類別",density:"comfortable",variant:"outlined",modelValue:a(q).value.value,"onUpdate:modelValue":t[3]||(t[3]=o=>a(q).value.value=o),"error-messages":a(q).errorMessage.value,"hide-details":""},null,8,["items","modelValue","error-messages"])]),_:1}),e(u,{cols:"12",md:"3",class:"mt-2 text-left ps-6"},{default:l(()=>[Re]),_:1}),e(u,{cols:"12",md:"9"},{default:l(()=>[e($e,{variant:"accordion"},{default:l(()=>[e(we,{title:"選擇類別"},{default:l(()=>[e(ke,null,{default:l(()=>[e(G,null,{default:l(()=>[e(g,null,{default:l(()=>[e(u,null,{default:l(()=>[We,c("div",null,[e(_,{modelValue:a(T).value.value,"onUpdate:modelValue":t[4]||(t[4]=o=>a(T).value.value=o),"error-messages":a(T).errorMessage.value,column:"",multiple:""},{default:l(()=>[(v(),x(A,null,b(Y,o=>e(h,{text:o,value:o,filter:"",density:"compact"},null,8,["text","value"])),64))]),_:1},8,["modelValue","error-messages"])]),e(M)]),_:1})]),_:1}),e(g,null,{default:l(()=>[e(u,null,{default:l(()=>[je,c("div",null,[e(_,{modelValue:a(E).value.value,"onUpdate:modelValue":t[5]||(t[5]=o=>a(E).value.value=o),"error-messages":a(E).errorMessage.value,column:"",multiple:""},{default:l(()=>[(v(),x(A,null,b(J,o=>e(h,{text:o,value:o,filter:"",density:"compact"},null,8,["text","value"])),64))]),_:1},8,["modelValue","error-messages"])]),e(M)]),_:1})]),_:1}),e(g,null,{default:l(()=>[e(u,null,{default:l(()=>[Oe,c("div",null,[e(_,{modelValue:a(I).value.value,"onUpdate:modelValue":t[6]||(t[6]=o=>a(I).value.value=o),"error-messages":a(I).errorMessage.value,column:"",multiple:""},{default:l(()=>[(v(),x(A,null,b(Q,o=>e(h,{text:o,value:o,filter:"",density:"compact"},null,8,["text","value"])),64))]),_:1},8,["modelValue","error-messages"])]),e(M)]),_:1})]),_:1}),e(g,null,{default:l(()=>[e(u,null,{default:l(()=>[De,c("div",null,[e(_,{modelValue:a(B).value.value,"onUpdate:modelValue":t[7]||(t[7]=o=>a(B).value.value=o),"error-messages":a(B).errorMessage.value,column:"",multiple:""},{default:l(()=>[(v(),x(A,null,b(X,o=>e(h,{text:o,value:o,filter:"",density:"compact"},null,8,["text","value"])),64))]),_:1},8,["modelValue","error-messages"])]),e(M)]),_:1})]),_:1}),e(g,null,{default:l(()=>[e(u,null,{default:l(()=>[Ze,c("div",null,[e(_,{modelValue:a(L).value.value,"onUpdate:modelValue":t[8]||(t[8]=o=>a(L).value.value=o),"error-messages":a(L).errorMessage.value,column:"",multiple:""},{default:l(()=>[(v(),x(A,null,b(ee,o=>e(h,{text:o,value:o,filter:"",density:"compact"},null,8,["text","value"])),64))]),_:1},8,["modelValue","error-messages"])]),e(M)]),_:1})]),_:1}),e(g,null,{default:l(()=>[e(u,null,{default:l(()=>[Ge,c("div",null,[e(_,{modelValue:a(N).value.value,"onUpdate:modelValue":t[9]||(t[9]=o=>a(N).value.value=o),"error-messages":a(N).errorMessage.value,column:"",multiple:""},{default:l(()=>[(v(),x(A,null,b(oe,o=>e(h,{text:o,value:o,filter:"",density:"compact"},null,8,["text","value"])),64))]),_:1},8,["modelValue","error-messages"])]),e(M)]),_:1})]),_:1}),e(g,null,{default:l(()=>[e(u,null,{default:l(()=>[Ke,e(_,{modelValue:a(F).value.value,"onUpdate:modelValue":t[10]||(t[10]=o=>a(F).value.value=o),"error-messages":a(F).errorMessage.value,column:"",multiple:""},{default:l(()=>[e(h,{value:"其他",text:"其他",filter:"",density:"compact"})]),_:1},8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(u,{cols:"12",md:"3",class:"text-left ps-6"},{default:l(()=>[Ye]),_:1}),e(u,{cols:"12",md:"9"},{default:l(()=>[e(Ie,{style:{"white-space":"pre-line"},variant:"outlined",clearable:"",modelValue:a(H).value.value,"onUpdate:modelValue":t[11]||(t[11]=o=>a(H).value.value=o),"error-messages":a(H).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(g,null,{default:l(()=>[e(u,{class:"text-center"},{default:l(()=>[e(s,{type:"submit",class:"b-1 bg-accent mb-8",onClick:D})]),_:1})]),_:1})]),_:1},8,["onSubmit","disabled"])])]),_:1})]),_:1})}}},_o=Ce(Je,[["__scopeId","data-v-c6d238a1"]]);export{_o as default};
