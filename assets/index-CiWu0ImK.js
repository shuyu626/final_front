import{_ as at}from"./search-DfVC28QQ.js";import{i as lt,n as S,O as st,P as nt,o as b,e as P,w as m,l as G,p as ht,q as ut,Q as ct,g as H,b as p,v as j,a as V,R as dt,m as U,c as T,t as z,F as D,V as _t,B as R}from"./index-COBXCSfB.js";import{l as M,V as $,a as q,b as Q,c as W}from"./leaflet-src-e1tKFMNf.js";import{c as ft}from"./_commonjsHelpers-Cpj98o6Y.js";import{_ as ot}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as rt}from"./VContainer-B-DKOWkg.js";import{V as Y,a as A}from"./VRow-gXr7-a7_.js";import{V as J,a as X}from"./VToolbar-FBhHw9sz.js";import{V as K}from"./VSelect-LbRUtmjV.js";import{V as pt}from"./VAppBar-BPNEA7Iq.js";import{V as mt}from"./VNavigationDrawer-DXPUoS-X.js";import{V as tt}from"./VCheckbox-DWw18ATZ.js";import"./VMenu-NO7MjHXi.js";import"./ssrBoot-CNgd7gji.js";var gt={exports:{}};/*!
Copyright (c) 2016 Dominik Moritz

This file is part of the leaflet locate control. It is licensed under the MIT license.
You can find the project at: https://github.com/domoritz/leaflet-locatecontrol
*/(function(B,E){(function(c,C){typeof C<"u"&&C.L?B.exports=c(L):B.exports=c(M),typeof C<"u"&&C.L&&(C.L.Control.Locate=c(L))})(function(c){const C=(i,r,n)=>{n=n.split(" "),n.forEach(function(a){c.DomUtil[i].call(this,r,a)})},w=(i,r)=>C("addClass",i,r),t=(i,r)=>C("removeClass",i,r),e=c.Marker.extend({initialize(i,r){c.Util.setOptions(this,r),this._latlng=i,this.createIcon()},createIcon(){const i=this.options;let r="";i.color!==void 0&&(r+=`stroke:${i.color};`),i.weight!==void 0&&(r+=`stroke-width:${i.weight};`),i.fillColor!==void 0&&(r+=`fill:${i.fillColor};`),i.fillOpacity!==void 0&&(r+=`fill-opacity:${i.fillOpacity};`),i.opacity!==void 0&&(r+=`opacity:${i.opacity};`);const n=this._getIconSVG(i,r);this._locationIcon=c.divIcon({className:n.className,html:n.svg,iconSize:[n.w,n.h]}),this.setIcon(this._locationIcon)},_getIconSVG(i,r){const n=i.radius,a=i.weight,l=n+a,h=l*2;return{className:"leaflet-control-locate-location",svg:`<svg xmlns="http://www.w3.org/2000/svg" width="${h}" height="${h}" version="1.1" viewBox="-${l} -${l} ${h} ${h}"><circle r="`+n+'" style="'+r+'" /></svg>',w:h,h}},setStyle(i){c.Util.setOptions(this,i),this.createIcon()}}),s=e.extend({initialize(i,r,n){c.Util.setOptions(this,n),this._latlng=i,this._heading=r,this.createIcon()},setHeading(i){this._heading=i},_getIconSVG(i,r){const n=i.radius,a=i.width+i.weight,l=(n+i.depth+i.weight)*2,h=`M0,0 l${i.width/2},${i.depth} l-${a},0 z`,u=`transform: rotate(${this._heading}deg)`;return{className:"leaflet-control-locate-heading",svg:`<svg xmlns="http://www.w3.org/2000/svg" width="${a}" height="${l}" version="1.1" viewBox="-${a/2} 0 ${a} ${l}" style="${u}"><path d="`+h+'" style="'+r+'" /></svg>',w:a,h:l}}}),o=c.Control.extend({options:{position:"topleft",layer:void 0,setView:"untilPanOrZoom",keepCurrentZoomLevel:!1,initialZoomLevel:!1,getLocationBounds(i){return i.bounds},flyTo:!1,clickBehavior:{inView:"stop",outOfView:"setView",inViewNotFollowing:"inView"},returnToPrevBounds:!1,cacheLocation:!0,drawCircle:!0,drawMarker:!0,showCompass:!0,markerClass:e,compassClass:s,circleStyle:{className:"leaflet-control-locate-circle",color:"#136AEC",fillColor:"#136AEC",fillOpacity:.15,weight:0},markerStyle:{className:"leaflet-control-locate-marker",color:"#fff",fillColor:"#2A93EE",fillOpacity:1,weight:3,opacity:1,radius:9},compassStyle:{fillColor:"#2A93EE",fillOpacity:1,weight:0,color:"#fff",opacity:1,radius:9,width:9,depth:6},followCircleStyle:{},followMarkerStyle:{},followCompassStyle:{},icon:"leaflet-control-locate-location-arrow",iconLoading:"leaflet-control-locate-spinner",iconElementTag:"span",textElementTag:"small",circlePadding:[0,0],metric:!0,createButtonCallback(i,r){const n=c.DomUtil.create("a","leaflet-bar-part leaflet-bar-part-single",i);n.title=r.strings.title,n.href="#",n.setAttribute("role","button");const a=c.DomUtil.create(r.iconElementTag,r.icon,n);if(r.strings.text!==void 0){const l=c.DomUtil.create(r.textElementTag,"leaflet-locate-text",n);l.textContent=r.strings.text,n.classList.add("leaflet-locate-text-active"),n.parentNode.style.display="flex",r.icon.length>0&&a.classList.add("leaflet-locate-icon")}return{link:n,icon:a}},onLocationError(i,r){alert(i.message)},onLocationOutsideMapBounds(i){i.stop(),alert(i.options.strings.outsideMapBoundsMsg)},showPopup:!0,strings:{title:"Show me where I am",metersUnit:"meters",feetUnit:"feet",popup:"You are within {distance} {unit} from this point",outsideMapBoundsMsg:"You seem located outside the boundaries of the map"},locateOptions:{maxZoom:1/0,watch:!0,setView:!1}},initialize(i){for(const r in i)typeof this.options[r]=="object"?c.extend(this.options[r],i[r]):this.options[r]=i[r];this.options.followMarkerStyle=c.extend({},this.options.markerStyle,this.options.followMarkerStyle),this.options.followCircleStyle=c.extend({},this.options.circleStyle,this.options.followCircleStyle),this.options.followCompassStyle=c.extend({},this.options.compassStyle,this.options.followCompassStyle)},onAdd(i){const r=c.DomUtil.create("div","leaflet-control-locate leaflet-bar leaflet-control");this._container=r,this._map=i,this._layer=this.options.layer||new c.LayerGroup,this._layer.addTo(i),this._event=void 0,this._compassHeading=null,this._prevBounds=null;const n=this.options.createButtonCallback(r,this.options);return this._link=n.link,this._icon=n.icon,c.DomEvent.on(this._link,"click",function(a){c.DomEvent.stopPropagation(a),c.DomEvent.preventDefault(a),this._onClick()},this).on(this._link,"dblclick",c.DomEvent.stopPropagation),this._resetVariables(),this._map.on("unload",this._unload,this),r},_onClick(){this._justClicked=!0;const i=this._isFollowing();if(this._userPanned=!1,this._userZoomed=!1,this._active&&!this._event)this.stop();else if(this._active){const r=this.options.clickBehavior;let n=r.outOfView;switch(this._map.getBounds().contains(this._event.latlng)&&(n=i?r.inView:r.inViewNotFollowing),r[n]&&(n=r[n]),n){case"setView":this.setView();break;case"stop":this.stop(),this.options.returnToPrevBounds&&(this.options.flyTo?this._map.flyToBounds:this._map.fitBounds).bind(this._map)(this._prevBounds);break}}else this.options.returnToPrevBounds&&(this._prevBounds=this._map.getBounds()),this.start();this._updateContainerStyle()},start(){this._activate(),this._event&&(this._drawMarker(this._map),this.options.setView&&this.setView()),this._updateContainerStyle()},stop(){this._deactivate(),this._cleanClasses(),this._resetVariables(),this._removeMarker()},stopFollowing(){this._userPanned=!0,this._updateContainerStyle(),this._drawMarker()},_activate(){if(!(this._active||!this._map)&&(this._map.locate(this.options.locateOptions),this._map.fire("locateactivate",this),this._active=!0,this._map.on("locationfound",this._onLocationFound,this),this._map.on("locationerror",this._onLocationError,this),this._map.on("dragstart",this._onDrag,this),this._map.on("zoomstart",this._onZoom,this),this._map.on("zoomend",this._onZoomEnd,this),this.options.showCompass)){const i="ondeviceorientationabsolute"in window;if(i||"ondeviceorientation"in window){const r=this,n=function(){c.DomEvent.on(window,i?"deviceorientationabsolute":"deviceorientation",r._onDeviceOrientation,r)};DeviceOrientationEvent&&typeof DeviceOrientationEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(function(a){a==="granted"&&n()}):n()}}},_deactivate(){!this._active||!this._map||(this._map.stopLocate(),this._map.fire("locatedeactivate",this),this._active=!1,this.options.cacheLocation||(this._event=void 0),this._map.off("locationfound",this._onLocationFound,this),this._map.off("locationerror",this._onLocationError,this),this._map.off("dragstart",this._onDrag,this),this._map.off("zoomstart",this._onZoom,this),this._map.off("zoomend",this._onZoomEnd,this),this.options.showCompass&&(this._compassHeading=null,"ondeviceorientationabsolute"in window?c.DomEvent.off(window,"deviceorientationabsolute",this._onDeviceOrientation,this):"ondeviceorientation"in window&&c.DomEvent.off(window,"deviceorientation",this._onDeviceOrientation,this)))},setView(){if(this._drawMarker(),this._isOutsideMapBounds())this._event=void 0,this.options.onLocationOutsideMapBounds(this);else if(this._justClicked&&this.options.initialZoomLevel!==!1){var i=this.options.flyTo?this._map.flyTo:this._map.setView;i.bind(this._map)([this._event.latitude,this._event.longitude],this.options.initialZoomLevel)}else if(this.options.keepCurrentZoomLevel){var i=this.options.flyTo?this._map.flyTo:this._map.panTo;i.bind(this._map)([this._event.latitude,this._event.longitude])}else{var i=this.options.flyTo?this._map.flyToBounds:this._map.fitBounds;this._ignoreEvent=!0,i.bind(this._map)(this.options.getLocationBounds(this._event),{padding:this.options.circlePadding,maxZoom:this.options.initialZoomLevel||this.options.locateOptions.maxZoom}),c.Util.requestAnimFrame(function(){this._ignoreEvent=!1},this)}},_drawCompass(){if(!this._event)return;const i=this._event.latlng;if(this.options.showCompass&&i&&this._compassHeading!==null){const r=this._isFollowing()?this.options.followCompassStyle:this.options.compassStyle;this._compass?(this._compass.setLatLng(i),this._compass.setHeading(this._compassHeading),this._compass.setStyle&&this._compass.setStyle(r)):this._compass=new this.options.compassClass(i,this._compassHeading,r).addTo(this._layer)}this._compass&&(!this.options.showCompass||this._compassHeading===null)&&(this._compass.removeFrom(this._layer),this._compass=null)},_drawMarker(){this._event.accuracy===void 0&&(this._event.accuracy=0);const i=this._event.accuracy,r=this._event.latlng;if(this.options.drawCircle){const u=this._isFollowing()?this.options.followCircleStyle:this.options.circleStyle;this._circle?this._circle.setLatLng(r).setRadius(i).setStyle(u):this._circle=c.circle(r,i,u).addTo(this._layer)}let n,a;if(this.options.metric?(n=i.toFixed(0),a=this.options.strings.metersUnit):(n=(i*3.2808399).toFixed(0),a=this.options.strings.feetUnit),this.options.drawMarker){const u=this._isFollowing()?this.options.followMarkerStyle:this.options.markerStyle;this._marker?(this._marker.setLatLng(r),this._marker.setStyle&&this._marker.setStyle(u)):this._marker=new this.options.markerClass(r,u).addTo(this._layer)}this._drawCompass();const l=this.options.strings.popup;function h(){return typeof l=="string"?c.Util.template(l,{distance:n,unit:a}):typeof l=="function"?l({distance:n,unit:a}):l}this.options.showPopup&&l&&this._marker&&this._marker.bindPopup(h())._popup.setLatLng(r),this.options.showPopup&&l&&this._compass&&this._compass.bindPopup(h())._popup.setLatLng(r)},_removeMarker(){this._layer.clearLayers(),this._marker=void 0,this._circle=void 0},_unload(){this.stop(),this._map&&this._map.off("unload",this._unload,this)},_setCompassHeading(i){!isNaN(parseFloat(i))&&isFinite(i)?(i=Math.round(i),this._compassHeading=i,c.Util.requestAnimFrame(this._drawCompass,this)):this._compassHeading=null},_onCompassNeedsCalibration(){this._setCompassHeading()},_onDeviceOrientation(i){this._active&&(i.webkitCompassHeading?this._setCompassHeading(i.webkitCompassHeading):i.absolute&&i.alpha&&this._setCompassHeading(360-i.alpha))},_onLocationError(i){i.code==3&&this.options.locateOptions.watch||(this.stop(),this.options.onLocationError(i,this))},_onLocationFound(i){if(!(this._event&&this._event.latlng.lat===i.latlng.lat&&this._event.latlng.lng===i.latlng.lng&&this._event.accuracy===i.accuracy)&&this._active){switch(this._event=i,this._drawMarker(),this._updateContainerStyle(),this.options.setView){case"once":this._justClicked&&this.setView();break;case"untilPan":this._userPanned||this.setView();break;case"untilPanOrZoom":!this._userPanned&&!this._userZoomed&&this.setView();break;case"always":this.setView();break}this._justClicked=!1}},_onDrag(){this._event&&!this._ignoreEvent&&(this._userPanned=!0,this._updateContainerStyle(),this._drawMarker())},_onZoom(){this._event&&!this._ignoreEvent&&(this._userZoomed=!0,this._updateContainerStyle(),this._drawMarker())},_onZoomEnd(){this._event&&this._drawCompass(),this._event&&!this._ignoreEvent&&this._marker&&!this._map.getBounds().pad(-.3).contains(this._marker.getLatLng())&&(this._userPanned=!0,this._updateContainerStyle(),this._drawMarker())},_isFollowing(){if(!this._active)return!1;if(this.options.setView==="always")return!0;if(this.options.setView==="untilPan")return!this._userPanned;if(this.options.setView==="untilPanOrZoom")return!this._userPanned&&!this._userZoomed},_isOutsideMapBounds(){return this._event===void 0?!1:this._map.options.maxBounds&&!this._map.options.maxBounds.contains(this._event.latlng)},_updateContainerStyle(){this._container&&(this._active&&!this._event?this._setClasses("requesting"):this._isFollowing()?this._setClasses("following"):this._active?this._setClasses("active"):this._cleanClasses())},_setClasses(i){i=="requesting"?(t(this._container,"active following"),w(this._container,"requesting"),t(this._icon,this.options.icon),w(this._icon,this.options.iconLoading)):i=="active"?(t(this._container,"requesting following"),w(this._container,"active"),t(this._icon,this.options.iconLoading),w(this._icon,this.options.icon)):i=="following"&&(t(this._container,"requesting"),w(this._container,"active following"),t(this._icon,this.options.iconLoading),w(this._icon,this.options.icon))},_cleanClasses(){c.DomUtil.removeClass(this._container,"requesting"),c.DomUtil.removeClass(this._container,"active"),c.DomUtil.removeClass(this._container,"following"),t(this._icon,this.options.iconLoading),w(this._icon,this.options.icon)},_resetVariables(){this._active=!1,this._justClicked=!1,this._userPanned=!1,this._userZoomed=!1}});return c.control.locate=i=>new c.Control.Locate(i),o},window)})(gt);var et={exports:{}};(function(B,E){(function(c,C){C(E)})(ft,function(c){var C=L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,clusterPane:L.Marker.prototype.options.pane,spiderfyOnEveryZoom:!1,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyShapePositions:null,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(t){L.Util.setOptions(this,t),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.addEventParent(this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.addEventParent(this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[],this._childMarkerEventHandlers={dragstart:this._childMarkerDragStart,move:this._childMarkerMoved,dragend:this._childMarkerDragEnd};var e=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,e?this._withAnimation:this._noAnimation),this._markerCluster=e?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(t){if(t instanceof L.LayerGroup)return this.addLayers([t]);if(!t.getLatLng)return this._nonPointGroup.addLayer(t),this.fire("layeradd",{layer:t}),this;if(!this._map)return this._needsClustering.push(t),this.fire("layeradd",{layer:t}),this;if(this.hasLayer(t))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(t,this._maxZoom),this.fire("layeradd",{layer:t}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons();var e=t,s=this._zoom;if(t.__parent)for(;e.__parent._zoom>=s;)e=e.__parent;return this._currentShownBounds.contains(e.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(t,e):this._animationAddLayerNonAnimated(t,e)),this},removeLayer:function(t){return t instanceof L.LayerGroup?this.removeLayers([t]):t.getLatLng?this._map?t.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(t)),this._removeLayer(t,!0),this.fire("layerremove",{layer:t}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),t.off(this._childMarkerEventHandlers,this),this._featureGroup.hasLayer(t)&&(this._featureGroup.removeLayer(t),t.clusterShow&&t.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,t)&&this.hasLayer(t)&&this._needsRemoving.push({layer:t,latlng:t._latlng}),this.fire("layerremove",{layer:t}),this):(this._nonPointGroup.removeLayer(t),this.fire("layerremove",{layer:t}),this)},addLayers:function(t,e){if(!L.Util.isArray(t))return this.addLayer(t);var s=this._featureGroup,o=this._nonPointGroup,i=this.options.chunkedLoading,r=this.options.chunkInterval,n=this.options.chunkProgress,a=t.length,l=0,h=!0,u;if(this._map){var _=new Date().getTime(),d=L.bind(function(){var k=new Date().getTime();for(this._map&&this._unspiderfy&&this._unspiderfy();l<a;l++){if(i&&l%200===0){var O=new Date().getTime()-k;if(O>r)break}if(u=t[l],u instanceof L.LayerGroup){h&&(t=t.slice(),h=!1),this._extractNonGroupLayers(u,t),a=t.length;continue}if(!u.getLatLng){o.addLayer(u),e||this.fire("layeradd",{layer:u});continue}if(!this.hasLayer(u)&&(this._addLayer(u,this._maxZoom),e||this.fire("layeradd",{layer:u}),u.__parent&&u.__parent.getChildCount()===2)){var y=u.__parent.getAllChildMarkers(),f=y[0]===u?y[1]:y[0];s.removeLayer(f)}}n&&n(l,a,new Date().getTime()-_),l===a?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(d,this.options.chunkDelay)},this);d()}else for(var v=this._needsClustering;l<a;l++){if(u=t[l],u instanceof L.LayerGroup){h&&(t=t.slice(),h=!1),this._extractNonGroupLayers(u,t),a=t.length;continue}if(!u.getLatLng){o.addLayer(u);continue}this.hasLayer(u)||v.push(u)}return this},removeLayers:function(t){var e,s,o=t.length,i=this._featureGroup,r=this._nonPointGroup,n=!0;if(!this._map){for(e=0;e<o;e++){if(s=t[e],s instanceof L.LayerGroup){n&&(t=t.slice(),n=!1),this._extractNonGroupLayers(s,t),o=t.length;continue}this._arraySplice(this._needsClustering,s),r.removeLayer(s),this.hasLayer(s)&&this._needsRemoving.push({layer:s,latlng:s._latlng}),this.fire("layerremove",{layer:s})}return this}if(this._unspiderfy){this._unspiderfy();var a=t.slice(),l=o;for(e=0;e<l;e++){if(s=a[e],s instanceof L.LayerGroup){this._extractNonGroupLayers(s,a),l=a.length;continue}this._unspiderfyLayer(s)}}for(e=0;e<o;e++){if(s=t[e],s instanceof L.LayerGroup){n&&(t=t.slice(),n=!1),this._extractNonGroupLayers(s,t),o=t.length;continue}if(!s.__parent){r.removeLayer(s),this.fire("layerremove",{layer:s});continue}this._removeLayer(s,!0,!0),this.fire("layerremove",{layer:s}),i.hasLayer(s)&&(i.removeLayer(s),s.clusterShow&&s.clusterShow())}return this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),this},clearLayers:function(){return this._map||(this._needsClustering=[],this._needsRemoving=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(t){t.off(this._childMarkerEventHandlers,this),delete t.__parent},this),this._map&&this._generateInitialClusters(),this},getBounds:function(){var t=new L.LatLngBounds;this._topClusterLevel&&t.extend(this._topClusterLevel._bounds);for(var e=this._needsClustering.length-1;e>=0;e--)t.extend(this._needsClustering[e].getLatLng());return t.extend(this._nonPointGroup.getBounds()),t},eachLayer:function(t,e){var s=this._needsClustering.slice(),o=this._needsRemoving,i,r,n;for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(s),r=s.length-1;r>=0;r--){for(i=!0,n=o.length-1;n>=0;n--)if(o[n].layer===s[r]){i=!1;break}i&&t.call(e,s[r])}this._nonPointGroup.eachLayer(t,e)},getLayers:function(){var t=[];return this.eachLayer(function(e){t.push(e)}),t},getLayer:function(t){var e=null;return t=parseInt(t,10),this.eachLayer(function(s){L.stamp(s)===t&&(e=s)}),e},hasLayer:function(t){if(!t)return!1;var e,s=this._needsClustering;for(e=s.length-1;e>=0;e--)if(s[e]===t)return!0;for(s=this._needsRemoving,e=s.length-1;e>=0;e--)if(s[e].layer===t)return!1;return!!(t.__parent&&t.__parent._group===this)||this._nonPointGroup.hasLayer(t)},zoomToShowLayer:function(t,e){var s=this._map;typeof e!="function"&&(e=function(){});var o=function(){(s.hasLayer(t)||s.hasLayer(t.__parent))&&!this._inZoomAnimation&&(this._map.off("moveend",o,this),this.off("animationend",o,this),s.hasLayer(t)?e():t.__parent._icon&&(this.once("spiderfied",e,this),t.__parent.spiderfy()))};t._icon&&this._map.getBounds().contains(t.getLatLng())?e():t.__parent._zoom<Math.round(this._map._zoom)?(this._map.on("moveend",o,this),this._map.panTo(t.getLatLng())):(this._map.on("moveend",o,this),this.on("animationend",o,this),t.__parent.zoomToBounds())},onAdd:function(t){this._map=t;var e,s,o;if(!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.addTo(t),this._nonPointGroup.addTo(t),this._gridClusters||this._generateInitialClusters(),this._maxLat=t.options.crs.projection.MAX_LATITUDE,e=0,s=this._needsRemoving.length;e<s;e++)o=this._needsRemoving[e],o.newlatlng=o.layer._latlng,o.layer._latlng=o.latlng;for(e=0,s=this._needsRemoving.length;e<s;e++)o=this._needsRemoving[e],this._removeLayer(o.layer,!0),o.layer._latlng=o.newlatlng;this._needsRemoving=[],this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds(),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),s=this._needsClustering,this._needsClustering=[],this.addLayers(s,!0)},onRemove:function(t){t.off("zoomend",this._zoomEnd,this),t.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),delete this._maxLat,this._hideCoverage(),this._featureGroup.remove(),this._nonPointGroup.remove(),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(t){for(var e=t;e&&!e._icon;)e=e.__parent;return e||null},_arraySplice:function(t,e){for(var s=t.length-1;s>=0;s--)if(t[s]===e)return t.splice(s,1),!0},_removeFromGridUnclustered:function(t,e){for(var s=this._map,o=this._gridUnclustered,i=Math.floor(this._map.getMinZoom());e>=i&&o[e].removeObject(t,s.project(t.getLatLng(),e));e--);},_childMarkerDragStart:function(t){t.target.__dragStart=t.target._latlng},_childMarkerMoved:function(t){if(!this._ignoreMove&&!t.target.__dragStart){var e=t.target._popup&&t.target._popup.isOpen();this._moveChild(t.target,t.oldLatLng,t.latlng),e&&t.target.openPopup()}},_moveChild:function(t,e,s){t._latlng=e,this.removeLayer(t),t._latlng=s,this.addLayer(t)},_childMarkerDragEnd:function(t){var e=t.target.__dragStart;delete t.target.__dragStart,e&&this._moveChild(t.target,e,t.target._latlng)},_removeLayer:function(t,e,s){var o=this._gridClusters,i=this._gridUnclustered,r=this._featureGroup,n=this._map,a=Math.floor(this._map.getMinZoom());e&&this._removeFromGridUnclustered(t,this._maxZoom);var l=t.__parent,h=l._markers,u;for(this._arraySplice(h,t);l&&(l._childCount--,l._boundsNeedUpdate=!0,!(l._zoom<a));)e&&l._childCount<=1?(u=l._markers[0]===t?l._markers[1]:l._markers[0],o[l._zoom].removeObject(l,n.project(l._cLatLng,l._zoom)),i[l._zoom].addObject(u,n.project(u.getLatLng(),l._zoom)),this._arraySplice(l.__parent._childClusters,l),l.__parent._markers.push(u),u.__parent=l.__parent,l._icon&&(r.removeLayer(l),s||r.addLayer(u))):l._iconNeedsUpdate=!0,l=l.__parent;delete t.__parent},_isOrIsParent:function(t,e){for(;e;){if(t===e)return!0;e=e.parentNode}return!1},fire:function(t,e,s){if(e&&e.layer instanceof L.MarkerCluster){if(e.originalEvent&&this._isOrIsParent(e.layer._icon,e.originalEvent.relatedTarget))return;t="cluster"+t}L.FeatureGroup.prototype.fire.call(this,t,e,s)},listens:function(t,e){return L.FeatureGroup.prototype.listens.call(this,t,e)||L.FeatureGroup.prototype.listens.call(this,"cluster"+t,e)},_defaultIconCreateFunction:function(t){var e=t.getChildCount(),s=" marker-cluster-";return e<10?s+="small":e<100?s+="medium":s+="large",new L.DivIcon({html:"<div><span>"+e+"</span></div>",className:"marker-cluster"+s,iconSize:new L.Point(40,40)})},_bindEvents:function(){var t=this._map,e=this.options.spiderfyOnMaxZoom,s=this.options.showCoverageOnHover,o=this.options.zoomToBoundsOnClick,i=this.options.spiderfyOnEveryZoom;(e||o||i)&&this.on("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),s&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),t.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(t){var e=t.layer,s=e;if(!(t.type==="clusterkeypress"&&t.originalEvent&&t.originalEvent.keyCode!==13)){for(;s._childClusters.length===1;)s=s._childClusters[0];s._zoom===this._maxZoom&&s._childCount===e._childCount&&this.options.spiderfyOnMaxZoom?e.spiderfy():this.options.zoomToBoundsOnClick&&e.zoomToBounds(),this.options.spiderfyOnEveryZoom&&e.spiderfy(),t.originalEvent&&t.originalEvent.keyCode===13&&this._map._container.focus()}},_showCoverage:function(t){var e=this._map;this._inZoomAnimation||(this._shownPolygon&&e.removeLayer(this._shownPolygon),t.layer.getChildCount()>2&&t.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(t.layer.getConvexHull(),this.options.polygonOptions),e.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var t=this.options.spiderfyOnMaxZoom,e=this.options.showCoverageOnHover,s=this.options.zoomToBoundsOnClick,o=this.options.spiderfyOnEveryZoom,i=this._map;(t||s||o)&&this.off("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),e&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),i.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var t=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,t),this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),t),this._currentShownBounds=t}},_generateInitialClusters:function(){var t=Math.ceil(this._map.getMaxZoom()),e=Math.floor(this._map.getMinZoom()),s=this.options.maxClusterRadius,o=s;typeof s!="function"&&(o=function(){return s}),this.options.disableClusteringAtZoom!==null&&(t=this.options.disableClusteringAtZoom-1),this._maxZoom=t,this._gridClusters={},this._gridUnclustered={};for(var i=t;i>=e;i--)this._gridClusters[i]=new L.DistanceGrid(o(i)),this._gridUnclustered[i]=new L.DistanceGrid(o(i));this._topClusterLevel=new this._markerCluster(this,e-1)},_addLayer:function(t,e){var s=this._gridClusters,o=this._gridUnclustered,i=Math.floor(this._map.getMinZoom()),r,n;for(this.options.singleMarkerMode&&this._overrideMarkerIcon(t),t.on(this._childMarkerEventHandlers,this);e>=i;e--){r=this._map.project(t.getLatLng(),e);var a=s[e].getNearObject(r);if(a){a._addChild(t),t.__parent=a;return}if(a=o[e].getNearObject(r),a){var l=a.__parent;l&&this._removeLayer(a,!1);var h=new this._markerCluster(this,e,a,t);s[e].addObject(h,this._map.project(h._cLatLng,e)),a.__parent=h,t.__parent=h;var u=h;for(n=e-1;n>l._zoom;n--)u=new this._markerCluster(this,n,u),s[n].addObject(u,this._map.project(a.getLatLng(),n));l._addChild(u),this._removeFromGridUnclustered(a,e);return}o[e].addObject(t,r)}this._topClusterLevel._addChild(t),t.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer(function(t){t instanceof L.MarkerCluster&&t._iconNeedsUpdate&&t._updateIcon()})},_enqueue:function(t){this._queue.push(t),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var t=0;t<this._queue.length;t++)this._queue[t].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){var t=Math.round(this._map._zoom);this._processQueue(),this._zoom<t&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,t)):this._zoom>t?(this._animationStart(),this._animationZoomOut(this._zoom,t)):this._moveEnd()},_getExpandedVisibleBounds:function(){if(this.options.removeOutsideVisibleBounds){if(L.Browser.mobile)return this._checkBoundsMaxLat(this._map.getBounds())}else return this._mapBoundsInfinite;return this._checkBoundsMaxLat(this._map.getBounds().pad(1))},_checkBoundsMaxLat:function(t){var e=this._maxLat;return e!==void 0&&(t.getNorth()>=e&&(t._northEast.lat=1/0),t.getSouth()<=-e&&(t._southWest.lat=-1/0)),t},_animationAddLayerNonAnimated:function(t,e){if(e===t)this._featureGroup.addLayer(t);else if(e._childCount===2){e._addToMap();var s=e.getAllChildMarkers();this._featureGroup.removeLayer(s[0]),this._featureGroup.removeLayer(s[1])}else e._updateIcon()},_extractNonGroupLayers:function(t,e){var s=t.getLayers(),o=0,i;for(e=e||[];o<s.length;o++){if(i=s[o],i instanceof L.LayerGroup){this._extractNonGroupLayers(i,e);continue}e.push(i)}return e},_overrideMarkerIcon:function(t){var e=t.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[t]}});return e}});L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-1/0,-1/0),new L.LatLng(1/0,1/0))}),L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(t,e){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),t),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationZoomOut:function(t,e){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),t),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationAddLayer:function(t,e){this._animationAddLayerNonAnimated(t,e)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationZoomIn:function(t,e){var s=this._getExpandedVisibleBounds(),o=this._featureGroup,i=Math.floor(this._map.getMinZoom()),r;this._ignoreMove=!0,this._topClusterLevel._recursively(s,t,i,function(n){var a=n._latlng,l=n._markers,h;for(s.contains(a)||(a=null),n._isSingleParent()&&t+1===e?(o.removeLayer(n),n._recursivelyAddChildrenToMap(null,e,s)):(n.clusterHide(),n._recursivelyAddChildrenToMap(a,e,s)),r=l.length-1;r>=0;r--)h=l[r],s.contains(h._latlng)||o.removeLayer(h)}),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(s,e),o.eachLayer(function(n){!(n instanceof L.MarkerCluster)&&n._icon&&n.clusterShow()}),this._topClusterLevel._recursively(s,t,e,function(n){n._recursivelyRestoreChildPositions(e)}),this._ignoreMove=!1,this._enqueue(function(){this._topClusterLevel._recursively(s,t,i,function(n){o.removeLayer(n),n.clusterShow()}),this._animationEnd()})},_animationZoomOut:function(t,e){this._animationZoomOutSingle(this._topClusterLevel,t-1,e),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),t,this._getExpandedVisibleBounds())},_animationAddLayer:function(t,e){var s=this,o=this._featureGroup;o.addLayer(t),e!==t&&(e._childCount>2?(e._updateIcon(),this._forceLayout(),this._animationStart(),t._setPos(this._map.latLngToLayerPoint(e.getLatLng())),t.clusterHide(),this._enqueue(function(){o.removeLayer(t),t.clusterShow(),s._animationEnd()})):(this._forceLayout(),s._animationStart(),s._animationZoomOutSingle(e,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(t,e,s){var o=this._getExpandedVisibleBounds(),i=Math.floor(this._map.getMinZoom());t._recursivelyAnimateChildrenInAndAddSelfToMap(o,i,e+1,s);var r=this;this._forceLayout(),t._recursivelyBecomeVisible(o,s),this._enqueue(function(){if(t._childCount===1){var n=t._markers[0];this._ignoreMove=!0,n.setLatLng(n.getLatLng()),this._ignoreMove=!1,n.clusterShow&&n.clusterShow()}else t._recursively(o,s,i,function(a){a._recursivelyRemoveChildrenFromMap(o,i,e+1)});r._animationEnd()})},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(document.body.offsetWidth)}}),L.markerClusterGroup=function(t){return new L.MarkerClusterGroup(t)};var w=L.MarkerCluster=L.Marker.extend({options:L.Icon.prototype.options,initialize:function(t,e,s,o){L.Marker.prototype.initialize.call(this,s?s._cLatLng||s.getLatLng():new L.LatLng(0,0),{icon:this,pane:t.options.clusterPane}),this._group=t,this._zoom=e,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._bounds=new L.LatLngBounds,s&&this._addChild(s),o&&this._addChild(o)},getAllChildMarkers:function(t,e){t=t||[];for(var s=this._childClusters.length-1;s>=0;s--)this._childClusters[s].getAllChildMarkers(t,e);for(var o=this._markers.length-1;o>=0;o--)e&&this._markers[o].__dragStart||t.push(this._markers[o]);return t},getChildCount:function(){return this._childCount},zoomToBounds:function(t){for(var e=this._childClusters.slice(),s=this._group._map,o=s.getBoundsZoom(this._bounds),i=this._zoom+1,r=s.getZoom(),n;e.length>0&&o>i;){i++;var a=[];for(n=0;n<e.length;n++)a=a.concat(e[n]._childClusters);e=a}o>i?this._group._map.setView(this._latlng,i):o<=r?this._group._map.setView(this._latlng,r+1):this._group._map.fitBounds(this._bounds,t)},getBounds:function(){var t=new L.LatLngBounds;return t.extend(this._bounds),t},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(t,e){this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._setClusterCenter(t),t instanceof L.MarkerCluster?(e||(this._childClusters.push(t),t.__parent=this),this._childCount+=t._childCount):(e||this._markers.push(t),this._childCount++),this.__parent&&this.__parent._addChild(t,!0)},_setClusterCenter:function(t){this._cLatLng||(this._cLatLng=t._cLatLng||t._latlng)},_resetBounds:function(){var t=this._bounds;t._southWest&&(t._southWest.lat=1/0,t._southWest.lng=1/0),t._northEast&&(t._northEast.lat=-1/0,t._northEast.lng=-1/0)},_recalculateBounds:function(){var t=this._markers,e=this._childClusters,s=0,o=0,i=this._childCount,r,n,a,l;if(i!==0){for(this._resetBounds(),r=0;r<t.length;r++)a=t[r]._latlng,this._bounds.extend(a),s+=a.lat,o+=a.lng;for(r=0;r<e.length;r++)n=e[r],n._boundsNeedUpdate&&n._recalculateBounds(),this._bounds.extend(n._bounds),a=n._wLatLng,l=n._childCount,s+=a.lat*l,o+=a.lng*l;this._latlng=this._wLatLng=new L.LatLng(s/i,o/i),this._boundsNeedUpdate=!1}},_addToMap:function(t){t&&(this._backupLatlng=this._latlng,this.setLatLng(t)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(t,e,s){this._recursively(t,this._group._map.getMinZoom(),s-1,function(o){var i=o._markers,r,n;for(r=i.length-1;r>=0;r--)n=i[r],n._icon&&(n._setPos(e),n.clusterHide())},function(o){var i=o._childClusters,r,n;for(r=i.length-1;r>=0;r--)n=i[r],n._icon&&(n._setPos(e),n.clusterHide())})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(t,e,s,o){this._recursively(t,o,e,function(i){i._recursivelyAnimateChildrenIn(t,i._group._map.latLngToLayerPoint(i.getLatLng()).round(),s),i._isSingleParent()&&s-1===o?(i.clusterShow(),i._recursivelyRemoveChildrenFromMap(t,e,s)):i.clusterHide(),i._addToMap()})},_recursivelyBecomeVisible:function(t,e){this._recursively(t,this._group._map.getMinZoom(),e,null,function(s){s.clusterShow()})},_recursivelyAddChildrenToMap:function(t,e,s){this._recursively(s,this._group._map.getMinZoom()-1,e,function(o){if(e!==o._zoom)for(var i=o._markers.length-1;i>=0;i--){var r=o._markers[i];s.contains(r._latlng)&&(t&&(r._backupLatlng=r.getLatLng(),r.setLatLng(t),r.clusterHide&&r.clusterHide()),o._group._featureGroup.addLayer(r))}},function(o){o._addToMap(t)})},_recursivelyRestoreChildPositions:function(t){for(var e=this._markers.length-1;e>=0;e--){var s=this._markers[e];s._backupLatlng&&(s.setLatLng(s._backupLatlng),delete s._backupLatlng)}if(t-1===this._zoom)for(var o=this._childClusters.length-1;o>=0;o--)this._childClusters[o]._restorePosition();else for(var i=this._childClusters.length-1;i>=0;i--)this._childClusters[i]._recursivelyRestoreChildPositions(t)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(t,e,s,o){var i,r;this._recursively(t,e-1,s-1,function(n){for(r=n._markers.length-1;r>=0;r--)i=n._markers[r],(!o||!o.contains(i._latlng))&&(n._group._featureGroup.removeLayer(i),i.clusterShow&&i.clusterShow())},function(n){for(r=n._childClusters.length-1;r>=0;r--)i=n._childClusters[r],(!o||!o.contains(i._latlng))&&(n._group._featureGroup.removeLayer(i),i.clusterShow&&i.clusterShow())})},_recursively:function(t,e,s,o,i){var r=this._childClusters,n=this._zoom,a,l;if(e<=n&&(o&&o(this),i&&n===s&&i(this)),n<e||n<s)for(a=r.length-1;a>=0;a--)l=r[a],l._boundsNeedUpdate&&l._recalculateBounds(),t.intersects(l._bounds)&&l._recursively(t,e,s,o,i)},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}});L.Marker.include({clusterHide:function(){var t=this.options.opacity;return this.setOpacity(0),this.options.opacity=t,this},clusterShow:function(){return this.setOpacity(this.options.opacity)}}),L.DistanceGrid=function(t){this._cellSize=t,this._sqCellSize=t*t,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(t,e){var s=this._getCoord(e.x),o=this._getCoord(e.y),i=this._grid,r=i[o]=i[o]||{},n=r[s]=r[s]||[],a=L.Util.stamp(t);this._objectPoint[a]=e,n.push(t)},updateObject:function(t,e){this.removeObject(t),this.addObject(t,e)},removeObject:function(t,e){var s=this._getCoord(e.x),o=this._getCoord(e.y),i=this._grid,r=i[o]=i[o]||{},n=r[s]=r[s]||[],a,l;for(delete this._objectPoint[L.Util.stamp(t)],a=0,l=n.length;a<l;a++)if(n[a]===t)return n.splice(a,1),l===1&&delete r[s],!0},eachObject:function(t,e){var s,o,i,r,n,a,l,h=this._grid;for(s in h){n=h[s];for(o in n)for(a=n[o],i=0,r=a.length;i<r;i++)l=t.call(e,a[i]),l&&(i--,r--)}},getNearObject:function(t){var e=this._getCoord(t.x),s=this._getCoord(t.y),o,i,r,n,a,l,h,u,_=this._objectPoint,d=this._sqCellSize,v=null;for(o=s-1;o<=s+1;o++)if(n=this._grid[o],n){for(i=e-1;i<=e+1;i++)if(a=n[i],a)for(r=0,l=a.length;r<l;r++)h=a[r],u=this._sqDist(_[L.Util.stamp(h)],t),(u<d||u<=d&&v===null)&&(d=u,v=h)}return v},_getCoord:function(t){var e=Math.floor(t/this._cellSize);return isFinite(e)?e:t},_sqDist:function(t,e){var s=e.x-t.x,o=e.y-t.y;return s*s+o*o}},function(){L.QuickHull={getDistant:function(t,e){var s=e[1].lat-e[0].lat,o=e[0].lng-e[1].lng;return o*(t.lat-e[0].lat)+s*(t.lng-e[0].lng)},findMostDistantPointFromBaseLine:function(t,e){var s=0,o=null,i=[],r,n,a;for(r=e.length-1;r>=0;r--){if(n=e[r],a=this.getDistant(n,t),a>0)i.push(n);else continue;a>s&&(s=a,o=n)}return{maxPoint:o,newPoints:i}},buildConvexHull:function(t,e){var s=[],o=this.findMostDistantPointFromBaseLine(t,e);return o.maxPoint?(s=s.concat(this.buildConvexHull([t[0],o.maxPoint],o.newPoints)),s=s.concat(this.buildConvexHull([o.maxPoint,t[1]],o.newPoints)),s):[t[0]]},getConvexHull:function(t){var e=!1,s=!1,o=!1,i=!1,r=null,n=null,a=null,l=null,h=null,u=null,_;for(_=t.length-1;_>=0;_--){var d=t[_];(e===!1||d.lat>e)&&(r=d,e=d.lat),(s===!1||d.lat<s)&&(n=d,s=d.lat),(o===!1||d.lng>o)&&(a=d,o=d.lng),(i===!1||d.lng<i)&&(l=d,i=d.lng)}s!==e?(u=n,h=r):(u=l,h=a);var v=[].concat(this.buildConvexHull([u,h],t),this.buildConvexHull([h,u],t));return v}}}(),L.MarkerCluster.include({getConvexHull:function(){var t=this.getAllChildMarkers(),e=[],s,o;for(o=t.length-1;o>=0;o--)s=t[o].getLatLng(),e.push(s);return L.QuickHull.getConvexHull(e)}}),L.MarkerCluster.include({_2PI:Math.PI*2,_circleFootSeparation:25,_circleStartAngle:0,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(!(this._group._spiderfied===this||this._group._inZoomAnimation)){var t=this.getAllChildMarkers(null,!0),e=this._group,s=e._map,o=s.latLngToLayerPoint(this._latlng),i;this._group._unspiderfy(),this._group._spiderfied=this,this._group.options.spiderfyShapePositions?i=this._group.options.spiderfyShapePositions(t.length,o):t.length>=this._circleSpiralSwitchover?i=this._generatePointsSpiral(t.length,o):(o.y+=10,i=this._generatePointsCircle(t.length,o)),this._animationSpiderfy(t,i)}},unspiderfy:function(t){this._group._inZoomAnimation||(this._animationUnspiderfy(t),this._group._spiderfied=null)},_generatePointsCircle:function(t,e){var s=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+t),o=s/this._2PI,i=this._2PI/t,r=[],n,a;for(o=Math.max(o,35),r.length=t,n=0;n<t;n++)a=this._circleStartAngle+n*i,r[n]=new L.Point(e.x+o*Math.cos(a),e.y+o*Math.sin(a))._round();return r},_generatePointsSpiral:function(t,e){var s=this._group.options.spiderfyDistanceMultiplier,o=s*this._spiralLengthStart,i=s*this._spiralFootSeparation,r=s*this._spiralLengthFactor*this._2PI,n=0,a=[],l;for(a.length=t,l=t;l>=0;l--)l<t&&(a[l]=new L.Point(e.x+o*Math.cos(n),e.y+o*Math.sin(n))._round()),n+=i/o+l*5e-4,o+=r/n;return a},_noanimationUnspiderfy:function(){var t=this._group,e=t._map,s=t._featureGroup,o=this.getAllChildMarkers(null,!0),i,r;for(t._ignoreMove=!0,this.setOpacity(1),r=o.length-1;r>=0;r--)i=o[r],s.removeLayer(i),i._preSpiderfyLatlng&&(i.setLatLng(i._preSpiderfyLatlng),delete i._preSpiderfyLatlng),i.setZIndexOffset&&i.setZIndexOffset(0),i._spiderLeg&&(e.removeLayer(i._spiderLeg),delete i._spiderLeg);t.fire("unspiderfied",{cluster:this,markers:o}),t._ignoreMove=!1,t._spiderfied=null}}),L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(t,e){var s=this._group,o=s._map,i=s._featureGroup,r=this._group.options.spiderLegPolylineOptions,n,a,l,h;for(s._ignoreMove=!0,n=0;n<t.length;n++)h=o.layerPointToLatLng(e[n]),a=t[n],l=new L.Polyline([this._latlng,h],r),o.addLayer(l),a._spiderLeg=l,a._preSpiderfyLatlng=a._latlng,a.setLatLng(h),a.setZIndexOffset&&a.setZIndexOffset(1e6),i.addLayer(a);this.setOpacity(.3),s._ignoreMove=!1,s.fire("spiderfied",{cluster:this,markers:t})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerCluster.include({_animationSpiderfy:function(t,e){var s=this,o=this._group,i=o._map,r=o._featureGroup,n=this._latlng,a=i.latLngToLayerPoint(n),l=L.Path.SVG,h=L.extend({},this._group.options.spiderLegPolylineOptions),u=h.opacity,_,d,v,k,O,y;for(u===void 0&&(u=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity),l?(h.opacity=0,h.className=(h.className||"")+" leaflet-cluster-spider-leg"):h.opacity=u,o._ignoreMove=!0,_=0;_<t.length;_++)d=t[_],y=i.layerPointToLatLng(e[_]),v=new L.Polyline([n,y],h),i.addLayer(v),d._spiderLeg=v,l&&(k=v._path,O=k.getTotalLength()+.1,k.style.strokeDasharray=O,k.style.strokeDashoffset=O),d.setZIndexOffset&&d.setZIndexOffset(1e6),d.clusterHide&&d.clusterHide(),r.addLayer(d),d._setPos&&d._setPos(a);for(o._forceLayout(),o._animationStart(),_=t.length-1;_>=0;_--)y=i.layerPointToLatLng(e[_]),d=t[_],d._preSpiderfyLatlng=d._latlng,d.setLatLng(y),d.clusterShow&&d.clusterShow(),l&&(v=d._spiderLeg,k=v._path,k.style.strokeDashoffset=0,v.setStyle({opacity:u}));this.setOpacity(.3),o._ignoreMove=!1,setTimeout(function(){o._animationEnd(),o.fire("spiderfied",{cluster:s,markers:t})},200)},_animationUnspiderfy:function(t){var e=this,s=this._group,o=s._map,i=s._featureGroup,r=t?o._latLngToNewLayerPoint(this._latlng,t.zoom,t.center):o.latLngToLayerPoint(this._latlng),n=this.getAllChildMarkers(null,!0),a=L.Path.SVG,l,h,u,_,d,v;for(s._ignoreMove=!0,s._animationStart(),this.setOpacity(1),h=n.length-1;h>=0;h--)l=n[h],l._preSpiderfyLatlng&&(l.closePopup(),l.setLatLng(l._preSpiderfyLatlng),delete l._preSpiderfyLatlng,v=!0,l._setPos&&(l._setPos(r),v=!1),l.clusterHide&&(l.clusterHide(),v=!1),v&&i.removeLayer(l),a&&(u=l._spiderLeg,_=u._path,d=_.getTotalLength()+.1,_.style.strokeDashoffset=d,u.setStyle({opacity:0})));s._ignoreMove=!1,setTimeout(function(){var k=0;for(h=n.length-1;h>=0;h--)l=n[h],l._spiderLeg&&k++;for(h=n.length-1;h>=0;h--)l=n[h],l._spiderLeg&&(l.clusterShow&&l.clusterShow(),l.setZIndexOffset&&l.setZIndexOffset(0),k>1&&i.removeLayer(l),o.removeLayer(l._spiderLeg),delete l._spiderLeg);s._animationEnd(),s.fire("unspiderfied",{cluster:e,markers:n})},200)}}),L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._map.off("zoomend",this._noanimationUnspiderfy,this),this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(t){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(t))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(t){this._spiderfied&&this._spiderfied.unspiderfy(t)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(t){t._spiderLeg&&(this._featureGroup.removeLayer(t),t.clusterShow&&t.clusterShow(),t.setZIndexOffset&&t.setZIndexOffset(0),this._map.removeLayer(t._spiderLeg),delete t._spiderLeg)}}),L.MarkerClusterGroup.include({refreshClusters:function(t){return t?t instanceof L.MarkerClusterGroup?t=t._topClusterLevel.getAllChildMarkers():t instanceof L.LayerGroup?t=t._layers:t instanceof L.MarkerCluster?t=t.getAllChildMarkers():t instanceof L.Marker&&(t=[t]):t=this._topClusterLevel.getAllChildMarkers(),this._flagParentsIconsNeedUpdate(t),this._refreshClustersIcons(),this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(t),this},_flagParentsIconsNeedUpdate:function(t){var e,s;for(e in t)for(s=t[e].__parent;s;)s._iconNeedsUpdate=!0,s=s.__parent},_refreshSingleMarkerModeMarkers:function(t){var e,s;for(e in t)s=t[e],this.hasLayer(s)&&s.setIcon(this._overrideMarkerIcon(s))}}),L.Marker.include({refreshIconOptions:function(t,e){var s=this.options.icon;return L.setOptions(s,t),this.setIcon(s),e&&this.__parent&&this.__parent._group.refreshClusters(this),this}}),c.MarkerClusterGroup=C,c.MarkerCluster=w,Object.defineProperty(c,"__esModule",{value:!0})})})(et,et.exports);const vt={id:"map",ref:"map"},yt={__name:"leafletMap",props:{searchQuery:{type:String,default:""},selectedCity:{type:String,default:null},selectedArea:{type:String,default:null},selectedSubcategories:{type:Array,default:()=>[]},selectedclient:{type:String,default:null}},setup(B){const E=lt(),c=S(null),C=S([]),w=S([]),{api:t}=ht(),e=B,s=()=>{c.value=M.map("map").setView([25.049183268037577,121.51342818384893],12),c.value?(M.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(c.value),c.value.eachLayer(n=>{n instanceof M.Control.Locate&&c.value.removeControl(n)}),M.control.locate({position:"topleft",drawCircle:!0,drawMarker:!0,markerStyle:{color:"black",opacity:.8,weight:.8},locateOptions:{enableHighAccuracy:!0,maxZoom:16},icon:"fa fa-solid fa-crosshairs",onLocationError:function(n){console.error(n.message),E({text:n.message,snackbarProps:{color:"red"}})}}).addTo(c.value)):console.error("Map initialization failed.")},o=async()=>{var n,a;try{const{data:l}=await t.get("/landmark");console.log(l),w.value=l.result.data,r(),console.log(w.value)}catch(l){console.error("Error fetching data:",l),E({text:((a=(n=l==null?void 0:l.response)==null?void 0:n.data)==null?void 0:a.message)||"發生錯誤",snackbarProps:{color:"red"}})}},i={服務對象:M.icon({iconUrl:"https://cdn-icons-png.flaticon.com/512/2377/2377871.png",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]}),長期照顧:M.icon({iconUrl:"https://cdn-icons-png.flaticon.com/512/12264/12264430.png",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]}),身心障礙:M.icon({iconUrl:"https://cdn-icons-png.flaticon.com/512/17573/17573294.png",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]}),兒童及少年:M.icon({iconUrl:"https://cdn-icons-png.flaticon.com/512/5759/5759522.png",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]}),心理衛生:M.icon({iconUrl:"https://cdn-icons-png.flaticon.com/512/4010/4010654.png",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]}),婦女:M.icon({iconUrl:"https://cdn-icons-png.flaticon.com/512/7457/7457069.png",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]}),社會救助:M.icon({iconUrl:"https://cdn-icons-png.flaticon.com/512/784/784791.png",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]}),綜合:M.icon({iconUrl:"https://cdn-icons-png.flaticon.com/512/5153/5153858.png",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]}),其他:M.icon({iconUrl:"https://cdn-icons-png.flaticon.com/512/5672/5672993.png",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]})},r=()=>{if(!c.value)return;C.value.forEach(a=>c.value.removeLayer(a)),C.value=[],w.value.filter(a=>{const l=!e.selectedCity||a.address.includes(e.selectedCity),h=!e.selectedArea||a.address.includes(e.selectedArea),u=!e.searchQuery||a.name.toLowerCase().includes(e.searchQuery.toLowerCase()),_=e.selectedSubcategories.length===0||a.categories.some(d=>e.selectedSubcategories.includes(d));return l&&h&&_&&u}).forEach(a=>{const l=parseFloat(a.lat),h=parseFloat(a.lng),u=a.cl,_=i[u]||i.綜合;if(isFinite(l)&&isFinite(h)){const d=M.marker([l,h],{icon:_}).addTo(c.value).bindPopup(`<h2 style="margin:5px 0 5px 0;text-decoration: underline;color:#1b3f63;">${a.name}</h2>
        <h3 style="margin: 2px 0 2px 0;color:gray;">地址：${a.address}</h3>
        <h3 style="margin: 2px 0 2px 0;color:gray;">電話：${a.tel}</h3>
        <span style="font-size: 1.17em;font-weight: bold;color:gray;">類別：</span><span style="font-size: 1.17em;font-weight: bold;margin: 2px 0 2px 0;color:#7b97a6;">${a.categories.join(" | ")}</span>
        <div><span style="font-size: 1.17em;font-weight: bold;color:gray;">簡介：</span><h4 style="margin: 2px 0 2px 0;color:gray;white-space: pre-line;">${a.description}</h4></div>`);C.value.push(d)}else console.warn(`Invalid coordinates for item: ${JSON.stringify(a)}`)})};return st(()=>[e.searchQuery,e.selectedCity,e.selectedArea,e.selectedSubcategories,e.selectedclient],r),nt(async()=>{s(),await o()}),(n,a)=>(b(),P(rt,null,{default:m(()=>[G("div",vt,null,512)]),_:1}))}},it=ot(yt,[["__scopeId","data-v-3ca552b7"]]),Lt={class:"text-right"},Ct={id:"filter"},kt={__name:"index",setup(B,{emit:E}){const{mobile:c,md:C}=ut(),w=S([{name:"服務對象",subcategories:["長期照顧","身心障礙","婦女","兒童及少年","心理衛生","社會救助","綜合","其他"]},{name:"長期照顧",subcategories:["日照中心","護理之家","居家服務","交通接送","家庭托顧"]},{name:"身心障礙",subcategories:["身心障礙者服務中心","輔具中心","職業重建中心","小作所","庇護工場"]},{name:"兒童及少年",subcategories:["少年福利服務中心","親子館","課後班"]},{name:"婦女",subcategories:["婦女福利服務中心","新住民家庭服務中心"]},{name:"社會救助",subcategories:["經濟補助","待用餐","基金會","社會福利中心"]},{name:"其他",subcategories:["其他"]}]),t=S([]),e=S([]),s=S([]),o=S([]),i=S({}),r=S(null),n=S(null),a=["台北市","新北市"],l=async()=>{try{const y=await ct.get("https://gist.githubusercontent.com/Wcc723/ac712d2bb5c4e61df99d7c5b7f3746e1/raw/2ebe2f94c3bbbeec254159b7dfe71a007f1696cd/tw-zipcode.json");h(y.data)}catch(y){console.error("Error loading JSON file:",y)}},h=y=>{const f={},Z=[];Object.keys(y).forEach(g=>{a.includes(g)&&(Z.push(g),f[g]=Object.keys(y[g]))}),s.value=Z,i.value=f},u=y=>{console.log("Selected City:",y),o.value=i.value[y]||[],n.value=null};st(r,y=>{u(y)}),nt(()=>{l()});const _=S(""),d=(y,f)=>{console.log("Clicked panel:",y.name),console.log("Panel index:",f)},v=()=>{t.value=[],e.value=[],n.value=[],r.value=[],_.value=""},k=S(!1),O=()=>{k.value=!k.value};return(y,f)=>{const Z=at;return b(),P(Y,{style:{height:"94vh"}},{default:m(()=>[H(c)?j("",!0):(b(),P(A,{key:0,cols:"12",md:"7",lg:"8",class:"sm_map map_col order-2 order-lg-1 order-md-1"},{default:m(()=>[p(it,{searchQuery:_.value,selectedCity:r.value,selectedArea:n.value,selectedSubcategories:t.value,id:"map"},null,8,["searchQuery","selectedCity","selectedArea","selectedSubcategories"])]),_:1})),H(c)?(b(),P(rt,{key:2,class:"pa-0 d-flex flex-column",style:{height:"100%"}},{default:m(()=>[p(pt,null,{default:m(()=>[p(Y,{"no-gutters":"",align:"center"},{default:m(()=>[p(A,{cols:"10"},{default:m(()=>[p(Z,{modelValue:_.value,"onUpdate:modelValue":f[6]||(f[6]=g=>_.value=g),label:"輸入資源地址",id:"search-xs",class:"ms-2",dense:"",width:"95%"},null,8,["modelValue"])]),_:1}),p(A,{cols:"1",class:"text-center"},{default:m(()=>[p(U,{id:"clear",type:"submit",variant:"plain",class:"rounded-md bb-1 mt-2 bg-grey-lighten-4 d-none d-md-block",density:"comfortable",ripple:!1,height:"40",width:"60",onClick:f[7]||(f[7]=g=>v())},{default:m(()=>[V(" 清空條件 ")]),_:1}),p(U,{icon:"mdi-delete",class:"d-md-none",variant:"text",density:"comfortable",color:"black",onClick:f[8]||(f[8]=g=>v())})]),_:1}),p(A,{cols:"1",class:"text-center"},{default:m(()=>[p(U,{id:"clear",type:"submit",variant:"plain",class:"rounded-md bb-1 mt-2 bg-grey-lighten-4 d-none d-md-block",density:"comfortable",ripple:!1,height:"40",width:"60",onClick:O},{default:m(()=>[V(" 篩選 ")]),_:1}),p(U,{icon:"mdi-filter",class:"d-md-none",variant:"text",density:"comfortable",color:"black",onClick:O})]),_:1})]),_:1})]),_:1}),k.value?(b(),P(mt,{key:0,modelValue:k.value,"onUpdate:modelValue":f[11]||(f[11]=g=>k.value=g),temporary:"",width:"100vw",class:"bg-transparent",location:"top"},{default:m(()=>[p($,{variant:"accordion"},{default:m(()=>[(b(!0),T(D,null,z(w.value,(g,I)=>(b(),P(q,{key:I,modelValue:e.value,"onUpdate:modelValue":f[10]||(f[10]=x=>e.value=x),onClick:x=>d(g,I)},{default:m(()=>[p(Q,null,{default:m(()=>[V(R(g.name),1)]),_:2},1024),p(W,null,{default:m(()=>[(b(!0),T(D,null,z(g.subcategories,(x,F)=>(b(),P(tt,{key:F,modelValue:t.value,"onUpdate:modelValue":f[9]||(f[9]=N=>t.value=N),label:x,value:x,"hide-details":""},null,8,["modelValue","label","value"]))),128))]),_:2},1024)]),_:2},1032,["modelValue","onClick"]))),128))]),_:1})]),_:1},8,["modelValue"])):j("",!0),p(it,{searchQuery:_.value,selectedCity:r.value,selectedArea:n.value,selectedSubcategories:t.value,id:"map-xs",style:{"flex-grow":"1"}},null,8,["searchQuery","selectedCity","selectedArea","selectedSubcategories"])]),_:1})):(b(),P(A,{key:1,cols:"12",md:"5",lg:"4",class:"map_col order-1 order-lg-2 order-md-2"},{default:m(()=>[p(_t,{class:"find-resource",elevation:"0"},{default:m(()=>[p(J,{color:"secondary",prominent:"",class:"bb-1 d-none d-md-inline-block"},{default:m(()=>[p(X,null,{default:m(()=>[V(" 服務查詢 ")]),_:1})]),_:1}),p(dt,null,{default:m(()=>[G("div",null,[G("div",Lt,[p(U,{id:"clear",type:"submit",variant:"plain",class:"rounded-md bb-1 mt-2 bg-grey-lighten-4 d-none d-md-block",density:"comfortable",ripple:!1,height:"40",width:"80",onClick:f[0]||(f[0]=g=>v())},{default:m(()=>[V(" 清空條件 ")]),_:1})]),p(Z,{class:"my-5","max-width":"1000px",modelValue:_.value,"onUpdate:modelValue":f[1]||(f[1]=g=>_.value=g),label:"輸入資源地址",id:"search"},null,8,["modelValue"])]),G("div",null,[p(K,{modelValue:r.value,"onUpdate:modelValue":f[2]||(f[2]=g=>r.value=g),items:s.value,"min-width":"145px",label:"縣市",class:"me-3 d-none d-sm-inline-block",style:{width:"48%"},density:"comfortable",variant:"outlined",onChange:u},null,8,["modelValue","items"]),p(K,{modelValue:n.value,"onUpdate:modelValue":f[3]||(f[3]=g=>n.value=g),items:o.value,"min-width":"145px",label:"鄉鎮市區",class:"d-none d-sm-inline-block",style:{width:"48%"},density:"comfortable",variant:"outlined"},null,8,["modelValue","items"])]),G("div",Ct,[p(J,{density:"compact",class:"d-none d-md-block"},{default:m(()=>[p(X,{class:"ms-5 text-body-1"},{default:m(()=>[V(" 服務類別 ")]),_:1})]),_:1}),p($,{variant:"accordion"},{default:m(()=>[(b(!0),T(D,null,z(w.value,(g,I)=>(b(),P(q,{key:I,modelValue:e.value,"onUpdate:modelValue":f[5]||(f[5]=x=>e.value=x),onClick:x=>d(g,I)},{default:m(()=>[p(Q,null,{default:m(()=>[V(R(g.name),1)]),_:2},1024),p(W,null,{default:m(()=>[(b(!0),T(D,null,z(g.subcategories,(x,F)=>(b(),P(tt,{key:F,modelValue:t.value,"onUpdate:modelValue":f[4]||(f[4]=N=>t.value=N),label:x,value:x,"hide-details":""},null,8,["modelValue","label","value"]))),128))]),_:2},1024)]),_:2},1032,["modelValue","onClick"]))),128))]),_:1})])]),_:1})]),_:1})]),_:1}))]),_:1})}}},Gt=ot(kt,[["__scopeId","data-v-0153b8a6"]]);export{Gt as default};
