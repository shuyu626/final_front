import{a as K,V as o,_ as Oe}from"./breadcrumbs-Ds8NVqxL.js";import{i as me,n as c,N as ze,r as ne,o as $,c as R,b as e,w as t,R as xe,S as be,l as d,A as P,a as D,m as Y,V as ie,T as _e,h as Pe,f as Ue,g as s,k as Be,x as qe,F as O,p as pe,u as He,e as de,t as ee,j as Fe,as as Ae,C as Ne,D as We,O as Ge,ar as Je,v as Qe}from"./index-DinF4U3z.js";import{c as Se,a as A,u as Ce,b as C,V as Me,f as Re,e as ve}from"./index.esm--oIPo5cr.js";import{_ as Te}from"./inputText-DrioZ0pC.js";import{_ as $e}from"./search-DRDwrag7.js";import{V as Ve}from"./VDataTableServer-B5LuOPcP.js";import{V as ke,a as ae}from"./VContainer-UVUPIkTn.js";import{V as Ie}from"./VSelect-DEE7wmEY.js";import{V as De}from"./VTextarea-CJ67ppp-.js";import{_ as Xe}from"./appButton-Dv0gos5k.js";import{_ as Le}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as Ee,a as je}from"./VToolbar-C2axwXnU.js";import{_ as Ye}from"./submitButton-CJ8yrxaN.js";import{V as Ze,a as et,c as tt}from"./VExpansionPanels-B4KcCj7x.js";import{a as fe,V as ye}from"./VChip-DL3v5xR4.js";import{a as lt,b as we,c as at,V as he}from"./VTabs-COAyIDuF.js";import{V as st}from"./VNavigationDrawer-DZA3lHVT.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./VPagination-BllXf-Gk.js";import"./VMenu-7ZGqqFdC.js";import"./ssrBoot-BaT9uRXm.js";import"./VSlideGroup-Czikn6IM.js";const ot=d("h2",{class:"my-5 bg-accent text-center"},"活動管理",-1),nt={style:{width:"220px"}},rt={style:{width:"350px"},class:"py-2"},ut={style:{width:"80px"}},dt=d("label",{class:"form-label"},"活動名稱：",-1),it=d("label",{class:"form-label"},"活動地點：",-1),ct=d("label",{class:"form-label"},"活動類別：",-1),mt=d("label",{class:"form-label"},"活動時間：",-1),pt=d("label",{class:"form-label"},"主辦單位：",-1),gt=d("label",{class:"form-label"},"活動介紹：",-1),vt={class:"mx-auto"},ft={__name:"eventTable",setup(G){const{api:ce,apiAuth:B}=pe(),V=me(),H=c(null),U=c([]),w=c([]),h=c(10),I=c([{key:"createdAt",order:"desc"}]),M=c(1),q=c([]),S=[{title:"圖片",align:"center",sortable:!1,key:"image"},{title:"活動名稱",align:"center",sortable:!1,key:"title"},{title:"活動地點",align:"center",sortable:!1,key:"address"},{title:"活動類別",align:"center",sortable:!0,key:"category"},{title:"活動時間",align:"center",sortable:!0,key:"date"},{title:"主辦單位",align:"center",sortable:!1,key:"organizer"},{title:"活動介紹",align:"center",sortable:!1,key:"description"},{title:"操作",align:"center",sortable:!1,key:"action"}],T=c(!0),p=c(0),x=c(""),n=async u=>{var l,k,f,i;u&&(M.value=1),T.value=!0;try{const{data:b}=await B.get("/user/event",{params:{page:M.value,itemsPerPage:h.value,sortBy:((l=I.value[0])==null?void 0:l.key)||"createdAt",sortOrder:((k=I.value[0])==null?void 0:k.order)||"desc",search:x.value}});q.value.splice(0,q.value.length,...b.result.data),p.value=b.result.total}catch(b){console.log(b),V({text:((i=(f=b==null?void 0:b.response)==null?void 0:f.data)==null?void 0:i.message)||"發生錯誤",snackbarProps:{color:"red"}})}T.value=!1};n();const g=["兒童","青少年","育兒","長照","精神","照顧","就學","就業","身障","親職教育","早療","紓壓","居住","醫療","司法","社工","其他"],v=c({open:!1,id:""}),_=u=>{v.value.open=!0,v.value.id=u._id,j.value.value=u.title,y.value.value=u.date,z.value.value=u.address,N.value.value=u.category,Q.value.value=u.organizer,X.value.value=u.description},Z=()=>{v.value.open=!1,E(),H.value.deleteFileRecord()},le=Se({title:A().required("活動標題必填"),date:A().required("活動日期必填"),address:A().required("活動地點必填"),category:A().required("活動分類必填").test("isCategory","商品分類錯誤",u=>g.includes(u)),organizer:A().required("主辦單位必填"),description:A().required("活動介紹必填")}),{handleSubmit:F,isSubmitting:L,resetForm:E}=Ce({validationSchema:le,initialValues:{title:"",date:"",address:"",category:"",organizer:"",description:""}}),j=C("title"),y=C("date"),z=C("address"),N=C("category"),Q=C("organizer"),X=C("description"),re=F(async u=>{var l,k,f;if(!((l=U.value[0])!=null&&l.error)&&!(U.value.length<1))try{const i=new FormData;i.append("title",u.title),i.append("date",u.date),i.append("address",u.address),i.append("category",u.category),i.append("organizer",u.organizer),i.append("description",u.description),U.value.length>0&&i.append("image",U.value[0].file),await B.patch("/event/"+v.value.id,i),V({text:"新增成功",snackbarProps:{color:"green"}}),Z()}catch(i){console.log(i),V({text:((f=(k=i==null?void 0:i.response)==null?void 0:k.data)==null?void 0:f.message)||"發生錯誤",snackbarProps:{color:"red"}})}});ze(x,()=>{n(!0)});const ue=async u=>{var l,k;try{await B.delete(`/event/${u._id}`),V({text:"刪除成功",snackbarProps:{color:"green"}}),n(!0)}catch(f){console.log(f),V({text:((k=(l=f==null?void 0:f.response)==null?void 0:l.data)==null?void 0:k.message)||"發生錯誤",snackbarProps:{color:"red"}})}};return(u,l)=>{const k=$e,f=ne("router-link"),i=ne("vue-file-agent"),b=Te;return $(),R(O,null,[ot,e(Ve,{"items-per-page":h.value,"onUpdate:itemsPerPage":[l[3]||(l[3]=a=>h.value=a),l[6]||(l[6]=a=>n(!1))],"sort-by":I.value,"onUpdate:sortBy":[l[4]||(l[4]=a=>I.value=a),l[7]||(l[7]=a=>n(!1))],page:M.value,"onUpdate:page":[l[5]||(l[5]=a=>M.value=a),l[8]||(l[8]=a=>n(!1))],items:q.value,headers:S,loading:T.value,"items-length":p.value,search:x.value,hover:"",class:"w-75 mx-auto rounded-lg mb-15"},{top:t(()=>[e(k,{modelValue:x.value,"onUpdate:modelValue":l[0]||(l[0]=a=>x.value=a),onClickAppend:l[1]||(l[1]=a=>n(!0)),onKeydown:l[2]||(l[2]=xe(a=>n(!0),["enter"])),"max-width":"100%",class:"my-5"},null,8,["modelValue"])]),"item.image":t(({item:a})=>[e(f,{to:"/event/"+a._id,style:{"text-decoration":"none"}},{default:t(()=>[e(be,{src:a.image,width:"100px","max-height":"140px",class:"my-5"},null,8,["src"])]),_:2},1032,["to"])]),"item.address":t(({item:a})=>[d("td",nt,P(a.address),1)]),"item.category":t(({item:a})=>[d("td",null,P(a.category.join(" , ")),1)]),"item.description":t(({item:a})=>[d("td",rt,P(a.description),1)]),"item.action":t(({item:a})=>[d("td",ut,[D(P(a.action)+" ",1),e(Y,{icon:"mdi-pencil",variant:"text",color:"blue",onClick:ge=>_(a)},null,8,["onClick"]),e(Y,{icon:"mdi-delete",variant:"text",color:"blue",onClick:ge=>ue(a)},null,8,["onClick"])])]),_:2},1032,["items-per-page","sort-by","page","items","loading","items-length","search"]),e(qe,{"max-width":"700",modelValue:v.value.open,"onUpdate:modelValue":l[18]||(l[18]=a=>v.value.open=a)},{default:t(()=>[e(ie,null,{default:t(()=>[e(ke,null,{default:t(()=>[e(_e,{class:"font-weight-black text-center text-h4"},{default:t(()=>[D("新增活動")]),_:1}),e(Pe,null,{default:t(()=>[e(Me,{onSubmit:Ue(s(re),["prevent"]),disabled:s(L)},{default:t(()=>[e(K,null,{default:t(()=>[e(o,null,{default:t(()=>[e(i,{modelValue:U.value,"onUpdate:modelValue":l[9]||(l[9]=a=>U.value=a),"raw-model-value":w.value,"onUpdate:rawModelValue":l[10]||(l[10]=a=>w.value=a),accept:"image/jpeg,image/png",deletable:"","max-size":"1MB","help-text":"選擇檔案或拖曳到這裡","error-text":{type:"檔案格式不支援",size:"檔案大小不能超過 1MB"},ref_key:"fileAgent",ref:H},null,8,["modelValue","raw-model-value"])]),_:1})]),_:1}),e(K,null,{default:t(()=>[e(o,{cols:"12",md:"3",class:"my-auto text-center"},{default:t(()=>[dt]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(b,{modelValue:s(j).value.value,"onUpdate:modelValue":l[11]||(l[11]=a=>s(j).value.value=a),"error-messages":s(j).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-center"},{default:t(()=>[it]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(b,{modelValue:s(z).value.value,"onUpdate:modelValue":l[12]||(l[12]=a=>s(z).value.value=a),"error-messages":s(z).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-center"},{default:t(()=>[ct]),_:1}),e(o,{cols:"12",md:"3"},{default:t(()=>[e(Ie,{modelValue:s(N).value.value,"onUpdate:modelValue":l[13]||(l[13]=a=>s(N).value.value=a),"error-messages":s(N).errorMessage.value,label:"選擇",variant:"outlined",density:"comfortable",dense:"",width:"140",items:g,"hide-details":""},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"3",class:"my-auto text-center px-0"},{default:t(()=>[mt]),_:1}),e(o,{cols:"3"},{default:t(()=>[e(b,{modelValue:s(y).value.value,"onUpdate:modelValue":l[14]||(l[14]=a=>s(y).value.value=a),"error-messages":s(y).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-center"},{default:t(()=>[pt]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(b,{modelValue:s(Q).value.value,"onUpdate:modelValue":l[15]||(l[15]=a=>s(Q).value.value=a),"error-messages":s(Q).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"text-center"},{default:t(()=>[gt]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(De,{label:"輸入文字",variant:"outlined",clearable:"","hide-details":"",modelValue:s(X).value.value,"onUpdate:modelValue":l[16]||(l[16]=a=>s(X).value.value=a),"error-messages":s(X).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(Be,null,{default:t(()=>[d("div",vt,[e(Y,{variant:"text",class:"rounded-xl b-1",density:"comfortable",type:"submit",loading:s(L)},{default:t(()=>[D("送出")]),_:1},8,["loading"]),e(Y,{text:"取消",variant:"text",class:"rounded-xl b-1",density:"comfortable",onClick:l[17]||(l[17]=a=>Z())})])]),_:1})]),_:1},8,["onSubmit","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}},yt=d("h2",{class:"my-5 bg-accent text-center"},"我要分享",-1),bt={style:{width:"250px"},class:"py-2"},xt={style:{width:"80px"}},_t=d("label",{class:"form-label"},"物資名稱",-1),Vt={class:"form-label"},kt=d("label",{class:"form-label"},"物資類別",-1),wt={class:"form-label"},ht=d("label",{class:"form-label"},"單位名稱",-1),$t={class:"mx-auto"},Pt={__name:"shareTable",props:{cardTitle:{type:String,default:"發布需求"},numberTitle:{type:String,default:"需求量"},descriptionTitle:{type:String,default:"需求介紹"},type:{type:String,default:"share"}},setup(G){const{api:ce,apiAuth:B}=pe(),V=me(),H=G,U=c(null),w=c([]),h=c([]),I=c(8),M=c([{key:"createdAt",order:"desc"}]),q=c(1),S=c([]),T=[{title:"圖片",align:"center",sortable:!1,key:"image"},{title:"名稱",align:"center",sortable:!1,key:"name"},{title:"數量",align:"center",sortable:!1,key:"quantity"},{title:"分類",align:"center",sortable:!0,key:"category"},{title:"概況",align:"center",sortable:!1,key:"description"},{title:"單位",align:"center",sortable:!1,key:"organizer"},{title:"操作",align:"center",sortable:!1,key:"action"}],p=c(!0),x=c(0),n=c(""),g=async u=>{var l,k,f,i;u&&(q.value=1),p.value=!0;try{const{data:b}=await B.get("/user/share",{params:{page:q.value,itemsPerPage:I.value,sortBy:((l=M.value[0])==null?void 0:l.key)||"createdAt",sortOrder:((k=M.value[0])==null?void 0:k.order)||"desc",search:n.value}});console.log(b),S.value.splice(0,S.value.length,...b.result.data),x.value=b.result.total}catch(b){console.log(b),V({text:((i=(f=b==null?void 0:b.response)==null?void 0:f.data)==null?void 0:i.message)||"發生錯誤",snackbarProps:{color:"red"}})}p.value=!1};g();const v=["食品","服飾配件","日用品","家具","輔具","教育用品","嬰幼兒用品","電器","休閒用品","其他"],_=c({open:!1,id:""}),Z=u=>{_.value.open=!0,_.value.id=u._id,y.value.value=u.name,z.value.value=u.quantity,N.value.value=u.category,Q.value.value=u.description,X.value.value=u.organizer},le=()=>{_.value.open=!1,j(),U.value.deleteFileRecord()},F=Se({name:A().required("物品名稱必填"),quantity:Re().min(1,"物品數量不符").required("物品數量必填"),category:A().required("物品分類必填").test("isCategory","商品分類錯誤",u=>v.includes(u)),description:A().required("物資介紹必填"),organizer:A().required("單位名稱必填")}),{handleSubmit:L,isSubmitting:E,resetForm:j}=Ce({validationSchema:F,initialValues:{name:"",quantity:"0",category:"",description:"",organizer:""}}),y=C("name"),z=C("quantity"),N=C("category"),Q=C("description"),X=C("organizer"),re=L(async u=>{var l,k,f;if(!((l=w.value[0])!=null&&l.error)&&!(w.value.length<1))try{const i=new FormData;i.append("name",u.name),i.append("quantity",u.quantity),i.append("category",u.category),i.append("description",u.description),i.append("organizer",u.organizer),i.append("type",H.type),w.value.length>0&&i.append("image",w.value[0].file),console.log(i),await B.patch("/material/"+_.value.id,i),V({text:"新增成功",snackbarProps:{color:"green"}}),le()}catch(i){console.log(i),V({text:((f=(k=i==null?void 0:i.response)==null?void 0:k.data)==null?void 0:f.message)||"發生錯誤",snackbarProps:{color:"red"}})}});ze(n,()=>{g(!0)});const ue=async u=>{var l,k;try{await B.delete(`/Material/${u._id}`),V({text:"刪除成功",snackbarProps:{color:"green"}}),g(!0)}catch(f){console.log(f),V({text:((k=(l=f==null?void 0:f.response)==null?void 0:l.data)==null?void 0:k.message)||"發生錯誤",snackbarProps:{color:"red"}})}};return(u,l)=>{const k=$e,f=ne("router-link"),i=ne("vue-file-agent"),b=Te;return $(),R(O,null,[yt,e(Ve,{"items-per-page":I.value,"onUpdate:itemsPerPage":[l[3]||(l[3]=a=>I.value=a),l[6]||(l[6]=a=>g(!1))],"sort-by":M.value,"onUpdate:sortBy":[l[4]||(l[4]=a=>M.value=a),l[7]||(l[7]=a=>g(!1))],page:q.value,"onUpdate:page":[l[5]||(l[5]=a=>q.value=a),l[8]||(l[8]=a=>g(!1))],items:S.value,headers:T,loading:p.value,"items-length":x.value,search:n.value,hover:"",class:"w-75 mx-auto b-1 rounded-lg mb-15"},{top:t(()=>[e(k,{class:"my-5",modelValue:n.value,"onUpdate:modelValue":l[0]||(l[0]=a=>n.value=a),onClickAppend:l[1]||(l[1]=a=>g(!0)),onKeydown:l[2]||(l[2]=xe(a=>g(!0),["enter"])),"max-width":"100%"},null,8,["modelValue"])]),"item.image":t(({item:a})=>[e(f,{to:"/material/share/"+a._id,style:{"text-decoration":"none"}},{default:t(()=>[e(be,{src:a.image,width:"80px","max-height":"100px"},null,8,["src"])]),_:2},1032,["to"])]),"item.description":t(({item:a})=>[d("td",bt,P(a.description),1)]),"item.action":t(({item:a})=>[d("td",xt,[D(P(a.action)+" ",1),e(Y,{icon:"mdi-pencil",variant:"text",color:"blue",onClick:ge=>Z(a)},null,8,["onClick"]),e(Y,{icon:"mdi-delete",variant:"text",color:"blue",onClick:ge=>ue(a)},null,8,["onClick"])])]),_:2},1032,["items-per-page","sort-by","page","items","loading","items-length","search"]),e(qe,{"max-width":"600",modelValue:_.value.open,"onUpdate:modelValue":l[17]||(l[17]=a=>_.value.open=a)},{default:t(()=>[e(ie,null,{default:t(()=>[e(ke,null,{default:t(()=>[e(_e,{class:"font-weight-black text-center text-h4"},{default:t(()=>[D(P(G.cardTitle),1)]),_:1}),e(Pe,null,{default:t(()=>[e(Me,{onSubmit:Ue(s(re),["prevent"]),disabled:s(E)},{default:t(()=>[e(K,null,{default:t(()=>[e(o,null,{default:t(()=>[e(i,{modelValue:w.value,"onUpdate:modelValue":l[9]||(l[9]=a=>w.value=a),"raw-model-value":h.value,"onUpdate:rawModelValue":l[10]||(l[10]=a=>h.value=a),accept:"image/jpeg,image/png",deletable:"","max-size":"1MB","help-text":"選擇檔案或拖曳到這裡","error-text":{type:"檔案格式不支援",size:"檔案大小不能超過 1MB"},ref_key:"fileAgent",ref:U},null,8,["modelValue","raw-model-value"])]),_:1})]),_:1}),e(K,null,{default:t(()=>[e(o,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:t(()=>[_t]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(b,{modelValue:s(y).value.value,"onUpdate:modelValue":l[11]||(l[11]=a=>s(y).value.value=a),"error-messages":s(y).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:t(()=>[d("label",Vt,P(G.numberTitle),1)]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(b,{modelValue:s(z).value.value,"onUpdate:modelValue":l[12]||(l[12]=a=>s(z).value.value=a),"error-messages":s(z).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:t(()=>[kt]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(Ie,{modelValue:s(N).value.value,"onUpdate:modelValue":l[13]||(l[13]=a=>s(N).value.value=a),"error-messages":s(N).errorMessage.value,label:"選擇",variant:"outlined",density:"comfortable",dense:"",items:v,"hide-details":""},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:t(()=>[d("label",wt,P(G.descriptionTitle),1)]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(b,{modelValue:s(Q).value.value,"onUpdate:modelValue":l[14]||(l[14]=a=>s(Q).value.value=a),"error-messages":s(Q).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:t(()=>[ht]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(b,{modelValue:s(X).value.value,"onUpdate:modelValue":l[15]||(l[15]=a=>s(X).value.value=a),"error-messages":s(X).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(Be,null,{default:t(()=>[d("div",$t,[e(Y,{variant:"text",class:"rounded-xl b-1",density:"comfortable",type:"submit",loading:s(E)},{default:t(()=>[D("送出")]),_:1},8,["loading"]),e(Y,{text:"取消",variant:"text",class:"rounded-xl b-1",density:"comfortable",onClick:l[16]||(l[16]=a=>le())})])]),_:1})]),_:1},8,["onSubmit","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}},Ut=d("h2",{class:"my-5 bg-accent text-center"},"我要募資",-1),St={style:{width:"250px"},class:"py-2"},Ct={style:{width:"80px"}},Mt=d("label",{class:"form-label"},"物資名稱",-1),zt={class:"form-label"},qt=d("label",{class:"form-label"},"物資類別",-1),Tt={class:"form-label"},At=d("label",{class:"form-label"},"單位名稱",-1),Bt={class:"mx-auto"},It={__name:"findTable",props:{cardTitle:{type:String,default:"發布需求"},numberTitle:{type:String,default:"需求量"},descriptionTitle:{type:String,default:"需求介紹"},type:{type:String,default:"share"}},setup(G){const{api:ce,apiAuth:B}=pe(),V=me(),H=G,U=c(null),w=c([]),h=c([]),I=c(8),M=c([{key:"createdAt",order:"desc"}]),q=c(1),S=c([]),T=[{title:"圖片",align:"center",sortable:!1,key:"image"},{title:"名稱",align:"center",sortable:!1,key:"name"},{title:"數量",align:"center",sortable:!1,key:"quantity"},{title:"分類",align:"center",sortable:!0,key:"category"},{title:"概況",align:"center",sortable:!1,key:"description"},{title:"單位",align:"center",sortable:!1,key:"organizer"},{title:"操作",align:"center",sortable:!1,key:"action"}],p=c(!0),x=c(0),n=c(""),g=async u=>{var l,k,f,i;u&&(q.value=1),p.value=!0;try{const{data:b}=await B.get("/user/find",{params:{page:q.value,itemsPerPage:I.value,sortBy:((l=M.value[0])==null?void 0:l.key)||"createdAt",sortOrder:((k=M.value[0])==null?void 0:k.order)||"desc",search:n.value}});S.value.splice(0,S.value.length,...b.result.data),x.value=b.result.total}catch(b){console.log(b),V({text:((i=(f=b==null?void 0:b.response)==null?void 0:f.data)==null?void 0:i.message)||"發生錯誤",snackbarProps:{color:"red"}})}p.value=!1};g();const v=["食品","服飾配件","日用品","家具","輔具","教育用品","嬰幼兒用品","電器","休閒用品","其他"],_=c({open:!1,id:""}),Z=u=>{_.value.open=!0,_.value.id=u._id,y.value.value=u.name,z.value.value=u.quantity,N.value.value=u.category,Q.value.value=u.description,X.value.value=u.organizer},le=()=>{_.value.open=!1,j(),U.value.deleteFileRecord()},F=Se({name:A().required("物品名稱必填"),quantity:Re().min(1,"物品數量不符").required("物品數量必填"),category:A().required("物品分類必填").test("isCategory","商品分類錯誤",u=>v.includes(u)),description:A().required("物資介紹必填"),organizer:A().required("單位名稱必填")}),{handleSubmit:L,isSubmitting:E,resetForm:j}=Ce({validationSchema:F,initialValues:{name:"",quantity:"0",category:"",description:"",organizer:""}}),y=C("name"),z=C("quantity"),N=C("category"),Q=C("description"),X=C("organizer"),re=L(async u=>{var l,k,f;if(!((l=w.value[0])!=null&&l.error)&&!(w.value.length<1))try{const i=new FormData;i.append("name",u.name),i.append("quantity",u.quantity),i.append("category",u.category),i.append("description",u.description),i.append("organizer",u.organizer),i.append("type",H.type),w.value.length>0&&i.append("image",w.value[0].file),console.log(i),await B.patch("/material/"+_.value.id,i),V({text:"新增成功",snackbarProps:{color:"green"}}),le()}catch(i){console.log(i),V({text:((f=(k=i==null?void 0:i.response)==null?void 0:k.data)==null?void 0:f.message)||"發生錯誤",snackbarProps:{color:"red"}})}});ze(n,()=>{g(!0)});const ue=async u=>{var l,k;try{await B.delete(`/Material/${u._id}`),V({text:"刪除成功",snackbarProps:{color:"green"}}),g(!0)}catch(f){console.log(f),V({text:((k=(l=f==null?void 0:f.response)==null?void 0:l.data)==null?void 0:k.message)||"發生錯誤",snackbarProps:{color:"red"}})}};return(u,l)=>{const k=$e,f=ne("router-link"),i=ne("vue-file-agent"),b=Te;return $(),R(O,null,[Ut,e(Ve,{"items-per-page":I.value,"onUpdate:itemsPerPage":[l[3]||(l[3]=a=>I.value=a),l[6]||(l[6]=a=>g(!1))],"sort-by":M.value,"onUpdate:sortBy":[l[4]||(l[4]=a=>M.value=a),l[7]||(l[7]=a=>g(!1))],page:q.value,"onUpdate:page":[l[5]||(l[5]=a=>q.value=a),l[8]||(l[8]=a=>g(!1))],items:S.value,headers:T,loading:p.value,"items-length":x.value,search:n.value,hover:"",class:"w-75 mx-auto b-1 rounded-lg mb-15"},{top:t(()=>[e(k,{modelValue:n.value,"onUpdate:modelValue":l[0]||(l[0]=a=>n.value=a),onClickAppend:l[1]||(l[1]=a=>g(!0)),onKeydown:l[2]||(l[2]=xe(a=>g(!0),["enter"])),"max-width":"100%",class:"my-5"},null,8,["modelValue"])]),"item.image":t(({item:a})=>[e(f,{to:"/material/find/"+a._id,style:{"text-decoration":"none"}},{default:t(()=>[e(be,{src:a.image,width:"80px","max-height":"100px"},null,8,["src"])]),_:2},1032,["to"])]),"item.description":t(({item:a})=>[d("td",St,P(a.description),1)]),"item.action":t(({item:a})=>[d("td",Ct,[D(P(a.action)+" ",1),e(Y,{icon:"mdi-pencil",variant:"text",color:"blue",onClick:ge=>Z(a)},null,8,["onClick"]),e(Y,{icon:"mdi-delete",variant:"text",color:"blue",onClick:ge=>ue(a)},null,8,["onClick"])])]),_:2},1032,["items-per-page","sort-by","page","items","loading","items-length","search"]),e(qe,{"max-width":"600",modelValue:_.value.open,"onUpdate:modelValue":l[17]||(l[17]=a=>_.value.open=a)},{default:t(()=>[e(ie,null,{default:t(()=>[e(ke,null,{default:t(()=>[e(_e,{class:"font-weight-black text-center text-h4"},{default:t(()=>[D(P(G.cardTitle),1)]),_:1}),e(Pe,null,{default:t(()=>[e(Me,{onSubmit:Ue(s(re),["prevent"]),disabled:s(E)},{default:t(()=>[e(K,null,{default:t(()=>[e(o,null,{default:t(()=>[e(i,{modelValue:w.value,"onUpdate:modelValue":l[9]||(l[9]=a=>w.value=a),"raw-model-value":h.value,"onUpdate:rawModelValue":l[10]||(l[10]=a=>h.value=a),accept:"image/jpeg,image/png",deletable:"","max-size":"1MB","help-text":"選擇檔案或拖曳到這裡","error-text":{type:"檔案格式不支援",size:"檔案大小不能超過 1MB"},ref_key:"fileAgent",ref:U},null,8,["modelValue","raw-model-value"])]),_:1})]),_:1}),e(K,null,{default:t(()=>[e(o,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:t(()=>[Mt]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(b,{modelValue:s(y).value.value,"onUpdate:modelValue":l[11]||(l[11]=a=>s(y).value.value=a),"error-messages":s(y).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:t(()=>[d("label",zt,P(G.numberTitle),1)]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(b,{modelValue:s(z).value.value,"onUpdate:modelValue":l[12]||(l[12]=a=>s(z).value.value=a),"error-messages":s(z).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:t(()=>[qt]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(Ie,{modelValue:s(N).value.value,"onUpdate:modelValue":l[13]||(l[13]=a=>s(N).value.value=a),"error-messages":s(N).errorMessage.value,label:"選擇",variant:"outlined",density:"comfortable",dense:"",items:v,"hide-details":""},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:t(()=>[d("label",Tt,P(G.descriptionTitle),1)]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(b,{modelValue:s(Q).value.value,"onUpdate:modelValue":l[14]||(l[14]=a=>s(Q).value.value=a),"error-messages":s(Q).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:t(()=>[At]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(b,{modelValue:s(X).value.value,"onUpdate:modelValue":l[15]||(l[15]=a=>s(X).value.value=a),"error-messages":s(X).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(Be,null,{default:t(()=>[d("div",Bt,[e(Y,{variant:"text",class:"rounded-xl b-1",density:"comfortable",type:"submit",loading:s(E)},{default:t(()=>[D("送出")]),_:1},8,["loading"]),e(Y,{text:"取消",variant:"text",class:"rounded-xl b-1",density:"comfortable",onClick:l[16]||(l[16]=a=>le())})])]),_:1})]),_:1},8,["onSubmit","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}},Ft=G=>(Ne("data-v-ab2ef7b8"),G=G(),We(),G),Rt={id:"profile",class:"b-1 w-50 text-center mx-auto rounded-lg"},Dt={id:"img",style:{width:"160px",height:"160px"},class:"rounded-circle d-flex justify-center align-center bg-grey-lighten-5 mx-auto my-5 b-1"},Lt=Ft(()=>d("div",{id:"upload"},"編輯",-1)),Et={key:0,style:{"font-size":"18px"}},jt={style:{"font-size":"18px"}},Kt={key:0,style:{"font-size":"18px"}},Ot={__name:"accountTable",setup(G){const ce=He(),{apiAuth:B}=pe(),V=me(),H=c(null),U=c([]),w=c([]),h=c([]);(async()=>{var F,L;try{const{data:E}=await B.get("/user/profile");h.value=[E.result],h.value[0].password="********",h.value[0].newUsername=h.value[0].username,h.value[0].newPassword="",console.log(h.value)}catch(E){V({text:((L=(F=E==null?void 0:E.response)==null?void 0:F.data)==null?void 0:L.message)||"發生錯誤",snackbarProps:{color:"red"}})}})();const M=Se({newUsername:A().min(3,"服務單位長度不符").max(20,"服務單位長度不符"),newPassword:A().min(6,"使用者密碼長度不符").max(20,"使用者密碼長度不符")}),{handleSubmit:q,isSubmitting:S}=Ce({validationSchema:M}),{value:T,errorMessage:p}=C("newUsername"),{value:x,errorMessage:n}=C("newPassword"),g=q(async()=>{var F,L;try{const E=h.value[0],j=new FormData;T.value&&T.value!==E.username&&j.append("username",T.value),x.value&&x.value!==""&&j.append("password",x.value),U.value.length!==0&&j.append("image",U.value[0].file);for(let[z,N]of j.entries())console.log(`${z}:`,N);if(j.get("username")===null&&j.get("password")===null&&j.get("image")===null){V({text:"沒有任何變更",snackbarProps:{color:"accent"}});return}console.log(j);const y=await B.patch("/user/change",j);y.data.success?(V({text:"資料修改成功",snackbarProps:{color:"green"}}),ce.push("/")):V({text:y.data.message||"發生錯誤",snackbarProps:{color:"red"}})}catch(E){V({text:((L=(F=E==null?void 0:E.response)==null?void 0:F.data)==null?void 0:L.message)||"發生錯誤",snackbarProps:{color:"red"}})}}),v=F=>{F.isEditing=!F.isEditing},_=F=>{F.isEditing=!1},Z=F=>{F.passwordisEditing=!F.passwordisEditing},le=F=>{F.passwordisEditing=!1};return(F,L)=>{const E=ne("vue-file-agent"),j=Xe;return $(),de(ie,{flat:""},{default:t(()=>[e(Me,{onSubmit:Ue(s(g),["prevent"]),disabled:s(S)},{default:t(()=>[e(Pe,null,{default:t(()=>[d("div",Rt,[e(Ee,{color:"info",class:"mb-10 rounded-t-lg bb-1",prominent:""},{default:t(()=>[e(je,{class:"ms-0 font-weight-bold"},{default:t(()=>[D("基本資料")]),_:1})]),_:1}),e(E,{id:"account",class:"d-flex justify-center mb-5",accept:"image/jpeg,image/png",deletable:"","max-size":"1MB","help-text":"上傳大頭照","error-text":{type:"檔案格式不支援",size:"檔案大小不能超過 1MB"},modelValue:U.value,"onUpdate:modelValue":L[0]||(L[0]=y=>U.value=y),"raw-model-value":w.value,"onUpdate:rawModelValue":L[1]||(L[1]=y=>w.value=y),ref_key:"fileAgent",ref:H},null,8,["modelValue","raw-model-value"]),($(!0),R(O,null,ee(h.value,y=>($(),R(O,{key:y.id},[d("div",Dt,[e(be,{src:y.avatar,cover:""},null,8,["src"])]),Lt],64))),128)),e(ke,null,{default:t(()=>[e(K,{class:"mb-5 px-15 text-left"},{default:t(()=>[e(o,{md:"2"}),e(o,{cols:"12",md:"3",class:"my-auto form-label",style:{"font-size":"18px"}},{default:t(()=>[D("服務單位")]),_:1}),($(!0),R(O,null,ee(h.value,y=>($(),R(O,{key:y.id},[e(o,{cols:"12",md:"4",class:"my-auto"},{default:t(()=>[y.isEditing?($(),de(Fe,{key:1,class:"form-label",style:{"font-size":"18px"},variant:"outlined","single-line":"",density:"comfortable",clearable:"",dense:"",modelValue:s(T),"onUpdate:modelValue":L[2]||(L[2]=z=>Ae(T)?T.value=z:null),"error-messages":s(p),onKeydown:xe(z=>_(y),["enter"])},null,8,["modelValue","error-messages","onKeydown"])):($(),R("p",Et,P(y.username),1))]),_:2},1024),e(o,{md:"3",class:"ps-10"},{default:t(()=>[e(Y,{onClick:z=>v(y),icon:"mdi-pencil",variant:"text",color:"blue-grey-darken-1"},null,8,["onClick"])]),_:2},1024)],64))),128)),e(ae)]),_:1}),e(K,{class:"mb-5 px-15 text-left"},{default:t(()=>[e(o,{md:"2"}),e(o,{cols:"12",md:"3",class:"my-auto form-label",style:{"font-size":"18px"}},{default:t(()=>[D("電子信箱")]),_:1}),($(!0),R(O,null,ee(h.value,y=>($(),de(o,{key:y.id,cols:"12",md:"4",class:"my-auto"},{default:t(()=>[d("p",jt,P(y.email),1)]),_:2},1024))),128)),e(ae)]),_:1}),e(K,{class:"mb-5 px-15 text-left"},{default:t(()=>[e(o,{md:"2"}),e(o,{cols:"12",md:"3",class:"my-auto form-label",style:{"font-size":"18px"}},{default:t(()=>[D("密碼")]),_:1}),($(!0),R(O,null,ee(h.value,y=>($(),R(O,{key:y.id},[e(o,{cols:"12",md:"4",class:"my-auto"},{default:t(()=>[y.passwordisEditing?($(),de(Fe,{key:1,class:"form-label",style:{"font-size":"18px"},variant:"outlined","single-line":"",density:"comfortable",clearable:"",dense:"",modelValue:s(x),"onUpdate:modelValue":L[3]||(L[3]=z=>Ae(x)?x.value=z:null),"error-messages":s(n),onKeydown:xe(z=>le(y),["enter"])},null,8,["modelValue","error-messages","onKeydown"])):($(),R("p",Kt,P(y.password),1))]),_:2},1024),e(o,{md:"3",class:"ps-10"},{default:t(()=>[e(Y,{onClick:z=>Z(y),icon:"mdi-pencil",variant:"text",color:"blue-grey-darken-1"},null,8,["onClick"])]),_:2},1024)],64))),128)),e(ae)]),_:1}),e(j,{text:"提交",class:"mx-auto bg-accent my-5"})]),_:1})])]),_:1})]),_:1},8,["onSubmit","disabled"])]),_:1})}}},Ht=Le(Ot,[["__scopeId","data-v-ab2ef7b8"]]),Nt={__name:"shareReplyTable",setup(G){const{api:ce,apiAuth:B}=pe(),V=me(),H=c(8),U=c([{key:"createdAt",order:"desc"}]),w=c(1),h=c([]),I=[{title:"物資",align:"center",sortable:!1,key:"image"},{title:"索取者聯絡資訊",align:"center",sortable:!1,key:"donations"}],M=c(!0),q=c(0),S=async T=>{var p,x,n,g;T&&(w.value=1),M.value=!0;try{const{data:v}=await B.get("/user/share",{params:{page:w.value,itemsPerPage:H.value,sortBy:((p=U.value[0])==null?void 0:p.key)||"createdAt",sortOrder:((x=U.value[0])==null?void 0:x.order)||"desc"}});console.log(v),h.value.splice(0,h.value.length,...v.result.data),q.value=v.result.total}catch(v){console.log(v),V({text:((g=(n=v==null?void 0:v.response)==null?void 0:n.data)==null?void 0:g.message)||"發生錯誤",snackbarProps:{color:"red"}})}M.value=!1};return S(),(T,p)=>{const x=ne("router-link");return $(),de(Ve,{"items-per-page":H.value,"onUpdate:itemsPerPage":[p[0]||(p[0]=n=>H.value=n),p[3]||(p[3]=n=>S(!1))],"sort-by":U.value,"onUpdate:sortBy":[p[1]||(p[1]=n=>U.value=n),p[4]||(p[4]=n=>S(!1))],page:w.value,"onUpdate:page":[p[2]||(p[2]=n=>w.value=n),p[5]||(p[5]=n=>S(!1))],items:h.value,headers:I,loading:M.value,"items-length":q.value,hover:"",class:"w-75 mx-auto rounded-lg mb-15"},{"item.image":t(({item:n})=>[e(o,{cols:"12",md:"4",class:"mx-auto",style:{width:"300px"}},{default:t(()=>[e(x,{to:"/material/share/"+n._id,style:{"text-decoration":"none"}},{default:t(()=>[e(be,{src:n.image,width:"250px","max-height":"200px",class:"my-5"},null,8,["src"])]),_:2},1032,["to"])]),_:2},1024)]),"item.donations":t(({item:n})=>[e(o,null,{default:t(()=>[($(!0),R(O,null,ee(n.donations,(g,v)=>($(),de(ie,{class:"mb-2",outlined:"",variant:"text",key:v},{default:t(()=>[e(_e,null,{default:t(()=>[e(K,{"no-gutters":""},{default:t(()=>[e(o,{cols:"3",class:"text-body-1 text-left"},{default:t(()=>[D("數量: "+P(g.quantity),1)]),_:2},1024),e(o,{cols:"5",class:"text-body-1 text-left"},{default:t(()=>[D("服務單位: "+P(g.donator),1)]),_:2},1024),e(o,{cols:"4",class:"text-body-1 text-left"},{default:t(()=>[D("聯絡電話: "+P(g.phone),1)]),_:2},1024)]),_:2},1024),e(ae,{class:"100%"})]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["items-per-page","sort-by","page","items","loading","items-length"])}}},Wt={__name:"findReplyTable",setup(G){const{api:ce,apiAuth:B}=pe(),V=me(),H=c(8),U=c([{key:"createdAt",order:"desc"}]),w=c(1),h=c([]),I=[{title:"物資",align:"center",sortable:!1,key:"image"},{title:"捐贈者聯絡資訊",align:"center",sortable:!1,key:"donations"}],M=c(!0),q=c(0),S=async T=>{var p,x,n,g;T&&(w.value=1),M.value=!0;try{const{data:v}=await B.get("/user/find",{params:{page:w.value,itemsPerPage:H.value,sortBy:((p=U.value[0])==null?void 0:p.key)||"createdAt",sortOrder:((x=U.value[0])==null?void 0:x.order)||"desc"}});console.log(v),h.value.splice(0,h.value.length,...v.result.data),q.value=v.result.total}catch(v){console.log(v),V({text:((g=(n=v==null?void 0:v.response)==null?void 0:n.data)==null?void 0:g.message)||"發生錯誤",snackbarProps:{color:"red"}})}M.value=!1};return S(),(T,p)=>{const x=ne("router-link");return $(),de(Ve,{"items-per-page":H.value,"onUpdate:itemsPerPage":[p[0]||(p[0]=n=>H.value=n),p[3]||(p[3]=n=>S(!1))],"sort-by":U.value,"onUpdate:sortBy":[p[1]||(p[1]=n=>U.value=n),p[4]||(p[4]=n=>S(!1))],page:w.value,"onUpdate:page":[p[2]||(p[2]=n=>w.value=n),p[5]||(p[5]=n=>S(!1))],items:h.value,headers:I,loading:M.value,"items-length":q.value,hover:"",class:"w-75 mx-auto rounded-lg mb-15"},{"item.image":t(({item:n})=>[e(o,{cols:"12",md:"4",class:"mx-auto",style:{width:"300px"}},{default:t(()=>[e(x,{to:"/material/find/"+n._id,style:{"text-decoration":"none"}},{default:t(()=>[e(be,{src:n.image,width:"250px","max-height":"200px",class:"my-5"},null,8,["src"])]),_:2},1032,["to"])]),_:2},1024)]),"item.donations":t(({item:n})=>[e(o,null,{default:t(()=>[($(!0),R(O,null,ee(n.donations,(g,v)=>($(),de(ie,{class:"mb-2",outlined:"",variant:"text",key:v},{default:t(()=>[e(_e,null,{default:t(()=>[e(K,{"no-gutters":""},{default:t(()=>[e(o,{cols:"3",class:"text-body-1 text-left"},{default:t(()=>[D("數量: "+P(g.quantity),1)]),_:2},1024),e(o,{cols:"5",class:"text-body-1 text-left"},{default:t(()=>[D("服務單位: "+P(g.donator),1)]),_:2},1024),e(o,{cols:"4",class:"text-body-1 text-left"},{default:t(()=>[D("聯絡電話: "+P(g.phone),1)]),_:2},1024)]),_:2},1024),e(ae,{class:"100%"})]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["items-per-page","sort-by","page","items","loading","items-length"])}}},Gt=d("h2",{class:"my-5 bg-accent text-center mx-auto w-75"},"地標管理",-1),Jt={style:{width:"240px"}},Qt={style:{width:"120px"}},Xt={style:{width:"300px"},class:"text-left"},Yt={style:{width:"200px"},class:"text-center"},Zt={style:{width:"350px"},class:"py-2 text-left"},el={style:{width:"80px"}},tl={class:"px-6 my-2"},ll=d("label",{class:"form-label"},"服務地址",-1),al=d("label",{class:"form-label"},"服務名稱",-1),sl=d("label",{class:"form-label"},"服務電話",-1),ol=d("label",{class:"form-label"},"服務項目",-1),nl=d("p",null,"服務對象",-1),rl=d("p",null,"長期照顧",-1),ul=d("p",null,"身心障礙",-1),dl=d("p",null,"兒童及少年",-1),il=d("p",null,"社會救助",-1),cl=d("p",null,"婦女",-1),ml=d("p",null,"其他",-1),pl=d("label",{class:"form-label"},"服務介紹",-1),gl={__name:"landmarkTable",setup(G){const{api:ce,apiAuth:B}=pe(),V=me(),H=["長期照顧","身心障礙","婦女","兒童及少年","保護性服務"],U=["日照中心","護理之家","居家服務","交通接送","家庭托顧"],w=["身心障礙者服務中心","輔具中心","職業重建中心","小作所","庇護工場"],h=["少年福利服務中心","親子館","課後班"],I=["經濟補助","待用餐","基金會","社會福利中心"],M=["婦女福利服務中心","新住民家庭服務中心"],q=c(10),S=c([{key:"createdAt",order:"desc"}]),T=c(1),p=c([]),x=[{title:"服務名稱",align:"center",sortable:!1,key:"name"},{title:"地址",align:"center",sortable:!0,key:"address"},{title:"聯絡電話",align:"center",sortable:!1,key:"tel"},{title:"服務項目",align:"center",sortable:!0,key:"categories"},{title:"服務介紹",align:"center",sortable:!1,key:"description"},{title:"操作",align:"center",sortable:!1,key:"action"}],n=c(!0),g=c(0),v=c(""),_=async W=>{var m,se,te,J;W&&(T.value=1),n.value=!0;try{const{data:oe}=await B.get("/user/landmark",{params:{page:T.value,itemsPerPage:q.value,sortBy:((m=S.value[0])==null?void 0:m.key)||"createdAt",sortOrder:((se=S.value[0])==null?void 0:se.order)||"desc",search:v.value}});console.log(oe),p.value.splice(0,p.value.length,...oe.result.data),g.value=oe.result.total}catch(oe){console.log(oe),V({text:((J=(te=oe==null?void 0:oe.response)==null?void 0:te.data)==null?void 0:J.message)||"發生錯誤",snackbarProps:{color:"red"}})}n.value=!1};_();const Z=c({open:!1,id:""}),le=W=>{Z.value.open=!0,Z.value.id=W._id,title.value.value=W.title,date.value.value=W.date,i.value.value=W.address,category.value.value=W.category,organizer.value.value=W.organizer,f.value.value=W.description},F=()=>{Z.value.open=!1,y(),fileAgent.value.deleteFileRecord()},L=Se({name:A().required("服務單位必填"),address:A().required("服務地址必填"),tel:A(),category5:ve().of(A()).required("分類必填"),category2:ve().of(A()).required("分類必填"),category3:ve().of(A()).required("分類必填"),category4:ve().of(A()).required("分類必填"),category5:ve().of(A()).required("分類必填"),category6:ve().of(A()).required("分類必填"),category7:ve().of(A()).required("分類必填"),description:A()}),{handleSubmit:E,isSubmitting:j,resetForm:y}=Ce({validationSchema:L,initialValues:{name:"",address:"",tel:"",category1:[],category2:[],category3:[],category4:[],category5:[],category6:[],category7:[],description:""}}),z=C("name"),N=C("tel"),Q=C("category1"),X=C("category2"),re=C("category3"),ue=C("category4"),u=C("category5"),l=C("category6"),k=C("category7"),f=C("description"),{value:i,errorMessage:b}=C("address"),a=E(async W=>{var m,se,te;if(!((m=fileRecords.value[0])!=null&&m.error)&&!(fileRecords.value.length<1))try{const J=new FormData;J.append("title",W.title),J.append("date",W.date),J.append("address",W.address),J.append("category",W.category),J.append("organizer",W.organizer),J.append("description",W.description),fileRecords.value.length>0&&J.append("image",fileRecords.value[0].file),await B.patch("/event/"+Z.value.id,J),V({text:"新增成功",snackbarProps:{color:"green"}}),F()}catch(J){console.log(J),V({text:((te=(se=J==null?void 0:J.response)==null?void 0:se.data)==null?void 0:te.message)||"發生錯誤",snackbarProps:{color:"red"}})}});ze(v,()=>{_(!0)});const ge=async W=>{var m,se;try{await B.delete(`/landmark/${W._id}`),V({text:"刪除成功",snackbarProps:{color:"green"}}),_(!0)}catch(te){console.log(te),V({text:((se=(m=te==null?void 0:te.response)==null?void 0:m.data)==null?void 0:se.message)||"發生錯誤",snackbarProps:{color:"red"}})}};return(W,m)=>{const se=$e,te=$e,J=Te,oe=Ye;return $(),R(O,null,[Gt,e(Ve,{"items-per-page":q.value,"onUpdate:itemsPerPage":[m[3]||(m[3]=r=>q.value=r),m[6]||(m[6]=r=>_(!1))],"sort-by":S.value,"onUpdate:sortBy":[m[4]||(m[4]=r=>S.value=r),m[7]||(m[7]=r=>_(!1))],page:T.value,"onUpdate:page":[m[5]||(m[5]=r=>T.value=r),m[8]||(m[8]=r=>_(!1))],items:p.value,headers:x,loading:n.value,"items-length":g.value,search:v.value,hover:"",class:"w-75 mx-auto rounded-lg mb-15"},{top:t(()=>[e(se,{class:"my-5",modelValue:v.value,"onUpdate:modelValue":m[0]||(m[0]=r=>v.value=r),onClickAppend:m[1]||(m[1]=r=>_(!0)),onKeydown:m[2]||(m[2]=xe(r=>_(!0),["enter"])),"max-width":"100%"},null,8,["modelValue"])]),"item.name":t(({item:r})=>[d("td",Jt,P(r.name),1)]),"item.tel":t(({item:r})=>[d("td",Qt,P(r.tel),1)]),"item.address":t(({item:r})=>[d("td",Xt,P(r.address),1)]),"item.categories":t(({item:r})=>[d("td",Yt,P(r.categories.join(" , ")),1)]),"item.description":t(({item:r})=>[d("td",Zt,P(r.description),1)]),"item.action":t(({item:r})=>[d("td",el,[D(P(r.action)+" ",1),e(Y,{icon:"mdi-pencil",variant:"text",color:"blue",onClick:Ke=>le(r)},null,8,["onClick"]),e(Y,{icon:"mdi-delete",variant:"text",color:"blue",onClick:Ke=>ge(r)},null,8,["onClick"])])]),_:2},1032,["items-per-page","sort-by","page","items","loading","items-length","search"]),e(qe,{"max-width":"700",modelValue:Z.value.open,"onUpdate:modelValue":m[20]||(m[20]=r=>Z.value.open=r)},{default:t(()=>[e(ie,null,{default:t(()=>[e(Ee,{color:"secondary",prominent:"",class:"bb-1"},{default:t(()=>[e(je,{class:"mt-3"},{default:t(()=>[D(" 修改地標 ")]),_:1})]),_:1}),d("div",tl,[e(Me,{onSubmit:Ue(s(a),["prevent"]),disabled:s(j)},{default:t(()=>[e(K,{class:"my-1"},{default:t(()=>[e(o,{cols:"12",md:"3",class:"my-auto text-center ps-6"},{default:t(()=>[ll]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(te,{modelValue:s(i),"onUpdate:modelValue":m[9]||(m[9]=r=>Ae(i)?i.value=r:null),"error-messages":s(b),label:"輸入資源地址","max-width":"1000px"},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-center ps-6"},{default:t(()=>[al]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(J,{modelValue:s(z).value.value,"onUpdate:modelValue":m[10]||(m[10]=r=>s(z).value.value=r),"error-messages":s(z).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-center ps-6"},{default:t(()=>[sl]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(J,{modelValue:s(N).value.value,"onUpdate:modelValue":m[11]||(m[11]=r=>s(N).value.value=r),"error-messages":s(N).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"mt-2 text-center ps-6"},{default:t(()=>[ol]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(Ze,{variant:"accordion"},{default:t(()=>[e(et,{title:"選擇類別"},{default:t(()=>[e(tt,null,{default:t(()=>[e(ke,null,{default:t(()=>[e(K,null,{default:t(()=>[e(o,null,{default:t(()=>[nl,d("div",null,[e(fe,{modelValue:s(Q).value.value,"onUpdate:modelValue":m[12]||(m[12]=r=>s(Q).value.value=r),"error-messages":s(Q).errorMessage.value,column:"",multiple:""},{default:t(()=>[($(),R(O,null,ee(H,r=>e(ye,{text:r,value:r,filter:"",density:"compact"},null,8,["text","value"])),64))]),_:1},8,["modelValue","error-messages"])]),e(ae)]),_:1})]),_:1}),e(K,null,{default:t(()=>[e(o,null,{default:t(()=>[rl,d("div",null,[e(fe,{modelValue:s(X).value.value,"onUpdate:modelValue":m[13]||(m[13]=r=>s(X).value.value=r),"error-messages":s(X).errorMessage.value,column:"",multiple:""},{default:t(()=>[($(),R(O,null,ee(U,r=>e(ye,{text:r,value:r,filter:"",density:"compact"},null,8,["text","value"])),64))]),_:1},8,["modelValue","error-messages"])]),e(ae)]),_:1})]),_:1}),e(K,null,{default:t(()=>[e(o,null,{default:t(()=>[ul,d("div",null,[e(fe,{modelValue:s(re).value.value,"onUpdate:modelValue":m[14]||(m[14]=r=>s(re).value.value=r),"error-messages":s(re).errorMessage.value,column:"",multiple:""},{default:t(()=>[($(),R(O,null,ee(w,r=>e(ye,{text:r,value:r,filter:"",density:"compact"},null,8,["text","value"])),64))]),_:1},8,["modelValue","error-messages"])]),e(ae)]),_:1})]),_:1}),e(K,null,{default:t(()=>[e(o,null,{default:t(()=>[dl,d("div",null,[e(fe,{modelValue:s(ue).value.value,"onUpdate:modelValue":m[15]||(m[15]=r=>s(ue).value.value=r),"error-messages":s(ue).errorMessage.value,column:"",multiple:""},{default:t(()=>[($(),R(O,null,ee(h,r=>e(ye,{text:r,value:r,filter:"",density:"compact"},null,8,["text","value"])),64))]),_:1},8,["modelValue","error-messages"])]),e(ae)]),_:1})]),_:1}),e(K,null,{default:t(()=>[e(o,null,{default:t(()=>[il,d("div",null,[e(fe,{modelValue:s(u).value.value,"onUpdate:modelValue":m[16]||(m[16]=r=>s(u).value.value=r),"error-messages":s(u).errorMessage.value,column:"",multiple:""},{default:t(()=>[($(),R(O,null,ee(I,r=>e(ye,{text:r,value:r,filter:"",density:"compact"},null,8,["text","value"])),64))]),_:1},8,["modelValue","error-messages"])]),e(ae)]),_:1})]),_:1}),e(K,null,{default:t(()=>[e(o,null,{default:t(()=>[cl,d("div",null,[e(fe,{modelValue:s(k).value.value,"onUpdate:modelValue":m[17]||(m[17]=r=>s(k).value.value=r),"error-messages":s(k).errorMessage.value,column:"",multiple:""},{default:t(()=>[($(),R(O,null,ee(M,r=>e(ye,{text:r,value:r,filter:"",density:"compact"},null,8,["text","value"])),64))]),_:1},8,["modelValue","error-messages"])]),e(ae)]),_:1})]),_:1}),e(K,null,{default:t(()=>[e(o,null,{default:t(()=>[ml,e(fe,{modelValue:s(l).value.value,"onUpdate:modelValue":m[18]||(m[18]=r=>s(l).value.value=r),"error-messages":s(l).errorMessage.value,column:"",multiple:""},{default:t(()=>[e(ye,{value:"其他",text:"其他",filter:"",density:"compact"})]),_:1},8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(o,{cols:"12",md:"3",class:"text-center ps-6"},{default:t(()=>[pl]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(De,{style:{"white-space":"pre-line"},variant:"outlined",clearable:"",modelValue:s(f).value.value,"onUpdate:modelValue":m[19]||(m[19]=r=>s(f).value.value=r),"error-messages":s(f).errorMessage.value,"hide-details":""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(K,null,{default:t(()=>[e(o,{class:"text-center"},{default:t(()=>[e(oe,{type:"submit",class:"b-1 bg-accent mb-8",onClick:W.addMarker},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onSubmit","disabled"])])]),_:1})]),_:1},8,["modelValue"])],64)}}},vl={class:"d-flex flex-row"},fl={class:"mx-auto mb-5 rounded-lg"},yl={class:"mx-auto mb-5 rounded-lg"},bl={class:"mx-auto mb-5 rounded-lg"},xl={class:"mx-auto mb-5 rounded-lg"},_l={__name:"setting",setup(G){const{api:ce,apiAuth:B}=pe(),V=me();c(null),c([]),c([]);const H=["會員中心","基本資料"],U=["會員中心","地標管理"],w=["會員中心","貼文管理"],h=["會員中心","活動收藏"],I=c("option-1"),M=["會員中心","物資管理"],q=c("true"),S=c([]),T=async()=>{try{const{data:x}=await B.get("/user/mark");S.value=x.map(n=>({...n,isFavorite:!0}))}catch(x){console.error("Failed to fetch favorite event details:",x)}},p=async x=>{try{await B.patch("/user/mark",{eventId:x}),S.value=S.value.filter(n=>n._id!==x),V({text:"取消收藏",snackbarProps:{color:"info"}})}catch(n){console.error("取消收藏失败",n),V({text:"取消收藏失败",snackbarProps:{color:"red"}})}};return Ge(()=>{T()}),(x,n)=>{const g=Oe,v=ne("router-link");return $(),R(O,null,[e(st,{class:"b-1 text-center",width:"250"},{default:t(()=>[e(lt,{modelValue:I.value,"onUpdate:modelValue":n[0]||(n[0]=_=>I.value=_),color:"teal-darken-4",direction:"vertical","show-arrows":""},{default:t(()=>[e(we,{"prepend-icon":"mdi-account",text:"基本資料",value:"option-1",height:"100",class:"text-body-1 ms-1"}),e(we,{"prepend-icon":"mdi-lock",text:"地標管理",value:"option-2",height:"100",class:"text-body-1 ms-1"}),e(we,{"prepend-icon":"mdi-access-point",text:"貼文管理",value:"option-3",height:"100",class:"text-body-1 ms-1"}),e(we,{"prepend-icon":"mdi-book-cog",text:"活動收藏",value:"option-4",height:"100",class:"text-body-1 ms-1"}),e(we,{"prepend-icon":"mdi-package-variant-closed-check",text:"物資管理",value:"option-5",height:"100",class:"text-body-1 ms-1"})]),_:1},8,["modelValue"])]),_:1}),e(ie,{class:"h-100"},{default:t(()=>[d("div",vl,[e(ke,null,{default:t(()=>[e(at,{modelValue:I.value,"onUpdate:modelValue":n[1]||(n[1]=_=>I.value=_),class:"my-10"},{default:t(()=>[e(he,{value:"option-1"},{default:t(()=>[e(g,{title:H}),e(Ht)]),_:1}),e(he,{value:"option-2"},{default:t(()=>[e(g,{title:U}),e(gl)]),_:1}),e(he,{value:"option-3"},{default:t(()=>[e(g,{title:w}),d("div",fl,[e(It)]),d("div",yl,[e(Pt)]),d("div",bl,[e(ft)])]),_:1}),e(he,{value:"option-4"},{default:t(()=>[e(g,{title:h}),($(!0),R(O,null,ee(S.value,_=>($(),R("div",{class:"w-66 mx-auto b-1 rounded-lg my-5",key:_._id},[e(ie,{variant:"flat",class:"rounded-lg"},{default:t(()=>[e(K,{class:"align-center my-4 ps-10"},{default:t(()=>[e(o,{cols:"3",class:"align-self-start"},{default:t(()=>[e(v,{to:"/event/"+_._id,style:{"text-decoration":"none"}},{default:t(()=>[e(be,{src:_.image,class:"b-1 rounded-lg",width:"250px",height:"280px",cover:""},null,8,["src"])]),_:2},1032,["to"])]),_:2},1024),e(o,{cols:"7",class:"align-self-start"},{default:t(()=>[e(_e,null,{default:t(()=>[D(P(_.title),1)]),_:2},1024),e(Je,null,{default:t(()=>[D(P(_.organizer),1)]),_:2},1024),e(Pe,{style:{"white-space":"pre-line"}},{default:t(()=>[D(P(_.description),1)]),_:2},1024)]),_:2},1024),e(o,{cols:"2",class:"align-self-start mt-2"},{default:t(()=>[q.value?($(),de(Y,{key:0,id:"btn",text:"取消收藏","prepend-icon":"mdi-bookmark",variant:"outlined",style:{"background-color":"#F5B4B4"},onClick:Z=>p(_._id)},null,8,["onClick"])):Qe("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]),_:1}),e(he,{value:"option-5"},{default:t(()=>[e(g,{title:M}),d("div",xl,[e(Nt),e(Wt)])]),_:1})]),_:1},8,["modelValue"])]),_:1})])]),_:1})],64)}}},Kl=Le(_l,[["__scopeId","data-v-2e937919"]]);export{Kl as default};
