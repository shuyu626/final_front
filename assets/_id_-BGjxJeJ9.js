import{_ as N}from"./appButton-C1kZ687X.js";import{d as T,a3 as A,i as D,n as x,P as O,o as u,e as _,w as a,b as e,C as R,y as M,V as U,T as q,a as t,B as n,h as d,c as k,t as V,F as w,g as B,a4 as F,a5 as G,v as C,m as H,l as g,p as J,D as K,E as Q}from"./index-DBcWdWYL.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as X,a as Y}from"./VContainer-CRu9_oW4.js";import{V as Z}from"./VBreadcrumbs-CIeNuOgP.js";import{a as l,V as b}from"./VRow-CFsfkzHp.js";const I=p=>(K("data-v-15bd3dd6"),p=p(),Q(),p),$=I(()=>g("h2",{class:"info"},"活動介紹",-1)),ee={class:"b-1 info pa-4 mb-5"},ae=I(()=>g("h3",{class:"info d-sm-none mb-2"},"活動介紹",-1)),te={style:{"white-space":"pre-line"},class:"text-sm-body-1 w-100"},se={__name:"[id]",props:{event:Object,isFavorite:Boolean},setup(p){const v=T(),{api:S,apiAuth:h}=J(),z=A(),f=D(),P=x([{title:"首頁",disabled:!1,href:"/"},{title:"活動分享",disabled:!1,href:"../event/findEvent.vue"},{title:"物資詳情",disabled:!0}]),s=x({_id:"",title:"",date:"",address:"",category:"",organizer:"",description:"",image:""}),i=x(p.isFavorite),L=async()=>{var c,m;try{const{data:r}=await S.get("/event/"+z.params.id);Object.assign(s.value,r.result),v.isLogin&&(i.value=await j(s.value._id))}catch(r){console.log(r),f({text:((m=(c=r==null?void 0:r.response)==null?void 0:c.data)==null?void 0:m.message)||"發生錯誤",snackbarProps:{color:"red"}})}},j=async c=>{var m,r;try{const{data:o}=await h.get("/user/mark");return o.some(E=>E._id===c)}catch(o){return console.log(o),f({text:((r=(m=o==null?void 0:o.response)==null?void 0:m.data)==null?void 0:r.message)||"發生錯誤",snackbarProps:{color:"red"}}),!1}},y=async()=>{if(!v.isLogin){f({text:"請登入後再收藏活動",snackbarProps:{color:"red"}});return}try{const c=await h.post("/user/toggleFavorite",{eventId:s.value._id});i.value=c.data.isFavorite,console.log(i.value),f({text:c.data.isFavorite?"已收藏":"取消收藏",snackbarProps:{color:c.data.isFavorite?"#F5B4B4":"info"}})}catch(c){console.error("收藏操作失败",c),f({text:"收藏操作失败",snackbarProps:{color:"red"}})}};return O(L),(c,m)=>{const r=N;return u(),_(X,null,{default:a(()=>[e(Z,{items:P.value},{divider:a(()=>[e(R,{icon:"mdi-chevron-right"})]),_:1},8,["items"]),e(b,{"justify-center":"",class:"mt-2 flex-column flex-sm-row"},{default:a(()=>[e(l,{cols:"12",sm:"6",md:"5",lg:"6",class:"w-66 w-sm-100 d-flex justify-center align-start mx-auto",style:{"margin-top":"20px"}},{default:a(()=>[e(M,{src:s.value.image,class:"image",contain:""},null,8,["src"])]),_:1}),e(l,{cols:"12",sm:"6",md:"7",lg:"6"},{default:a(()=>[e(U,{variant:"flat",class:"d-none d-sm-block"},{default:a(()=>[e(q,{class:"card-title",style:{"white-space":"pre-line"}},{default:a(()=>[t("活動名稱："+n(s.value.title),1)]),_:1}),e(Y,{thickness:"0"}),e(d,{class:"card-text"},{default:a(()=>[t("活動時間")]),_:1}),e(d,{class:"card-text"},{default:a(()=>[t(n(s.value.date),1)]),_:1}),e(d,{class:"card-text"},{default:a(()=>[t("活動地點")]),_:1}),e(d,{class:"card-text"},{default:a(()=>[t(n(s.value.address),1)]),_:1}),e(d,{class:"card-text"},{default:a(()=>[t("活動類別")]),_:1}),(u(!0),k(w,null,V(s.value.category,o=>(u(),_(d,{class:"card-text",key:o},{default:a(()=>[t(n(o),1)]),_:2},1024))),128)),e(d,{class:"card-text"},{default:a(()=>[t("主辦單位")]),_:1}),e(d,{class:"card-text"},{default:a(()=>[t(n(s.value.organizer),1)]),_:1}),e(d),e(d),e(d),B(v).isLogin?(u(),_(r,{key:0,"prepend-icon":i.value?"mdi-bookmark":"mdi-bookmark-outline",text:i.value?"已收藏":"我要收藏",class:F([i.value?"me-15":"me-15 bg-info","text-body-3"]),style:G(i.value?{backgroundColor:"#F5B4B4"}:{}),onClick:y,width:"125",height:"32",ripple:!1},null,8,["prepend-icon","text","class","style"])):C("",!0)]),_:1}),e(b,{class:"pl-4 d-flex d-sm-none"},{default:a(()=>[e(l,{cols:"12",class:"font-weight-black card-title",style:{"white-space":"pre-line"}},{default:a(()=>[t("活動名稱："+n(s.value.title),1)]),_:1}),e(l,{cols:"4",class:"card-text"},{default:a(()=>[t("活動時間")]),_:1}),e(l,{cols:"8",class:"card-text"},{default:a(()=>[t(n(s.value.date),1)]),_:1}),e(l,{cols:"4",class:"card-text"},{default:a(()=>[t("活動地點")]),_:1}),e(l,{cols:"8",class:"card-text"},{default:a(()=>[t(n(s.value.address),1)]),_:1}),e(l,{cols:"4",class:"card-text"},{default:a(()=>[t("活動類別")]),_:1}),(u(!0),k(w,null,V(s.value.category,o=>(u(),_(l,{cols:"8",class:"card-text",key:o},{default:a(()=>[t(n(o),1)]),_:2},1024))),128)),e(l,{cols:"4",class:"card-text"},{default:a(()=>[t("主辦單位")]),_:1}),e(l,{cols:"8",class:"card-text"},{default:a(()=>[t(n(s.value.organizer),1)]),_:1}),e(l,{cols:"12",class:"mt-6",style:{position:"relative"}},{default:a(()=>[B(v).isLogin?(u(),_(H,{key:0,color:"medium-emphasis",icon:i.value?"mdi-heart":"mdi-heart-outline",class:F([i.value?"me-5 mb-2 bg-red-lighten-4":"me-5 mb-2 bg-info","bg-transparent xs-btn m-0"]),size:"small",onClick:y,elevation:"0",variant:"text"},null,8,["icon","class"])):C("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),e(b,null,{default:a(()=>[e(l,{cols:"12",class:"d-none d-sm-flex mt-lg-2 py-0"},{default:a(()=>[$]),_:1}),e(l,{cols:"12"},{default:a(()=>[g("div",ee,[ae,g("p",te,n(s.value.description),1)])]),_:1})]),_:1})]),_:1})}}},ue=W(se,[["__scopeId","data-v-15bd3dd6"]]);export{ue as default};
