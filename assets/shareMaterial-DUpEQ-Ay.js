import{_ as Q}from"./appButton-BxEyCR2i.js";import{_ as $}from"./resourceDialog-D1a4Zjiz.js";import{q as O,i as H,n as u,O as I,P as J,r as K,o as i,c as h,b as e,w as t,F as V,C as W,g as X,e as g,v as Y,a6 as B,a5 as L,a as d,t as w,j as Z,p as ee,B as b,V as ae,l as le,y as te,T as se,a7 as oe,h as ne}from"./index-BcB6MkBv.js";import{_ as re}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as P,a as ue}from"./VContainer-Cs0rPrU8.js";import{V as ie}from"./VNavigationDrawer-X5eUIOYM.js";import{V as me}from"./VBreadcrumbs-C2b4K4Ot.js";import{a as de,b as U}from"./VTooltip-uWx5Rgt6.js";import{V as ce}from"./VSlideGroup-7S9rnn5C.js";import{a as z}from"./VSelect-Byz7Z2yG.js";import{V as M,a as C}from"./VRow-B0kGOfrC.js";import{V as fe}from"./VPagination-CnAZ85vE.js";import{a as pe}from"./_commonjsHelpers-a_Gz_uuT.js";import{V as T}from"./VCheckbox-Bp3tIbOl.js";import"./inputText-BQNnme89.js";import"./index.esm-CpgJHFyt.js";import"./ssrBoot-DVypV-me.js";const _e={class:"d-flex justify-content-center b-1 item-img"},A=8,ve={__name:"shareMaterial",setup(he){const{mobile:D}=O(),{api:N}=ee(),q=H(),F=u([{title:"首頁",disabled:!1,href:"/"},{title:"我想分享",disabled:!0}]),r=u([{name:"食品",selected:!1},{name:"服飾配件",selected:!1},{name:"日用品",selected:!1},{name:"家具",selected:!1},{name:"輔具",selected:!1},{name:"教育用品",selected:!1},{name:"嬰幼兒用品",selected:!1},{name:"電器",selected:!1},{name:"休閒用品",selected:!1},{name:"其他",selected:!1}]),n=u(!0),f=u([]),c=u(""),m=()=>{let o=r.value.filter(a=>a.selected).map(a=>a.name);const s=c.value?c.value.toLowerCase():"";n.value?f.value=p.value.filter(a=>a.name.toLowerCase().includes(s)||a.organizer.toLowerCase().includes(s)):o.length===0&&s.trim()===""?f.value=[]:f.value=p.value.filter(a=>{const x=o.length===0||o.includes(a.category),y=a.name.toLowerCase().includes(s)||a.organizer.toLowerCase().includes(s);return x&&y})};I(c,()=>{m()}),I(()=>r.value.map(o=>o.selected),()=>{m(),n.value=r.value.every(o=>o.selected)},{deep:!0});const E=()=>{r.value.forEach(o=>{o.selected=n.value}),m()};J(()=>{E()});const G=(o,s)=>{n.value?(n.value=!1,r.value.forEach(a=>{a.selected=a===o})):(o.selected=!o.selected,n.value=r.value.every(a=>a.selected)),s(),m()},R=o=>{n.value=!n.value,r.value.forEach(s=>{s.selected=n.value}),o&&o(),m()},k=u(1),S=u(1),p=u([]),_=async()=>{var o,s;try{const{data:a}=await N.get("/material/share",{params:{itemsPerPage:A,page:k.value}});S.value=Math.ceil(a.result.total/A),p.value.splice(0,p.value.length,...a.result.data),m()}catch(a){console.log(a),q({text:((s=(o=a==null?void 0:a.response)==null?void 0:o.data)==null?void 0:s.message)||"發生錯誤",snackbarProps:{color:"red"}})}};return _(),(o,s)=>{const a=$,x=K("router-link"),y=Q;return i(),h(V,null,[e(P,{class:"h-100"},{default:t(()=>[e(me,{items:F.value},{divider:t(()=>[e(W,{icon:"mdi-chevron-right"})]),_:1},8,["items"]),X(D)?(i(),g(a,{key:0,onUpdate:_})):Y("",!0),e(B,{"max-width":"900",class:"mx-auto d-xl-none d-lg-block"},{default:t(()=>[e(de,{class:"w-100 mx-auto d-inline-block"},{default:t(()=>[e(ce,{"show-arrows":"",multiple:"","mobile-breakpoint":"xxl"},{default:t(()=>[e(U,null,{default:t(({toggle:l})=>[e(z,{style:L({backgroundColor:n.value?"#616161":"#EEEEEE",color:n.value?"white":"black"}),class:"ma-2",onClick:()=>R(l)},{default:t(()=>[d(" 全部 ")]),_:2},1032,["style","onClick"])]),_:1}),(i(!0),h(V,null,w(r.value,l=>(i(),g(U,{key:l.name},{default:t(({isSelected:v,toggle:j})=>[e(z,{style:L({backgroundColor:n.value||v?"#616161":"#EEEEEE",color:n.value||v?"white":"black"}),class:"ma-2",onClick:()=>G(l,j)},{default:t(()=>[d(b(l.name),1)]),_:2},1032,["style","onClick"])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),e(M,{class:"pl-lg-15 h-100"},{default:t(()=>[(i(!0),h(V,null,w(f.value,l=>(i(),g(C,{key:l.id,cols:"12",md:"6"},{default:t(()=>[e(ae,{variant:"flat"},{default:t(()=>[e(M,{class:"align-content-center h-100 my-4"},{default:t(()=>[e(C,{cols:"6",sm:"7",md:"6",class:"ml-5 ml-sm-0"},{default:t(()=>[e(x,{to:"/material/share/"+l._id},{default:t(()=>[le("div",_e,[e(te,{src:l.image,contain:""},null,8,["src"])])]),_:2},1032,["to"])]),_:2},1024),e(C,{cols:"5",sm:"5",md:"5"},{default:t(()=>[e(se,{class:"text-h6 text-md-h6 font-weight-bold ms-md-1"},{default:t(()=>[d(b(l.name),1)]),_:2},1024),e(oe,{style:{"font-size":"16px"},class:"ms-md-1"},{default:t(()=>[d(b(l.organizer),1)]),_:2},1024),e(ne,{style:{"font-size":"15px"},class:"ms-md-1 pt-sm-1 pb-sm-2"},{default:t(()=>[d("數量："+b(l.quantity),1)]),_:2},1024),e(y,{text:"詳細說明",class:"bg-third ms-md-4 ms-3",to:"/material/share/"+l._id},null,8,["to"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),e(C,{cols:"12"},{default:t(()=>[e(fe,{modelValue:k.value,"onUpdate:modelValue":[s[0]||(s[0]=l=>k.value=l),_],length:S.value,rounded:"circle"},null,8,["modelValue","length"])]),_:1})]),_:1})]),_:1}),e(ie,{class:"bg-primary b-1 text-center",width:"300"},{default:t(()=>[e(a,{"card-title":"分享物資","number-title":"數量","description-title":"物資概況",onUpdate:_}),e(B,null,{default:t(()=>[e(Z,{variant:"outlined",label:"搜尋","prepend-inner-icon":"mdi-magnify","hide-details":"","single-line":"",density:"comfortable",clearable:"",width:"250",class:"bg-white mx-auto mt-5 my-5",modelValue:c.value,"onUpdate:modelValue":s[1]||(s[1]=l=>c.value=l)},null,8,["modelValue"])]),_:1}),e(pe,{class:"text-h5 font-weight-black text-left ml-2"},{default:t(()=>[d("物資類別")]),_:1}),e(ue,{thickness:"2",length:"250",class:"mx-auto"}),e(P,null,{default:t(()=>[e(T,{modelValue:n.value,"onUpdate:modelValue":s[2]||(s[2]=l=>n.value=l),label:"所有物品",onChange:s[3]||(s[3]=l=>E()),"hide-details":"",density:"comfortable"},null,8,["modelValue"]),(i(!0),h(V,null,w(r.value,l=>(i(),g(T,{key:l.name,modelValue:l.selected,"onUpdate:modelValue":v=>l.selected=v,label:l.name,onChange:m,"hide-details":"",class:"ml-5",density:"comfortable"},null,8,["modelValue","onUpdate:modelValue","label"]))),128))]),_:1})]),_:1})],64)}}},Te=re(ve,[["__scopeId","data-v-7ada81f1"]]);export{Te as default};
