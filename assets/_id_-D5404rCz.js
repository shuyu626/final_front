import{_ as I}from"./appButton-D4uc5r1D.js";import{d as S,a3 as P,i as j,n as v,P as z,o as p,e as g,w as a,b as e,C as E,y as L,V as N,T,a as i,B as d,h as o,c as A,t as D,F as O,g as R,a4 as M,a5 as U,v as $,l as h,p as q,D as G,E as H}from"./index-BiURfRMU.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as K,a as Q}from"./VContainer-Bnc02L_J.js";import{V as W}from"./VBreadcrumbs-CfQyS5ML.js";import{a as _,V as y}from"./VRow-C924zwMG.js";const X=u=>(G("data-v-f6de17be"),u=u(),H(),u),Y=X(()=>h("h2",{class:"info"},"活動介紹",-1)),Z={class:"b-1 info pa-4"},ee={style:{"white-space":"pre-line"},class:"text-body-1 w-75"},ae={__name:"[id]",props:{event:Object,isFavorite:Boolean},setup(u){const m=S(),{api:w,apiAuth:b}=q(),x=P(),f=j(),V=v([{title:"首頁",disabled:!1,href:"/"},{title:"活動分享",disabled:!1,href:"../event/findEvent.vue"},{title:"物資詳情",disabled:!0}]),r=v({_id:"",title:"",date:"",address:"",category:"",organizer:"",description:"",image:""}),c=v(u.isFavorite),k=async()=>{var t,n;try{const{data:s}=await w.get("/event/"+x.params.id);Object.assign(r.value,s.result),m.isLogin&&(c.value=await F(r.value._id))}catch(s){console.log(s),f({text:((n=(t=s==null?void 0:s.response)==null?void 0:t.data)==null?void 0:n.message)||"發生錯誤",snackbarProps:{color:"red"}})}};k();const F=async t=>{var n,s;try{const{data:l}=await b.get("/user/mark");return l.some(C=>C._id===t)}catch(l){return console.log(l),f({text:((s=(n=l==null?void 0:l.response)==null?void 0:n.data)==null?void 0:s.message)||"發生錯誤",snackbarProps:{color:"red"}}),!1}},B=async()=>{if(!m.isLogin){f({text:"請登入後再收藏活動",snackbarProps:{color:"red"}});return}try{const t=await b.post("/user/toggleFavorite",{eventId:r.value._id});c.value=t.data.isFavorite,console.log(c.value),f({text:t.data.isFavorite?"已收藏":"取消收藏",snackbarProps:{color:t.data.isFavorite?"#F5B4B4":"info"}})}catch(t){console.error("收藏操作失败",t),f({text:"收藏操作失败",snackbarProps:{color:"red"}})}};return z(k),(t,n)=>{const s=I;return p(),g(K,null,{default:a(()=>[e(W,{items:V.value},{divider:a(()=>[e(E,{icon:"mdi-chevron-right"})]),_:1},8,["items"]),e(y,{"justify-center":""},{default:a(()=>[e(_,{cols:"5",class:"d-flex justify-center"},{default:a(()=>[e(L,{src:r.value.image,class:"","max-width":"400","max-height":"500",contain:""},null,8,["src"])]),_:1}),e(_,{cols:"6"},{default:a(()=>[e(N,{variant:"flat"},{default:a(()=>[e(T,{class:"font-weight-black",style:{"white-space":"pre-line"}},{default:a(()=>[i("活動名稱："+d(r.value.title),1)]),_:1}),e(Q,{thickness:"0"}),e(o,{class:"font-weight-black"},{default:a(()=>[i("活動時間")]),_:1}),e(o,null,{default:a(()=>[i(d(r.value.date),1)]),_:1}),e(o,{class:"font-weight-black"},{default:a(()=>[i("活動地點")]),_:1}),e(o,null,{default:a(()=>[i(d(r.value.address),1)]),_:1}),e(o,{class:"font-weight-black"},{default:a(()=>[i("活動類別")]),_:1}),(p(!0),A(O,null,D(r.value.category,l=>(p(),g(o,{key:l},{default:a(()=>[i(d(l),1)]),_:2},1024))),128)),e(o,{class:"font-weight-black"},{default:a(()=>[i("主辦單位")]),_:1}),e(o,null,{default:a(()=>[i(d(r.value.organizer),1)]),_:1}),e(o),e(o),e(o),R(m).isLogin?(p(),g(s,{key:0,"prepend-icon":c.value?"mdi-bookmark":"mdi-bookmark-outline",text:c.value?"已收藏":"我要收藏",class:M([c.value?"me-15":"me-15 bg-info","text-body-3"]),style:U(c.value?{backgroundColor:"#F5B4B4"}:{}),onClick:B,width:"125",height:"32"},null,8,["prepend-icon","text","class","style"])):$("",!0)]),_:1})]),_:1})]),_:1}),e(y,null,{default:a(()=>[e(_,{cols:"12",class:"mt-10"},{default:a(()=>[Y]),_:1}),e(_,{cols:"12"},{default:a(()=>[h("div",Z,[h("p",ee,d(r.value.description),1)])]),_:1})]),_:1})]),_:1})}}},ne=J(ae,[["__scopeId","data-v-f6de17be"]]);export{ne as default};
