import{_ as S}from"./appButton-CTVatjU1.js";import{d as P,a3 as j,i as E,n as x,t as N,o as g,e as b,w as a,b as e,D as T,z as A,V as D,T as O,a as t,C as c,h as i,g as p,a4 as w,a5 as R,c as G,v as M,F as U,m as $,x as q,l as v,p as H,E as J,G as K}from"./index-Cmg5EJpm.js";import{e as Q}from"./mitt-E5P-NQ8u.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as X,a as Y}from"./VContainer-rTUoaqtf.js";import{V as Z}from"./VBreadcrumbs-ATQeAySf.js";import{a as l,V as h}from"./VRow-C0U_Zj0G.js";const C=f=>(J("data-v-a3606a8d"),f=f(),K(),f),ee=C(()=>v("h2",{class:"info"},"活動介紹",-1)),ae={class:"b-1 info pa-4 mb-5"},te=C(()=>v("h3",{class:"info d-sm-none mb-2"},"活動介紹",-1)),se={style:{"white-space":"pre-line"},class:"text-sm-body-1 w-100"},oe={__name:"[id]",props:{isFavorite:Boolean},setup(f){const n=P(),{api:F,apiAuth:k}=H(),y=j(),m=E(),B=x([{title:"首頁",disabled:!1,to:"/"},{title:"活動分享",disabled:!1,to:"/event/findEvent"},{title:"物資詳情",disabled:!0}]),o=x({_id:"",title:"",date:"",address:"",category:"",organizer:"",description:"",image:""}),d=x(f.isFavorite),L=async()=>{var r,u;try{const{data:s}=await F.get("/event/"+y.params.id);Object.assign(o.value,s.result),n.isLogin&&(d.value=await I())}catch(s){console.log(s),m({text:((u=(r=s==null?void 0:s.response)==null?void 0:r.data)==null?void 0:u.message)||"發生錯誤",snackbarProps:{color:"red"}})}},I=async()=>{var r,u;try{const{data:s}=await k.get("/user/mark");return s.some(_=>_._id===y.params.id)}catch(s){return console.log(s),m({text:((u=(r=s==null?void 0:s.response)==null?void 0:r.data)==null?void 0:u.message)||"發生錯誤",snackbarProps:{color:"red"}}),!1}},V=async()=>{if(!n.isLogin){m({text:"請登入後再收藏活動",snackbarProps:{color:"red"}});return}try{const r=await k.post("/user/toggleFavorite",{eventId:o.value._id});d.value=r.data.isFavorite,m({text:r.data.isFavorite?"已收藏":"取消收藏",snackbarProps:{color:r.data.isFavorite?"#F5B4B4":"info"}})}catch(r){console.error("收藏操作失败",r),m({text:"收藏操作失败",snackbarProps:{color:"red"}})}};N(L);const z=()=>{m({text:"請登入後再收藏活動",snackbarProps:{color:"red"}}),Q.emit("open-login-dialog")};return(r,u)=>{const s=S;return g(),b(X,null,{default:a(()=>[e(Z,{items:B.value},{divider:a(()=>[e(T,{icon:"mdi-chevron-right"})]),_:1},8,["items"]),e(h,{"justify-center":"",class:"mt-2 flex-column flex-sm-row"},{default:a(()=>[e(l,{cols:"12",sm:"6",md:"5",lg:"6",class:"w-66 w-sm-100 d-flex justify-center align-start mx-auto",style:{"margin-top":"20px"}},{default:a(()=>[e(A,{src:o.value.image,class:"image",contain:""},null,8,["src"])]),_:1}),e(l,{cols:"12",sm:"6",md:"7",lg:"6"},{default:a(()=>[e(D,{variant:"flat",class:"d-none d-sm-block"},{default:a(()=>[e(O,{class:"card-title",style:{"white-space":"pre-line"}},{default:a(()=>[t("活動名稱："+c(o.value.title),1)]),_:1}),e(Y,{thickness:"0"}),e(i,{class:"card-text"},{default:a(()=>[t("活動時間")]),_:1}),e(i,{class:"card-text"},{default:a(()=>[t(c(o.value.date),1)]),_:1}),e(i,{class:"card-text"},{default:a(()=>[t("活動地點")]),_:1}),e(i,{class:"card-text"},{default:a(()=>[t(c(o.value.address),1)]),_:1}),e(i,{class:"card-text"},{default:a(()=>[t("活動類別")]),_:1}),e(i,{class:"card-text"},{default:a(()=>[t(c(Object.values(o.value.category).join(", ")),1)]),_:1}),e(i,{class:"card-text"},{default:a(()=>[t("主辦單位")]),_:1}),e(i,{class:"card-text"},{default:a(()=>[t(c(o.value.organizer),1)]),_:1}),e(i),e(i),e(i),e(s,{"prepend-icon":p(n).isLogin&&d.value?"mdi-bookmark":"mdi-bookmark-outline",text:p(n).isLogin&&d.value?"已收藏":"我要收藏",class:w(p(n).isLogin?d.value?"me-15":"me-15 bg-info":"me-15 bg-info text-body-3"),style:R(p(n).isLogin&&d.value?{backgroundColor:"#F5B4B4"}:{}),onClick:u[0]||(u[0]=_=>p(n).isLogin?V():z()),width:"125",height:"32",ripple:!1},null,8,["prepend-icon","text","class","style"])]),_:1}),e(h,{class:"pl-4 d-flex d-sm-none"},{default:a(()=>[e(l,{cols:"12",class:"font-weight-black card-title",style:{"white-space":"pre-line"}},{default:a(()=>[t("活動名稱："+c(o.value.title),1)]),_:1}),e(l,{cols:"4",class:"card-text"},{default:a(()=>[t("活動時間")]),_:1}),e(l,{cols:"8",class:"card-text"},{default:a(()=>[t(c(o.value.date),1)]),_:1}),e(l,{cols:"4",class:"card-text"},{default:a(()=>[t("活動地點")]),_:1}),e(l,{cols:"8",class:"card-text"},{default:a(()=>[t(c(o.value.address),1)]),_:1}),e(l,{cols:"4",class:"card-text"},{default:a(()=>[t("活動類別")]),_:1}),(g(!0),G(U,null,M(o.value.category,_=>(g(),b(l,{cols:"8",class:"card-text",key:_},{default:a(()=>[t(c(_),1)]),_:2},1024))),128)),e(l,{cols:"4",class:"card-text"},{default:a(()=>[t("主辦單位")]),_:1}),e(l,{cols:"8",class:"card-text"},{default:a(()=>[t(c(o.value.organizer),1)]),_:1}),e(l,{cols:"12",class:"mt-6",style:{position:"relative"}},{default:a(()=>[p(n).isLogin?(g(),b($,{key:0,color:"medium-emphasis",icon:d.value?"mdi-heart":"mdi-heart-outline",class:w([d.value?"me-5 mb-2 bg-red-lighten-4":"me-5 mb-2 bg-info","bg-transparent xs-btn m-0"]),size:"small",onClick:V,elevation:"0",variant:"text"},null,8,["icon","class"])):q("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),e(h,null,{default:a(()=>[e(l,{cols:"12",class:"d-none d-sm-flex mt-lg-2 py-0"},{default:a(()=>[ee]),_:1}),e(l,{cols:"12"},{default:a(()=>[v("div",ae,[te,v("p",se,c(o.value.description),1)])]),_:1})]),_:1})]),_:1})}}},pe=W(oe,[["__scopeId","data-v-a3606a8d"]]);export{pe as default};
