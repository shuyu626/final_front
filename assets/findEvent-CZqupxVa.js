import{_ as pe}from"./inputText-B4iX14na.js";import{d as ge,i as ve,n as i,O as Ve,s as ye,r as Q,o as m,c as w,g as o,e as k,w as a,m as q,v as be,b as e,x as _e,a6 as H,l as u,F as C,p as xe,a as f,C as J,V as K,T as W,h as he,f as we,k as ke,j as Ce,t as R,a5 as Se,B as S,R as ze,y as Ee,a7 as Ue,D as $e,E as Me}from"./index-DHtY1JWC.js";import{c as Fe,a as b,e as Be,u as Ie,b as g,V as Pe}from"./index.esm-DGcdZjKo.js";import{_ as Te}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as X}from"./VContainer-C_TrXdsS.js";import{V as A,a as d}from"./VRow-CMZZTwoZ.js";import{V as qe}from"./VPagination-U4ao7sw7.js";import{V as Re}from"./VTooltip-FFM3IpKG.js";import{V as Ae,a as Y}from"./VSelect-BkOQt69e.js";import{V as De}from"./VTextarea-Dt6pTNUX.js";import{V as Le}from"./VBreadcrumbs-B2o7kmW6.js";import{V as je,a as Ge}from"./VSlideGroupItem-Bm7fbyMS.js";import{d as Ne}from"./VMenu-YdWd-avy.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./ssrBoot-C_3Sa9ng.js";const v=_=>($e("data-v-4f3f1984"),_=_(),Me(),_),Oe=v(()=>u("label",{class:"form-label"},"活動名稱：",-1)),Qe=v(()=>u("label",{class:"form-label"},"活動地點：",-1)),He=v(()=>u("label",{class:"form-label"},"活動類別：",-1)),Je=v(()=>u("label",{class:"form-label"},"活動時間：",-1)),Ke=v(()=>u("label",{class:"form-label"},"主辦單位：",-1)),We=v(()=>u("label",{class:"form-label"},"活動介紹：",-1)),Xe={class:"mx-auto"},Ye={class:"text-center"},Ze={class:"mx-auto",style:{width:"100%"}},ea={class:"d-flex justify-content-center b-1 mt-2 mb-2 bg-white img-container"},aa={class:"text-center my-5"},Z=12,ta={__name:"findEvent",setup(_){const ee=ge(),{api:ae,apiAuth:te}=xe(),z=ve(),le=i([{title:"首頁",disabled:!1,href:"/"},{title:"活動分享",disabled:!0}]),se=["兒童","青少年","育兒","長照","精神","照顧","就學","就業","身障","親職教育","早療","紓壓","居住","醫療","司法","社工","其他"],oe=i([{name:"兒童",selected:!1},{name:"青少年",selected:!1},{name:"育兒",selected:!1},{name:"長照",selected:!1},{name:"精神",selected:!1},{name:"照顧",selected:!1},{name:"就學",selected:!1},{name:"就業",selected:!1},{name:"身障",selected:!1},{name:"親職教育",selected:!1},{name:"早療",selected:!1},{name:"紓壓",selected:!1},{name:"居住",selected:!1},{name:"醫療",selected:!1},{name:"司法",selected:!1},{name:"社工",selected:!1},{name:"其他",selected:!1}]),E=i(1),D=i(1),L=i(null),V=i(!1),re=s=>{V.value=!0},j=()=>{V.value=!1,N(),L.value.deleteFileRecord()};Ve(()=>{V||N()});const ne=Fe({title:b().required("活動標題必填"),date:b().required("活動日期必填"),address:b().required("活動地點必填"),category:Be().required("活動分類必填"),organizer:b().required("主辦單位必填"),description:b().required("活動介紹必填")}),{handleSubmit:de,isSubmitting:G,resetForm:N}=Ie({validationSchema:ne,initialValues:{title:"",date:"",address:"",category:[],organizer:"",description:""}}),U=g("title"),$=g("date"),M=g("address"),F=g("category"),B=g("organizer"),I=g("description"),p=i([]),O=i([]),ie=de(async s=>{var t,n,c;if(!((t=p.value[0])!=null&&t.error)&&!(p.value.length<1))try{const r=new FormData;r.append("title",s.title),r.append("date",s.date),r.append("address",s.address),r.append("category",s.category),r.append("organizer",s.organizer),r.append("description",s.description),p.value.length>0&&r.append("image",p.value[0].file),console.log(s.category),await te.post("/event",r),z({text:"新增成功",snackbarProps:{color:"green"}}),j(),T()}catch(r){console.log(r),z({text:((c=(n=r==null?void 0:r.response)==null?void 0:n.data)==null?void 0:c.message)||"發生錯誤",snackbarProps:{color:"red"}})}}),x=i([]),ue=s=>{const t=x.value.indexOf(s);t===-1?x.value.push(s):x.value.splice(t,1)},ce=(s,t)=>{ue(s),t()},me=ye(()=>{const s=h.value?h.value.toLowerCase():"";return P.value.filter(t=>{const n=x.value.every(r=>t.category.includes(r)),c=t.title.toLowerCase().includes(s)||t.organizer.toLowerCase().includes(s);return n&&c})}),h=i(""),P=i([]),T=async()=>{var s,t;try{const{data:n}=await ae.get("/event",{params:{itemssPerPage:Z,page:E.value}});D.value=Math.ceil(n.result.total/Z),P.value.splice(0,P.value.length,...n.result.data)}catch(n){console.log(n),z({text:((t=(s=n==null?void 0:n.response)==null?void 0:s.data)==null?void 0:t.message)||"發生錯誤",snackbarProps:{color:"red"}})}};return T(),(s,t)=>{const n=Q("vue-file-agent"),c=pe,r=Q("router-link");return m(),w(C,null,[o(ee).isLogin?(m(),k(q,{key:0,onClick:t[0]||(t[0]=l=>re()),class:"bg-third b-1 p-0",variant:"text",id:"create"},{default:a(()=>[e(J,{size:"x-large"},{default:a(()=>[f("mdi-plus")]),_:1}),e(Re,{activator:"parent",location:"top"},{default:a(()=>[f(" 新增活動 ")]),_:1})]),_:1})):be("",!0),e(_e,{"max-width":"700",modelValue:V.value,"onUpdate:modelValue":t[10]||(t[10]=l=>V.value=l)},{default:a(()=>[e(K,null,{default:a(()=>[e(X,null,{default:a(()=>[e(W,{class:"font-weight-black text-center text-h4"},{default:a(()=>[f("新增活動")]),_:1}),e(he,null,{default:a(()=>[e(Pe,{onSubmit:we(o(ie),["prevent"]),disabled:o(G)},{default:a(()=>[e(A,null,{default:a(()=>[e(d,null,{default:a(()=>[e(n,{modelValue:p.value,"onUpdate:modelValue":t[1]||(t[1]=l=>p.value=l),"raw-model-value":O.value,"onUpdate:rawModelValue":t[2]||(t[2]=l=>O.value=l),accept:"image/jpeg,image/png",deletable:"","max-size":"1MB","help-text":"選擇檔案或拖曳到這裡","error-text":{type:"檔案格式不支援",size:"檔案大小不能超過 1MB"},ref_key:"fileAgent",ref:L},null,8,["modelValue","raw-model-value"])]),_:1})]),_:1}),e(A,null,{default:a(()=>[e(d,{cols:"4",class:"my-auto text-center"},{default:a(()=>[Oe]),_:1}),e(d,{cols:"8"},{default:a(()=>[e(c,{modelValue:o(U).value.value,"onUpdate:modelValue":t[3]||(t[3]=l=>o(U).value.value=l),"error-messages":o(U).errorMessage.value,density:s.$vuetify.display.xs?"compact":"comfortable"},null,8,["modelValue","error-messages","density"])]),_:1}),e(d,{cols:"4",class:"my-auto text-center"},{default:a(()=>[Qe]),_:1}),e(d,{cols:"8"},{default:a(()=>[e(c,{modelValue:o(M).value.value,"onUpdate:modelValue":t[4]||(t[4]=l=>o(M).value.value=l),"error-messages":o(M).errorMessage.value,density:s.$vuetify.display.xs?"compact":"comfortable"},null,8,["modelValue","error-messages","density"])]),_:1}),e(d,{cols:"4",class:"my-auto text-center"},{default:a(()=>[He]),_:1}),e(d,{cols:"8"},{default:a(()=>[e(Ae,{modelValue:o(F).value.value,"onUpdate:modelValue":t[5]||(t[5]=l=>o(F).value.value=l),"error-messages":o(F).errorMessage.value,label:"選擇",variant:"outlined",density:s.$vuetify.display.xs?"compact":"comfortable",dense:"",items:se,"hide-details":"",multiple:""},null,8,["modelValue","error-messages","density"])]),_:1}),e(d,{cols:"4",class:"my-auto text-center px-0"},{default:a(()=>[Je]),_:1}),e(d,{cols:"8"},{default:a(()=>[e(c,{modelValue:o($).value.value,"onUpdate:modelValue":t[6]||(t[6]=l=>o($).value.value=l),"error-messages":o($).errorMessage.value,density:s.$vuetify.display.xs?"compact":"comfortable"},null,8,["modelValue","error-messages","density"])]),_:1}),e(d,{cols:"4",class:"my-auto text-center"},{default:a(()=>[Ke]),_:1}),e(d,{cols:"8"},{default:a(()=>[e(c,{modelValue:o(B).value.value,"onUpdate:modelValue":t[7]||(t[7]=l=>o(B).value.value=l),"error-messages":o(B).errorMessage.value,density:s.$vuetify.display.xs?"compact":"comfortable"},null,8,["modelValue","error-messages","density"])]),_:1}),e(d,{cols:"4",class:"text-center"},{default:a(()=>[We]),_:1}),e(d,{cols:"8"},{default:a(()=>[e(De,{"auto-grow":"",label:"輸入文字",variant:"outlined",clearable:"","hide-details":"",modelValue:o(I).value.value,"onUpdate:modelValue":t[8]||(t[8]=l=>o(I).value.value=l),"error-messages":o(I).errorMessage.value,density:s.$vuetify.display.xs?"compact":"comfortable"},null,8,["modelValue","error-messages","density"])]),_:1})]),_:1}),e(ke,null,{default:a(()=>[u("div",Xe,[e(q,{variant:"text",class:"rounded-xl b-1 bg-accent",density:"comfortable",type:"submit",loading:o(G)},{default:a(()=>[f("送出")]),_:1},8,["loading"]),e(q,{text:"取消",variant:"text",class:"rounded-xl b-1 bg-info",density:"comfortable",onClick:t[9]||(t[9]=l=>j())})])]),_:1})]),_:1},8,["onSubmit","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(X,null,{default:a(()=>[e(Le,{items:le.value},{divider:a(()=>[e(J,{icon:"mdi-chevron-right"})]),_:1},8,["items"])]),_:1}),e(H,{"max-width":"700px",class:"mx-auto"},{default:a(()=>[e(Ce,{variant:"outlined",label:"搜尋","prepend-inner-icon":"mdi-magnify","hide-details":"","single-line":"",density:"comfortable",clearable:"",class:"bg-white mx-5 mt-5 my-5",modelValue:h.value,"onUpdate:modelValue":t[11]||(t[11]=l=>h.value=l)},null,8,["modelValue"])]),_:1}),u("div",Ye,[e(H,{"max-width":"900",class:"mx-auto"},{default:a(()=>[e(je,{class:"w-100 mx-auto d-inline-block"},{default:a(()=>[e(Ne,{"show-arrows":"",multiple:"","mobile-breakpoint":"xxl"},{default:a(()=>[(m(!0),w(C,null,R(oe.value,l=>(m(),k(Ge,{key:l.name},{default:a(({isSelected:y,toggle:fe})=>[e(Y,{style:Se({backgroundColor:y?"#616161":"#EEEEEE",color:y?"white":"black"}),class:"ma-2",onClick:()=>ce(l.name,fe)},{default:a(()=>[f(S(l.name),1)]),_:2},1032,["style","onClick"])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),u("div",Ze,[e(A,{class:"my-3 d-flex"},{default:a(()=>[(m(!0),w(C,null,R(me.value,l=>(m(),k(d,{cols:"12",sm:"6",md:"4",lg:"3",key:l._id,class:"mx-0"},{default:a(()=>[e(r,{to:"/event/"+l._id,style:{"text-decoration":"none"}},{default:a(()=>[e(K,{variant:"flat",color:"third",class:"b-1 card-size"},{default:a(()=>[e(ze,{class:"p-5 text-left"},{default:a(()=>[u("div",ea,[e(Ee,{src:l.image,contain:""},null,8,["src"])]),e(W,{class:"font-weight-black",style:{"font-size":"1.1rem"}},{default:a(()=>[f(S(l.title),1)]),_:2},1024),e(Ue,{style:{width:"200px"},class:"font-weight-black"},{default:a(()=>[f(S(l.organizer),1)]),_:2},1024),(m(!0),w(C,null,R(l.category,y=>(m(),k(Y,{density:"compact",class:"mt-2 me-1",key:y},{default:a(()=>[f(S(y),1)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),_:2},1032,["to"])]),_:2},1024))),128))]),_:1})])]),u("div",aa,[e(qe,{modelValue:E.value,"onUpdate:modelValue":[t[12]||(t[12]=l=>E.value=l),T],length:D.value,rounded:"circle"},null,8,["modelValue","length"])])],64)}}},ya=Te(ta,[["__scopeId","data-v-4f3f1984"]]);export{ya as default};
