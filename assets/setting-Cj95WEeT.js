import{i as pe,n,O as Ae,r as re,o as $,c as D,b as e,w as t,S as xe,y as be,l as u,B as P,a as E,m as ee,V as ce,T as _e,h as Pe,f as Ue,g as s,k as Fe,x as Te,F as W,p as ge,u as Ze,e as ie,t as te,j as Re,at as Ie,D as Je,E as Qe,R as Xe,P as et,C as qe,as as tt,v as lt}from"./index-Db1RanFM.js";import{c as Se,a as T,u as Ce,b as M,V as Me,f as je,e as ve}from"./index.esm-BZo-TVKa.js";import{_ as Be}from"./inputText-CrJrM96A.js";import{_ as $e}from"./search-CaegUs1-.js";import{V as Ve}from"./VDataTableServer-hnHmGxv9.js";import{V as ke,a as se}from"./VContainer-x3tBBA8o.js";import{a as N,V as o}from"./VRow-BkjsVxfT.js";import{V as De,b as fe,a as ye}from"./VSelect-DQDN7R8t.js";import{V as Ke}from"./VTextarea-B2JHA_gm.js";import{_ as at}from"./appButton-r9NSDq2t.js";import{_ as He}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as Oe,a as Ne}from"./VToolbar-Bp6C_jrw.js";import{_ as st}from"./submitButton-DUtRF-6d.js";import{V as ot,a as nt,c as rt}from"./leaflet-src-4fXiixLd.js";import{a as dt,b as we,c as ut,V as he}from"./VTabs-B93K1yZC.js";import{V as it}from"./VNavigationDrawer-UelwTQ2l.js";import{V as ze}from"./VBreadcrumbs-DfgL4WQm.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./VPagination-sZG7QaYo.js";import"./VMenu-B0269wpg.js";import"./ssrBoot-D78cn5l7.js";const ct=u("h2",{class:"my-5 bg-accent text-center w-75 mx-auto"},"活動管理",-1),mt={style:{width:"220px"}},pt={style:{width:"500px","white-space":"pre-line"},class:"py-2"},gt={style:{width:"80px"}},vt=u("label",{class:"form-label"},"活動名稱：",-1),ft=u("label",{class:"form-label"},"活動地點：",-1),yt=u("label",{class:"form-label"},"活動類別：",-1),bt=u("label",{class:"form-label"},"活動時間：",-1),xt=u("label",{class:"form-label"},"主辦單位：",-1),_t=u("label",{class:"form-label"},"活動介紹：",-1),Vt={class:"mx-auto"},kt={__name:"eventTable",setup(Y){const{api:me,apiAuth:B}=ge(),_=pe(),G=n(null),U=n([]),k=n([]),w=n(10),I=n([{key:"createdAt",order:"desc"}]),q=n(1),S=n([]),z=[{title:"圖片",align:"center",sortable:!1,key:"image"},{title:"活動名稱",align:"center",sortable:!1,key:"title"},{title:"活動地點",align:"center",sortable:!1,key:"address"},{title:"活動類別",align:"center",sortable:!0,key:"category"},{title:"活動時間",align:"center",sortable:!0,key:"date"},{title:"主辦單位",align:"center",sortable:!1,key:"organizer"},{title:"活動介紹",align:"center",sortable:!1,key:"description"},{title:"操作",align:"center",sortable:!1,key:"action"}],A=n(!0),m=n(0),y=n(""),c=async d=>{var l,V,v,i;d&&(q.value=1),A.value=!0;try{const{data:x}=await B.get("/user/event",{params:{page:q.value,itemsPerPage:w.value,sortBy:((l=I.value[0])==null?void 0:l.key)||"createdAt",sortOrder:((V=I.value[0])==null?void 0:V.order)||"desc",search:y.value}});S.value.splice(0,S.value.length,...x.result.data),m.value=x.result.total}catch(x){console.log(x),_({text:((i=(v=x==null?void 0:x.response)==null?void 0:v.data)==null?void 0:i.message)||"發生錯誤",snackbarProps:{color:"red"}})}A.value=!1};c();const g=["兒童","青少年","育兒","長照","精神","照顧","就學","就業","身障","親職教育","早療","紓壓","居住","醫療","司法","社工","其他"],b=n({open:!1,id:""}),h=d=>{b.value.open=!0,b.value.id=d._id,K.value.value=d.title,f.value.value=d.date,C.value.value=d.address,O.value.value=d.category,J.value.value=d.organizer,Q.value.value=d.description},H=()=>{b.value.open=!1,R(),G.value.deleteFileRecord()},le=Se({title:T().required("活動標題必填"),date:T().required("活動日期必填"),address:T().required("活動地點必填"),category:T().required("活動分類必填").test("isCategory","商品分類錯誤",d=>g.includes(d)),organizer:T().required("主辦單位必填"),description:T().required("活動介紹必填")}),{handleSubmit:F,isSubmitting:L,resetForm:R}=Ce({validationSchema:le,initialValues:{title:"",date:"",address:"",category:"",organizer:"",description:""}}),K=M("title"),f=M("date"),C=M("address"),O=M("category"),J=M("organizer"),Q=M("description"),de=F(async d=>{var l,V,v;if(!((l=U.value[0])!=null&&l.error)&&!(U.value.length<1))try{const i=new FormData;i.append("title",d.title),i.append("date",d.date),i.append("address",d.address),i.append("category",d.category),i.append("organizer",d.organizer),i.append("description",d.description),U.value.length>0&&i.append("image",U.value[0].file),await B.patch("/event/"+b.value.id,i),_({text:"新增成功",snackbarProps:{color:"green"}}),H(),c()}catch(i){console.log(i),_({text:((v=(V=i==null?void 0:i.response)==null?void 0:V.data)==null?void 0:v.message)||"發生錯誤",snackbarProps:{color:"red"}})}});Ae(y,()=>{c(!0)});const ue=async d=>{var l,V;try{await B.delete(`/event/${d._id}`),_({text:"刪除成功",snackbarProps:{color:"green"}}),c(!0)}catch(v){console.log(v),_({text:((V=(l=v==null?void 0:v.response)==null?void 0:l.data)==null?void 0:V.message)||"發生錯誤",snackbarProps:{color:"red"}})}};return(d,l)=>{const V=$e,v=re("router-link"),i=re("vue-file-agent"),x=Be;return $(),D(W,null,[ct,e(Ve,{"items-per-page":w.value,"onUpdate:itemsPerPage":[l[3]||(l[3]=a=>w.value=a),l[6]||(l[6]=a=>c(!1))],"sort-by":I.value,"onUpdate:sortBy":[l[4]||(l[4]=a=>I.value=a),l[7]||(l[7]=a=>c(!1))],page:q.value,"onUpdate:page":[l[5]||(l[5]=a=>q.value=a),l[8]||(l[8]=a=>c(!1))],items:S.value,headers:z,loading:A.value,"items-length":m.value,search:y.value,hover:"",class:"w-75 mx-auto b-1 rounded-lg mb-15 px-8"},{top:t(()=>[e(V,{modelValue:y.value,"onUpdate:modelValue":l[0]||(l[0]=a=>y.value=a),onClickAppend:l[1]||(l[1]=a=>c(!0)),onKeydown:l[2]||(l[2]=xe(a=>c(!0),["enter"])),"max-width":"100%",class:"my-5"},null,8,["modelValue"])]),"item.image":t(({item:a})=>[e(v,{to:"/event/"+a._id,style:{"text-decoration":"none"}},{default:t(()=>[e(be,{src:a.image,width:"100px","max-height":"140px",class:"my-5"},null,8,["src"])]),_:2},1032,["to"])]),"item.address":t(({item:a})=>[u("td",mt,P(a.address),1)]),"item.category":t(({item:a})=>[u("td",null,P(a.category.join(" , ")),1)]),"item.description":t(({item:a})=>[u("td",pt,P(a.description),1)]),"item.action":t(({item:a})=>[u("td",gt,[E(P(a.action)+" ",1),e(ee,{icon:"mdi-pencil",variant:"text",color:"blue-grey-darken-1",onClick:oe=>h(a)},null,8,["onClick"]),e(ee,{icon:"mdi-delete",variant:"text",color:"red-darken-4",onClick:oe=>ue(a)},null,8,["onClick"])])]),_:2},1032,["items-per-page","sort-by","page","items","loading","items-length","search"]),e(Te,{"max-width":"700",modelValue:b.value.open,"onUpdate:modelValue":l[18]||(l[18]=a=>b.value.open=a)},{default:t(()=>[e(ce,null,{default:t(()=>[e(ke,null,{default:t(()=>[e(_e,{class:"font-weight-black text-center text-h4"},{default:t(()=>[E("新增活動")]),_:1}),e(Pe,null,{default:t(()=>[e(Me,{onSubmit:Ue(s(de),["prevent"]),disabled:s(L)},{default:t(()=>[e(N,null,{default:t(()=>[e(o,null,{default:t(()=>[e(i,{modelValue:U.value,"onUpdate:modelValue":l[9]||(l[9]=a=>U.value=a),"raw-model-value":k.value,"onUpdate:rawModelValue":l[10]||(l[10]=a=>k.value=a),accept:"image/jpeg,image/png",deletable:"","max-size":"1MB","help-text":"選擇檔案或拖曳到這裡","error-text":{type:"檔案格式不支援",size:"檔案大小不能超過 1MB"},ref_key:"fileAgent",ref:G},null,8,["modelValue","raw-model-value"])]),_:1})]),_:1}),e(N,null,{default:t(()=>[e(o,{cols:"12",md:"3",class:"my-auto text-center"},{default:t(()=>[vt]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(x,{modelValue:s(K).value.value,"onUpdate:modelValue":l[11]||(l[11]=a=>s(K).value.value=a),"error-messages":s(K).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-center"},{default:t(()=>[ft]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(x,{modelValue:s(C).value.value,"onUpdate:modelValue":l[12]||(l[12]=a=>s(C).value.value=a),"error-messages":s(C).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-center"},{default:t(()=>[yt]),_:1}),e(o,{cols:"12",md:"3"},{default:t(()=>[e(De,{modelValue:s(O).value.value,"onUpdate:modelValue":l[13]||(l[13]=a=>s(O).value.value=a),"error-messages":s(O).errorMessage.value,label:"選擇",variant:"outlined",density:"comfortable",dense:"",width:"140",items:g,"hide-details":""},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"3",class:"my-auto text-center px-0"},{default:t(()=>[bt]),_:1}),e(o,{cols:"3"},{default:t(()=>[e(x,{modelValue:s(f).value.value,"onUpdate:modelValue":l[14]||(l[14]=a=>s(f).value.value=a),"error-messages":s(f).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-center"},{default:t(()=>[xt]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(x,{modelValue:s(J).value.value,"onUpdate:modelValue":l[15]||(l[15]=a=>s(J).value.value=a),"error-messages":s(J).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"text-center"},{default:t(()=>[_t]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(Ke,{label:"輸入文字",variant:"outlined",clearable:"","hide-details":"",modelValue:s(Q).value.value,"onUpdate:modelValue":l[16]||(l[16]=a=>s(Q).value.value=a),"error-messages":s(Q).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(Fe,null,{default:t(()=>[u("div",Vt,[e(ee,{variant:"text",class:"rounded-xl b-1",density:"comfortable",type:"submit",loading:s(L)},{default:t(()=>[E("送出")]),_:1},8,["loading"]),e(ee,{text:"取消",variant:"text",class:"rounded-xl b-1",density:"comfortable",onClick:l[17]||(l[17]=a=>H())})])]),_:1})]),_:1},8,["onSubmit","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}},wt=u("h2",{class:"my-5 bg-accent text-center w-75 mx-auto"},"我要分享",-1),ht={style:{width:"250px","white-space":"pre-line"},class:"py-2"},$t={style:{width:"80px"}},Pt=u("label",{class:"form-label"},"物資名稱",-1),Ut={class:"form-label"},St=u("label",{class:"form-label"},"物資類別",-1),Ct={class:"form-label"},Mt=u("label",{class:"form-label"},"單位名稱",-1),qt={class:"mx-auto"},zt={__name:"shareTable",props:{cardTitle:{type:String,default:"發布需求"},numberTitle:{type:String,default:"需求量"},descriptionTitle:{type:String,default:"需求介紹"},type:{type:String,default:"share"}},setup(Y){const{api:me,apiAuth:B}=ge(),_=pe(),G=Y,U=n(null),k=n([]),w=n([]),I=n(8),q=n([{key:"createdAt",order:"desc"}]),S=n(1),z=n([]),A=[{title:"圖片",align:"center",sortable:!1,key:"image"},{title:"名稱",align:"center",sortable:!1,key:"name"},{title:"數量",align:"center",sortable:!1,key:"quantity"},{title:"分類",align:"center",sortable:!0,key:"category"},{title:"概況",align:"center",sortable:!1,key:"description"},{title:"單位",align:"center",sortable:!1,key:"organizer"},{title:"操作",align:"center",sortable:!1,key:"action"}],m=n(!0),y=n(0),c=n(""),g=async d=>{var l,V,v,i;d&&(S.value=1),m.value=!0;try{const{data:x}=await B.get("/user/share",{params:{page:S.value,itemsPerPage:I.value,sortBy:((l=q.value[0])==null?void 0:l.key)||"createdAt",sortOrder:((V=q.value[0])==null?void 0:V.order)||"desc",search:c.value}});console.log(x),z.value.splice(0,z.value.length,...x.result.data),y.value=x.result.total}catch(x){console.log(x),_({text:((i=(v=x==null?void 0:x.response)==null?void 0:v.data)==null?void 0:i.message)||"發生錯誤",snackbarProps:{color:"red"}})}m.value=!1};g();const b=["食品","服飾配件","日用品","家具","輔具","教育用品","嬰幼兒用品","電器","休閒用品","其他"],h=n({open:!1,id:""}),H=d=>{h.value.open=!0,h.value.id=d._id,f.value.value=d.name,C.value.value=d.quantity,O.value.value=d.category,J.value.value=d.description,Q.value.value=d.organizer},le=()=>{h.value.open=!1,K(),U.value.deleteFileRecord()},F=Se({name:T().required("物品名稱必填"),quantity:je().min(1,"物品數量不符").required("物品數量必填"),category:T().required("物品分類必填").test("isCategory","商品分類錯誤",d=>b.includes(d)),description:T().required("物資介紹必填"),organizer:T().required("單位名稱必填")}),{handleSubmit:L,isSubmitting:R,resetForm:K}=Ce({validationSchema:F,initialValues:{name:"",quantity:"0",category:"",description:"",organizer:""}}),f=M("name"),C=M("quantity"),O=M("category"),J=M("description"),Q=M("organizer"),de=L(async d=>{var l,V,v;if(!((l=k.value[0])!=null&&l.error)&&!(k.value.length<1))try{const i=new FormData;i.append("name",d.name),i.append("quantity",d.quantity),i.append("category",d.category),i.append("description",d.description),i.append("organizer",d.organizer),i.append("type",G.type),k.value.length>0&&i.append("image",k.value[0].file),console.log(i),await B.patch("/material/"+h.value.id,i),_({text:"新增成功",snackbarProps:{color:"green"}}),le(),g()}catch(i){console.log(i),_({text:((v=(V=i==null?void 0:i.response)==null?void 0:V.data)==null?void 0:v.message)||"發生錯誤",snackbarProps:{color:"red"}})}});Ae(c,()=>{g(!0)});const ue=async d=>{var l,V;try{await B.delete(`/Material/${d._id}`),_({text:"刪除成功",snackbarProps:{color:"green"}}),g(!0)}catch(v){console.log(v),_({text:((V=(l=v==null?void 0:v.response)==null?void 0:l.data)==null?void 0:V.message)||"發生錯誤",snackbarProps:{color:"red"}})}};return(d,l)=>{const V=$e,v=re("router-link"),i=re("vue-file-agent"),x=Be;return $(),D(W,null,[wt,e(Ve,{"items-per-page":I.value,"onUpdate:itemsPerPage":[l[3]||(l[3]=a=>I.value=a),l[6]||(l[6]=a=>g(!1))],"sort-by":q.value,"onUpdate:sortBy":[l[4]||(l[4]=a=>q.value=a),l[7]||(l[7]=a=>g(!1))],page:S.value,"onUpdate:page":[l[5]||(l[5]=a=>S.value=a),l[8]||(l[8]=a=>g(!1))],items:z.value,headers:A,loading:m.value,"items-length":y.value,search:c.value,hover:"",class:"w-75 mx-auto b-1 rounded-lg mb-15 px-8 text-body-1"},{top:t(()=>[e(V,{class:"my-5",modelValue:c.value,"onUpdate:modelValue":l[0]||(l[0]=a=>c.value=a),onClickAppend:l[1]||(l[1]=a=>g(!0)),onKeydown:l[2]||(l[2]=xe(a=>g(!0),["enter"])),"max-width":"100%"},null,8,["modelValue"])]),"item.image":t(({item:a})=>[e(v,{to:"/material/share/"+a._id,style:{"text-decoration":"none"}},{default:t(()=>[e(be,{src:a.image,width:"80px","max-height":"100px"},null,8,["src"])]),_:2},1032,["to"])]),"item.description":t(({item:a})=>[u("td",ht,P(a.description),1)]),"item.action":t(({item:a})=>[u("td",$t,[E(P(a.action)+" ",1),e(ee,{icon:"mdi-pencil",variant:"text",color:"blue-grey-darken-1",onClick:oe=>H(a)},null,8,["onClick"]),e(ee,{icon:"mdi-delete",variant:"text",color:"red-darken-4",onClick:oe=>ue(a)},null,8,["onClick"])])]),_:2},1032,["items-per-page","sort-by","page","items","loading","items-length","search"]),e(Te,{"max-width":"600",modelValue:h.value.open,"onUpdate:modelValue":l[17]||(l[17]=a=>h.value.open=a)},{default:t(()=>[e(ce,null,{default:t(()=>[e(ke,null,{default:t(()=>[e(_e,{class:"font-weight-black text-center text-h4"},{default:t(()=>[E(P(Y.cardTitle),1)]),_:1}),e(Pe,null,{default:t(()=>[e(Me,{onSubmit:Ue(s(de),["prevent"]),disabled:s(R)},{default:t(()=>[e(N,null,{default:t(()=>[e(o,null,{default:t(()=>[e(i,{modelValue:k.value,"onUpdate:modelValue":l[9]||(l[9]=a=>k.value=a),"raw-model-value":w.value,"onUpdate:rawModelValue":l[10]||(l[10]=a=>w.value=a),accept:"image/jpeg,image/png",deletable:"","max-size":"1MB","help-text":"選擇檔案或拖曳到這裡","error-text":{type:"檔案格式不支援",size:"檔案大小不能超過 1MB"},ref_key:"fileAgent",ref:U},null,8,["modelValue","raw-model-value"])]),_:1})]),_:1}),e(N,null,{default:t(()=>[e(o,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:t(()=>[Pt]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(x,{modelValue:s(f).value.value,"onUpdate:modelValue":l[11]||(l[11]=a=>s(f).value.value=a),"error-messages":s(f).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:t(()=>[u("label",Ut,P(Y.numberTitle),1)]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(x,{modelValue:s(C).value.value,"onUpdate:modelValue":l[12]||(l[12]=a=>s(C).value.value=a),"error-messages":s(C).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:t(()=>[St]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(De,{modelValue:s(O).value.value,"onUpdate:modelValue":l[13]||(l[13]=a=>s(O).value.value=a),"error-messages":s(O).errorMessage.value,label:"選擇",variant:"outlined",density:"comfortable",dense:"",items:b,"hide-details":""},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:t(()=>[u("label",Ct,P(Y.descriptionTitle),1)]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(x,{modelValue:s(J).value.value,"onUpdate:modelValue":l[14]||(l[14]=a=>s(J).value.value=a),"error-messages":s(J).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:t(()=>[Mt]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(x,{modelValue:s(Q).value.value,"onUpdate:modelValue":l[15]||(l[15]=a=>s(Q).value.value=a),"error-messages":s(Q).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(Fe,null,{default:t(()=>[u("div",qt,[e(ee,{variant:"text",class:"rounded-xl b-1",density:"comfortable",type:"submit",loading:s(R)},{default:t(()=>[E("送出")]),_:1},8,["loading"]),e(ee,{text:"取消",variant:"text",class:"rounded-xl b-1",density:"comfortable",onClick:l[16]||(l[16]=a=>le())})])]),_:1})]),_:1},8,["onSubmit","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}},At=u("h2",{class:"my-5 bg-accent text-center w-75 mx-auto"},"我要募資",-1),Tt={style:{width:"250px","white-space":"pre-line"},class:"py-2"},Bt={style:{width:"80px"}},It=u("label",{class:"form-label"},"物資名稱",-1),Ft={class:"form-label"},Dt=u("label",{class:"form-label"},"物資類別",-1),Et={class:"form-label"},Lt=u("label",{class:"form-label"},"單位名稱",-1),Rt={class:"mx-auto"},jt={__name:"findTable",props:{cardTitle:{type:String,default:"發布需求"},numberTitle:{type:String,default:"需求量"},descriptionTitle:{type:String,default:"需求介紹"},type:{type:String,default:"share"}},setup(Y){const{api:me,apiAuth:B}=ge(),_=pe(),G=Y,U=n(null),k=n([]),w=n([]),I=n(8),q=n([{key:"createdAt",order:"desc"}]),S=n(1),z=n([]),A=[{title:"圖片",align:"center",sortable:!1,key:"image"},{title:"名稱",align:"center",sortable:!1,key:"name"},{title:"數量",align:"center",sortable:!1,key:"quantity"},{title:"分類",align:"center",sortable:!0,key:"category"},{title:"概況",align:"center",sortable:!1,key:"description"},{title:"單位",align:"center",sortable:!1,key:"organizer"},{title:"操作",align:"center",sortable:!1,key:"action"}],m=n(!0),y=n(0),c=n(""),g=async d=>{var l,V,v,i;d&&(S.value=1),m.value=!0;try{const{data:x}=await B.get("/user/find",{params:{page:S.value,itemsPerPage:I.value,sortBy:((l=q.value[0])==null?void 0:l.key)||"createdAt",sortOrder:((V=q.value[0])==null?void 0:V.order)||"desc",search:c.value}});z.value.splice(0,z.value.length,...x.result.data),y.value=x.result.total}catch(x){console.log(x),_({text:((i=(v=x==null?void 0:x.response)==null?void 0:v.data)==null?void 0:i.message)||"發生錯誤",snackbarProps:{color:"red"}})}m.value=!1};g();const b=["食品","服飾配件","日用品","家具","輔具","教育用品","嬰幼兒用品","電器","休閒用品","其他"],h=n({open:!1,id:""}),H=d=>{h.value.open=!0,h.value.id=d._id,f.value.value=d.name,C.value.value=d.quantity,O.value.value=d.category,J.value.value=d.description,Q.value.value=d.organizer},le=()=>{h.value.open=!1,K(),U.value.deleteFileRecord()},F=Se({name:T().required("物品名稱必填"),quantity:je().min(1,"物品數量不符").required("物品數量必填"),category:T().required("物品分類必填").test("isCategory","商品分類錯誤",d=>b.includes(d)),description:T().required("物資介紹必填"),organizer:T().required("單位名稱必填")}),{handleSubmit:L,isSubmitting:R,resetForm:K}=Ce({validationSchema:F,initialValues:{name:"",quantity:"0",category:"",description:"",organizer:""}}),f=M("name"),C=M("quantity"),O=M("category"),J=M("description"),Q=M("organizer"),de=L(async d=>{var l,V,v;if(!((l=k.value[0])!=null&&l.error)&&!(k.value.length<1))try{const i=new FormData;i.append("name",d.name),i.append("quantity",d.quantity),i.append("category",d.category),i.append("description",d.description),i.append("organizer",d.organizer),i.append("type",G.type),k.value.length>0&&i.append("image",k.value[0].file),console.log(i),await B.patch("/material/"+h.value.id,i),_({text:"新增成功",snackbarProps:{color:"green"}}),g(),le()}catch(i){console.log(i),_({text:((v=(V=i==null?void 0:i.response)==null?void 0:V.data)==null?void 0:v.message)||"發生錯誤",snackbarProps:{color:"red"}})}});Ae(c,()=>{g(!0)});const ue=async d=>{var l,V;try{await B.delete(`/Material/${d._id}`),_({text:"刪除成功",snackbarProps:{color:"green"}}),g(!0)}catch(v){console.log(v),_({text:((V=(l=v==null?void 0:v.response)==null?void 0:l.data)==null?void 0:V.message)||"發生錯誤",snackbarProps:{color:"red"}})}};return(d,l)=>{const V=$e,v=re("router-link"),i=re("vue-file-agent"),x=Be;return $(),D(W,null,[At,e(Ve,{"items-per-page":I.value,"onUpdate:itemsPerPage":[l[3]||(l[3]=a=>I.value=a),l[6]||(l[6]=a=>g(!1))],"sort-by":q.value,"onUpdate:sortBy":[l[4]||(l[4]=a=>q.value=a),l[7]||(l[7]=a=>g(!1))],page:S.value,"onUpdate:page":[l[5]||(l[5]=a=>S.value=a),l[8]||(l[8]=a=>g(!1))],items:z.value,headers:A,loading:m.value,"items-length":y.value,search:c.value,hover:"",class:"w-75 mx-auto b-1 rounded-lg mb-15 px-8 text-body-1"},{top:t(()=>[e(V,{modelValue:c.value,"onUpdate:modelValue":l[0]||(l[0]=a=>c.value=a),onClickAppend:l[1]||(l[1]=a=>g(!0)),onKeydown:l[2]||(l[2]=xe(a=>g(!0),["enter"])),"max-width":"100%",class:"my-5"},null,8,["modelValue"])]),"item.image":t(({item:a})=>[e(v,{to:"/material/find/"+a._id,style:{"text-decoration":"none"}},{default:t(()=>[e(be,{src:a.image,width:"80px","max-height":"100px"},null,8,["src"])]),_:2},1032,["to"])]),"item.description":t(({item:a})=>[u("td",Tt,P(a.description),1)]),"item.action":t(({item:a})=>[u("td",Bt,[E(P(a.action)+" ",1),e(ee,{icon:"mdi-pencil",variant:"text",color:"blue-grey-darken-1",onClick:oe=>H(a)},null,8,["onClick"]),e(ee,{icon:"mdi-delete",variant:"text",color:"red-darken-4",onClick:oe=>ue(a)},null,8,["onClick"])])]),_:2},1032,["items-per-page","sort-by","page","items","loading","items-length","search"]),e(Te,{"max-width":"600",modelValue:h.value.open,"onUpdate:modelValue":l[17]||(l[17]=a=>h.value.open=a)},{default:t(()=>[e(ce,null,{default:t(()=>[e(ke,null,{default:t(()=>[e(_e,{class:"font-weight-black text-center text-h4"},{default:t(()=>[E(P(Y.cardTitle),1)]),_:1}),e(Pe,null,{default:t(()=>[e(Me,{onSubmit:Ue(s(de),["prevent"]),disabled:s(R)},{default:t(()=>[e(N,null,{default:t(()=>[e(o,null,{default:t(()=>[e(i,{modelValue:k.value,"onUpdate:modelValue":l[9]||(l[9]=a=>k.value=a),"raw-model-value":w.value,"onUpdate:rawModelValue":l[10]||(l[10]=a=>w.value=a),accept:"image/jpeg,image/png",deletable:"","max-size":"1MB","help-text":"選擇檔案或拖曳到這裡","error-text":{type:"檔案格式不支援",size:"檔案大小不能超過 1MB"},ref_key:"fileAgent",ref:U},null,8,["modelValue","raw-model-value"])]),_:1})]),_:1}),e(N,null,{default:t(()=>[e(o,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:t(()=>[It]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(x,{modelValue:s(f).value.value,"onUpdate:modelValue":l[11]||(l[11]=a=>s(f).value.value=a),"error-messages":s(f).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:t(()=>[u("label",Ft,P(Y.numberTitle),1)]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(x,{modelValue:s(C).value.value,"onUpdate:modelValue":l[12]||(l[12]=a=>s(C).value.value=a),"error-messages":s(C).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:t(()=>[Dt]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(De,{modelValue:s(O).value.value,"onUpdate:modelValue":l[13]||(l[13]=a=>s(O).value.value=a),"error-messages":s(O).errorMessage.value,label:"選擇",variant:"outlined",density:"comfortable",dense:"",items:b,"hide-details":""},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:t(()=>[u("label",Et,P(Y.descriptionTitle),1)]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(x,{modelValue:s(J).value.value,"onUpdate:modelValue":l[14]||(l[14]=a=>s(J).value.value=a),"error-messages":s(J).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-left ps-6"},{default:t(()=>[Lt]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(x,{modelValue:s(Q).value.value,"onUpdate:modelValue":l[15]||(l[15]=a=>s(Q).value.value=a),"error-messages":s(Q).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(Fe,null,{default:t(()=>[u("div",Rt,[e(ee,{variant:"text",class:"rounded-xl b-1",density:"comfortable",type:"submit",loading:s(R)},{default:t(()=>[E("送出")]),_:1},8,["loading"]),e(ee,{text:"取消",variant:"text",class:"rounded-xl b-1",density:"comfortable",onClick:l[16]||(l[16]=a=>le())})])]),_:1})]),_:1},8,["onSubmit","disabled"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}},Kt=Y=>(Je("data-v-68768f11"),Y=Y(),Qe(),Y),Ht={id:"profile",class:"b-1 w-50 text-center mx-auto rounded-lg"},Ot={id:"img",style:{width:"160px",height:"160px"},class:"rounded-circle d-flex justify-center align-center bg-grey-lighten-5 mx-auto my-5 b-1"},Nt=Kt(()=>u("div",{id:"upload"},"編輯",-1)),Wt={key:0,style:{"font-size":"18px"},class:"text-h5"},Gt={style:{"font-size":"18px"},class:"text-h5"},Yt={key:0,style:{"font-size":"18px"},class:"text-h5"},Zt={__name:"accountTable",setup(Y){const me=Ze(),{apiAuth:B}=ge(),_=pe(),G=n(null),U=n([]),k=n([]),w=n([]);(async()=>{var F,L;try{const{data:R}=await B.get("/user/profile");w.value=[R.result],w.value[0].password="********",w.value[0].newUsername=w.value[0].username,w.value[0].newPassword="",console.log(w.value)}catch(R){_({text:((L=(F=R==null?void 0:R.response)==null?void 0:F.data)==null?void 0:L.message)||"發生錯誤",snackbarProps:{color:"red"}})}})();const q=Se({newUsername:T().min(3,"服務單位長度不符").max(20,"服務單位長度不符"),newPassword:T().min(6,"使用者密碼長度不符").max(20,"使用者密碼長度不符")}),{handleSubmit:S,isSubmitting:z}=Ce({validationSchema:q}),{value:A,errorMessage:m}=M("newUsername"),{value:y,errorMessage:c}=M("newPassword"),g=S(async()=>{var F,L;try{const R=w.value[0],K=new FormData;A.value&&A.value!==R.username&&K.append("username",A.value),y.value&&y.value!==""&&K.append("password",y.value),U.value.length!==0&&K.append("image",U.value[0].file);for(let[C,O]of K.entries())console.log(`${C}:`,O);if(K.get("username")===null&&K.get("password")===null&&K.get("image")===null){_({text:"沒有任何變更",snackbarProps:{color:"accent"}});return}console.log(K);const f=await B.patch("/user/change",K);f.data.success?(_({text:"資料修改成功",snackbarProps:{color:"green"}}),me.push("/")):_({text:f.data.message||"發生錯誤",snackbarProps:{color:"red"}})}catch(R){_({text:((L=(F=R==null?void 0:R.response)==null?void 0:F.data)==null?void 0:L.message)||"發生錯誤",snackbarProps:{color:"red"}})}}),b=F=>{F.isEditing=!F.isEditing},h=F=>{F.isEditing=!1},H=F=>{F.passwordisEditing=!F.passwordisEditing},le=F=>{F.passwordisEditing=!1};return(F,L)=>{const R=re("vue-file-agent"),K=at;return $(),ie(ce,{flat:""},{default:t(()=>[e(Me,{onSubmit:Ue(s(g),["prevent"]),disabled:s(z)},{default:t(()=>[e(Pe,null,{default:t(()=>[u("div",Ht,[e(Oe,{color:"info",class:"mb-10 rounded-t-lg bb-1",prominent:""},{default:t(()=>[e(Ne,{class:"ms-0 font-weight-bold",style:{"font-size":"23px"}},{default:t(()=>[E("基本資料")]),_:1})]),_:1}),e(R,{id:"account",class:"d-flex justify-center mb-5",accept:"image/jpeg,image/png",deletable:"","max-size":"1MB","help-text":"上傳大頭照","error-text":{type:"檔案格式不支援",size:"檔案大小不能超過 1MB"},modelValue:U.value,"onUpdate:modelValue":L[0]||(L[0]=f=>U.value=f),"raw-model-value":k.value,"onUpdate:rawModelValue":L[1]||(L[1]=f=>k.value=f),ref_key:"fileAgent",ref:G},null,8,["modelValue","raw-model-value"]),($(!0),D(W,null,te(w.value,f=>($(),D(W,{key:f.id},[u("div",Ot,[e(be,{src:f.avatar,cover:""},null,8,["src"])]),Nt],64))),128)),e(ke,null,{default:t(()=>[e(N,{class:"mb-5 px-15 text-left"},{default:t(()=>[e(o,{md:"2"}),e(o,{cols:"12",md:"3",class:"my-auto form-label text-h5",style:{"font-size":"18px"}},{default:t(()=>[E("服務單位")]),_:1}),($(!0),D(W,null,te(w.value,f=>($(),D(W,{key:f.id},[e(o,{cols:"12",md:"4",class:"my-auto"},{default:t(()=>[f.isEditing?($(),ie(Re,{key:1,class:"form-label",style:{"font-size":"18px"},variant:"outlined","single-line":"",density:"comfortable",clearable:"",dense:"",modelValue:s(A),"onUpdate:modelValue":L[2]||(L[2]=C=>Ie(A)?A.value=C:null),"error-messages":s(m),onKeydown:xe(C=>h(f),["enter"])},null,8,["modelValue","error-messages","onKeydown"])):($(),D("p",Wt,P(f.username),1))]),_:2},1024),e(o,{md:"3",class:"ps-10"},{default:t(()=>[e(ee,{onClick:C=>b(f),icon:"mdi-pencil",variant:"text",color:"blue-grey-darken-1"},null,8,["onClick"])]),_:2},1024)],64))),128)),e(se)]),_:1}),e(N,{class:"mb-5 px-15 text-left"},{default:t(()=>[e(o,{md:"2"}),e(o,{cols:"12",md:"3",class:"my-auto form-label text-h5",style:{"font-size":"18px"}},{default:t(()=>[E("電子信箱")]),_:1}),($(!0),D(W,null,te(w.value,f=>($(),ie(o,{key:f.id,cols:"12",md:"4",class:"my-auto"},{default:t(()=>[u("p",Gt,P(f.email),1)]),_:2},1024))),128)),e(se)]),_:1}),e(N,{class:"mb-5 px-15 text-left"},{default:t(()=>[e(o,{md:"2"}),e(o,{cols:"12",md:"3",class:"my-auto form-label text-h5",style:{"font-size":"18px"}},{default:t(()=>[E("密碼")]),_:1}),($(!0),D(W,null,te(w.value,f=>($(),D(W,{key:f.id},[e(o,{cols:"12",md:"4",class:"my-auto"},{default:t(()=>[f.passwordisEditing?($(),ie(Re,{key:1,class:"form-label",style:{"font-size":"18px"},variant:"outlined","single-line":"",density:"comfortable",clearable:"",dense:"",modelValue:s(y),"onUpdate:modelValue":L[3]||(L[3]=C=>Ie(y)?y.value=C:null),"error-messages":s(c),onKeydown:xe(C=>le(f),["enter"])},null,8,["modelValue","error-messages","onKeydown"])):($(),D("p",Yt,P(f.password),1))]),_:2},1024),e(o,{md:"3",class:"ps-10"},{default:t(()=>[e(ee,{onClick:C=>H(f),icon:"mdi-pencil",variant:"text",color:"blue-grey-darken-1"},null,8,["onClick"])]),_:2},1024)],64))),128)),e(se)]),_:1}),e(K,{text:"提交",class:"mx-auto bg-accent my-5 text-h6",width:"100",height:"35"})]),_:1})])]),_:1})]),_:1},8,["onSubmit","disabled"])]),_:1})}}},Jt=He(Zt,[["__scopeId","data-v-68768f11"]]),Qt={__name:"shareReplyTable",setup(Y){const{api:me,apiAuth:B}=ge(),_=pe(),G=n(8),U=n([{key:"createdAt",order:"desc"}]),k=n(1),w=n([]),I=[{title:"物資",align:"center",sortable:!1,key:"image"},{title:"索取者聯絡資訊",align:"center",sortable:!1,key:"donations"}],q=n(!0),S=n(0),z=async A=>{var m,y,c,g;A&&(k.value=1),q.value=!0;try{const{data:b}=await B.get("/user/share",{params:{page:k.value,itemsPerPage:G.value,sortBy:((m=U.value[0])==null?void 0:m.key)||"createdAt",sortOrder:((y=U.value[0])==null?void 0:y.order)||"desc"}});console.log(b.result.data);const h=b.result.data.filter(H=>H.donations&&H.donations.length>0);w.value.splice(0,w.value.length,...h),S.value=h.length}catch(b){console.log(b),_({text:((g=(c=b==null?void 0:b.response)==null?void 0:c.data)==null?void 0:g.message)||"發生錯誤",snackbarProps:{color:"red"}})}q.value=!1};return z(),(A,m)=>{const y=re("router-link");return $(),ie(Ve,{"items-per-page":G.value,"onUpdate:itemsPerPage":[m[0]||(m[0]=c=>G.value=c),m[3]||(m[3]=c=>z(!1))],"sort-by":U.value,"onUpdate:sortBy":[m[1]||(m[1]=c=>U.value=c),m[4]||(m[4]=c=>z(!1))],page:k.value,"onUpdate:page":[m[2]||(m[2]=c=>k.value=c),m[5]||(m[5]=c=>z(!1))],items:w.value,headers:I,loading:q.value,"items-length":S.value,hover:"",class:"w-75 mx-auto rounded-lg mb-15 text-body-1"},{"item.image":t(({item:c})=>[e(o,{cols:"12",md:"4",class:"mx-auto",style:{width:"300px"}},{default:t(()=>[e(y,{to:"/material/share/"+c._id,style:{"text-decoration":"none"}},{default:t(()=>[e(be,{src:c.image,width:"250px","max-height":"200px",class:"my-5"},null,8,["src"])]),_:2},1032,["to"])]),_:2},1024)]),"item.donations":t(({item:c})=>[e(o,null,{default:t(()=>[($(!0),D(W,null,te(c.donations,(g,b)=>($(),ie(ce,{class:"mb-2",outlined:"",variant:"text",key:b},{default:t(()=>[e(_e,null,{default:t(()=>[e(N,{"no-gutters":""},{default:t(()=>[e(o,{cols:"3",class:"text-body-1 text-left"},{default:t(()=>[E("數量: "+P(g.quantity),1)]),_:2},1024),e(o,{cols:"5",class:"text-body-1 text-left"},{default:t(()=>[E("服務單位: "+P(g.donator),1)]),_:2},1024),e(o,{cols:"4",class:"text-body-1 text-left"},{default:t(()=>[E("聯絡電話: "+P(g.phone),1)]),_:2},1024)]),_:2},1024),e(se,{class:"100%"})]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["items-per-page","sort-by","page","items","loading","items-length"])}}},Xt={__name:"findReplyTable",setup(Y){const{api:me,apiAuth:B}=ge(),_=pe(),G=n(8),U=n([{key:"createdAt",order:"desc"}]),k=n(1),w=n([]),I=[{title:"物資",align:"center",sortable:!1,key:"image"},{title:"捐贈者聯絡資訊",align:"center",sortable:!1,key:"donations"}],q=n(!0),S=n(0),z=async A=>{var m,y,c,g;A&&(k.value=1),q.value=!0;try{const{data:b}=await B.get("/user/find",{params:{page:k.value,itemsPerPage:G.value,sortBy:((m=U.value[0])==null?void 0:m.key)||"createdAt",sortOrder:((y=U.value[0])==null?void 0:y.order)||"desc"}});console.log(b.result.data);const h=b.result.data.filter(H=>H.donations&&H.donations.length>0);w.value.splice(0,w.value.length,...h),S.value=h.length}catch(b){console.log(b),_({text:((g=(c=b==null?void 0:b.response)==null?void 0:c.data)==null?void 0:g.message)||"發生錯誤",snackbarProps:{color:"red"}})}q.value=!1};return z(),(A,m)=>{const y=re("router-link");return $(),ie(Ve,{"items-per-page":G.value,"onUpdate:itemsPerPage":[m[0]||(m[0]=c=>G.value=c),m[3]||(m[3]=c=>z(!1))],"sort-by":U.value,"onUpdate:sortBy":[m[1]||(m[1]=c=>U.value=c),m[4]||(m[4]=c=>z(!1))],page:k.value,"onUpdate:page":[m[2]||(m[2]=c=>k.value=c),m[5]||(m[5]=c=>z(!1))],items:w.value,headers:I,loading:q.value,"items-length":S.value,hover:"",class:"w-75 mx-auto rounded-lg mb-15 text-body-1"},{"item.image":t(({item:c})=>[e(o,{cols:"12",md:"4",class:"mx-auto",style:{width:"250px"}},{default:t(()=>[e(y,{to:"/material/find/"+c._id,style:{"text-decoration":"none"}},{default:t(()=>[e(be,{src:c.image,width:"250px","max-height":"150px",class:"my-5"},null,8,["src"])]),_:2},1032,["to"])]),_:2},1024)]),"item.donations":t(({item:c})=>[e(o,null,{default:t(()=>[($(!0),D(W,null,te(c.donations,(g,b)=>($(),ie(ce,{class:"mb-2",outlined:"",variant:"text",key:b},{default:t(()=>[e(_e,null,{default:t(()=>[e(N,{"no-gutters":""},{default:t(()=>[e(o,{cols:"3",class:"text-body-1 text-left"},{default:t(()=>[E("數量: "+P(g.quantity),1)]),_:2},1024),e(o,{cols:"5",class:"text-body-1 text-left"},{default:t(()=>[E("服務單位: "+P(g.donator),1)]),_:2},1024),e(o,{cols:"4",class:"text-body-1 text-left"},{default:t(()=>[E("聯絡電話: "+P(g.phone),1)]),_:2},1024)]),_:2},1024),e(se,{class:"100%"})]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["items-per-page","sort-by","page","items","loading","items-length"])}}},el=u("h2",{class:"my-5 bg-accent text-center mx-auto w-75"},"地標管理",-1),tl={style:{width:"240px"}},ll={style:{width:"120px"}},al={style:{width:"300px"},class:"text-left"},sl={style:{width:"200px"},class:"text-center"},ol={style:{width:"350px"},class:"py-2 text-left"},nl={style:{width:"80px"}},rl={class:"px-6 my-2"},dl=u("label",{class:"form-label"},"服務地址",-1),ul=u("label",{class:"form-label"},"服務名稱",-1),il=u("label",{class:"form-label"},"服務電話",-1),cl=u("label",{class:"form-label"},"服務項目",-1),ml=u("p",null,"服務對象",-1),pl=u("p",null,"長期照顧",-1),gl=u("p",null,"身心障礙",-1),vl=u("p",null,"兒童及少年",-1),fl=u("p",null,"社會救助",-1),yl=u("p",null,"婦女",-1),bl=u("p",null,"其他",-1),xl=u("label",{class:"form-label"},"服務介紹",-1),_l={__name:"landmarkTable",setup(Y){const{api:me,apiAuth:B}=ge(),_=pe(),G=["長期照顧","身心障礙","婦女","兒童及少年","保護性服務"],U=["日照中心","護理之家","居家服務","交通接送","家庭托顧"],k=["身心障礙者服務中心","輔具中心","職業重建中心","小作所","庇護工場"],w=["少年福利服務中心","親子館","課後班"],I=["經濟補助","待用餐","基金會","社會福利中心"],q=["婦女福利服務中心","新住民家庭服務中心"],S=n(10),z=n([{key:"createdAt",order:"desc"}]),A=n(1),m=n([]),y=[{title:"服務名稱",align:"center",sortable:!1,key:"name"},{title:"地址",align:"center",sortable:!0,key:"address"},{title:"聯絡電話",align:"center",sortable:!1,key:"tel"},{title:"服務項目",align:"center",sortable:!0,key:"categories"},{title:"服務介紹",align:"center",sortable:!1,key:"description"},{title:"操作",align:"center",sortable:!1,key:"action"}],c=n(!0),g=n(0),b=n(""),h=async j=>{var p,X,Z,ae;j&&(A.value=1),c.value=!0;try{const{data:ne}=await B.get("/user/landmark",{params:{page:A.value,itemsPerPage:S.value,sortBy:((p=z.value[0])==null?void 0:p.key)||"createdAt",sortOrder:((X=z.value[0])==null?void 0:X.order)||"desc",search:b.value}});console.log(ne),m.value.splice(0,m.value.length,...ne.result.data),g.value=ne.result.total}catch(ne){console.log(ne),_({text:((ae=(Z=ne==null?void 0:ne.response)==null?void 0:Z.data)==null?void 0:ae.message)||"發生錯誤",snackbarProps:{color:"red"}})}c.value=!1};h();const H=n({open:!1}),le=j=>{H.value.open=!0,H.value.id=j._id,C.value.value=j.name,O.value.value=j.tel,v.value.value=j.description},F=()=>{H.value.open=!1,f()},L=Se({name:T().required("服務單位必填"),address:T().required("服務地址必填"),tel:T(),category5:ve().of(T()).required("分類必填"),category2:ve().of(T()).required("分類必填"),category3:ve().of(T()).required("分類必填"),category4:ve().of(T()).required("分類必填"),category5:ve().of(T()).required("分類必填"),category6:ve().of(T()).required("分類必填"),category7:ve().of(T()).required("分類必填"),description:T()}),{handleSubmit:R,isSubmitting:K,resetForm:f}=Ce({validationSchema:L,initialValues:{name:"",address:"",tel:"",category1:[],category2:[],category3:[],category4:[],category5:[],category6:[],category7:[],description:""}}),C=M("name"),O=M("tel"),J=M("category1"),Q=M("category2"),de=M("category3"),ue=M("category4"),d=M("category5"),l=M("category6"),V=M("category7"),v=M("description"),{value:i,errorMessage:x}=M("address"),a="AIzaSyAyML8H2ENbc_kzs_ZSI6qYf7CCbBt0dAA";console.log(a);const oe=n(null),Ee=n(null),Le=async()=>{if(!i.value){alert("找不到地址~");return}const j=`https://maps.googleapis.com/maps/api/geocode/json?address=${encodeURIComponent(i.value)}&key=${a}`;try{const X=(await Xe.get(j)).data;if(console.log(X),X.results&&X.results.length>0){const Z=X.results[0].geometry.location.lat,ae=X.results[0].geometry.location.lng;oe.value=Z,Ee.value=ae,console.log(oe.value),console.log(X.results),console.log(Z),console.log(ae)}else alert("找不到地址~")}catch(p){console.error("新增地標錯誤:",p),alert("新增地標失敗~")}},We=R(async j=>{var p,X;try{await Le(),console.log(oe.value);const Z=[...j.category1,...j.category2,...j.category3,...j.category4,...j.category5,...j.category6,...j.category7],ae={name:j.name,address:j.address,tel:j.tel,categories:Z,description:j.description,lat:oe.value,lng:Ee.value};console.log(ae),await B.patch("landmark/"+H.value.id,ae),_({text:"修改成功",snackbarProps:{color:"green"}}),F(),f(),h(!0)}catch(Z){console.log(Z),_({text:((X=(p=Z==null?void 0:Z.response)==null?void 0:p.data)==null?void 0:X.message)||"發生錯誤",snackbarProps:{color:"red"}})}});Ae(b,()=>{h(!0)});const Ge=async j=>{var p,X;try{await B.delete(`/landmark/${j._id}`),_({text:"刪除成功",snackbarProps:{color:"green"}}),h(!0)}catch(Z){console.log(Z),_({text:((X=(p=Z==null?void 0:Z.response)==null?void 0:p.data)==null?void 0:X.message)||"發生錯誤",snackbarProps:{color:"red"}})}};return(j,p)=>{const X=$e,Z=$e,ae=Be,ne=st;return $(),D(W,null,[el,e(Ve,{"items-per-page":S.value,"onUpdate:itemsPerPage":[p[3]||(p[3]=r=>S.value=r),p[6]||(p[6]=r=>h(!1))],"sort-by":z.value,"onUpdate:sortBy":[p[4]||(p[4]=r=>z.value=r),p[7]||(p[7]=r=>h(!1))],page:A.value,"onUpdate:page":[p[5]||(p[5]=r=>A.value=r),p[8]||(p[8]=r=>h(!1))],items:m.value,headers:y,loading:c.value,"items-length":g.value,search:b.value,hover:"",class:"w-75 mx-auto b-1 rounded-lg mb-15 px-8 text-body-1"},{top:t(()=>[e(X,{class:"my-5",modelValue:b.value,"onUpdate:modelValue":p[0]||(p[0]=r=>b.value=r),onClickAppend:p[1]||(p[1]=r=>h(!0)),onKeydown:p[2]||(p[2]=xe(r=>h(!0),["enter"])),"max-width":"100%"},null,8,["modelValue"])]),"item.name":t(({item:r})=>[u("td",tl,P(r.name),1)]),"item.tel":t(({item:r})=>[u("td",ll,P(r.tel),1)]),"item.address":t(({item:r})=>[u("td",al,P(r.address),1)]),"item.categories":t(({item:r})=>[u("td",sl,P(r.categories.join(" , ")),1)]),"item.description":t(({item:r})=>[u("td",ol,P(r.description),1)]),"item.action":t(({item:r})=>[u("td",nl,[E(P(r.action)+" ",1),e(ee,{icon:"mdi-pencil",variant:"text",color:"grey-darken-2",onClick:Ye=>le(r)},null,8,["onClick"]),e(ee,{icon:"mdi-delete",variant:"text",color:"red-darken-4",onClick:Ye=>Ge(r)},null,8,["onClick"])])]),_:2},1032,["items-per-page","sort-by","page","items","loading","items-length","search"]),e(Te,{"max-width":"700",modelValue:H.value.open,"onUpdate:modelValue":p[20]||(p[20]=r=>H.value.open=r)},{default:t(()=>[e(ce,null,{default:t(()=>[e(Oe,{color:"secondary",prominent:"",class:"bb-1"},{default:t(()=>[e(Ne,{class:"mt-3 text-center font-weight-bold"},{default:t(()=>[E(" 修改地標 ")]),_:1})]),_:1}),u("div",rl,[e(Me,{onSubmit:Ue(s(We),["prevent"]),disabled:s(K)},{default:t(()=>[e(N,{class:"my-1"},{default:t(()=>[e(o,{cols:"12",md:"3",class:"my-auto text-center ps-6"},{default:t(()=>[dl]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(Z,{modelValue:s(i),"onUpdate:modelValue":p[9]||(p[9]=r=>Ie(i)?i.value=r:null),"error-messages":s(x),label:"輸入資源地址","max-width":"1000px"},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-center ps-6"},{default:t(()=>[ul]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(ae,{modelValue:s(C).value.value,"onUpdate:modelValue":p[10]||(p[10]=r=>s(C).value.value=r),"error-messages":s(C).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"my-auto text-center ps-6"},{default:t(()=>[il]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(ae,{modelValue:s(O).value.value,"onUpdate:modelValue":p[11]||(p[11]=r=>s(O).value.value=r),"error-messages":s(O).errorMessage.value},null,8,["modelValue","error-messages"])]),_:1}),e(o,{cols:"12",md:"3",class:"mt-2 text-center ps-6"},{default:t(()=>[cl]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(ot,{variant:"accordion"},{default:t(()=>[e(nt,{title:"選擇類別"},{default:t(()=>[e(rt,null,{default:t(()=>[e(ke,null,{default:t(()=>[e(N,null,{default:t(()=>[e(o,null,{default:t(()=>[ml,u("div",null,[e(fe,{modelValue:s(J).value.value,"onUpdate:modelValue":p[12]||(p[12]=r=>s(J).value.value=r),"error-messages":s(J).errorMessage.value,column:"",multiple:""},{default:t(()=>[($(),D(W,null,te(G,r=>e(ye,{text:r,value:r,filter:"",density:"compact"},null,8,["text","value"])),64))]),_:1},8,["modelValue","error-messages"])]),e(se)]),_:1})]),_:1}),e(N,null,{default:t(()=>[e(o,null,{default:t(()=>[pl,u("div",null,[e(fe,{modelValue:s(Q).value.value,"onUpdate:modelValue":p[13]||(p[13]=r=>s(Q).value.value=r),"error-messages":s(Q).errorMessage.value,column:"",multiple:""},{default:t(()=>[($(),D(W,null,te(U,r=>e(ye,{text:r,value:r,filter:"",density:"compact"},null,8,["text","value"])),64))]),_:1},8,["modelValue","error-messages"])]),e(se)]),_:1})]),_:1}),e(N,null,{default:t(()=>[e(o,null,{default:t(()=>[gl,u("div",null,[e(fe,{modelValue:s(de).value.value,"onUpdate:modelValue":p[14]||(p[14]=r=>s(de).value.value=r),"error-messages":s(de).errorMessage.value,column:"",multiple:""},{default:t(()=>[($(),D(W,null,te(k,r=>e(ye,{text:r,value:r,filter:"",density:"compact"},null,8,["text","value"])),64))]),_:1},8,["modelValue","error-messages"])]),e(se)]),_:1})]),_:1}),e(N,null,{default:t(()=>[e(o,null,{default:t(()=>[vl,u("div",null,[e(fe,{modelValue:s(ue).value.value,"onUpdate:modelValue":p[15]||(p[15]=r=>s(ue).value.value=r),"error-messages":s(ue).errorMessage.value,column:"",multiple:""},{default:t(()=>[($(),D(W,null,te(w,r=>e(ye,{text:r,value:r,filter:"",density:"compact"},null,8,["text","value"])),64))]),_:1},8,["modelValue","error-messages"])]),e(se)]),_:1})]),_:1}),e(N,null,{default:t(()=>[e(o,null,{default:t(()=>[fl,u("div",null,[e(fe,{modelValue:s(d).value.value,"onUpdate:modelValue":p[16]||(p[16]=r=>s(d).value.value=r),"error-messages":s(d).errorMessage.value,column:"",multiple:""},{default:t(()=>[($(),D(W,null,te(I,r=>e(ye,{text:r,value:r,filter:"",density:"compact"},null,8,["text","value"])),64))]),_:1},8,["modelValue","error-messages"])]),e(se)]),_:1})]),_:1}),e(N,null,{default:t(()=>[e(o,null,{default:t(()=>[yl,u("div",null,[e(fe,{modelValue:s(V).value.value,"onUpdate:modelValue":p[17]||(p[17]=r=>s(V).value.value=r),"error-messages":s(V).errorMessage.value,column:"",multiple:""},{default:t(()=>[($(),D(W,null,te(q,r=>e(ye,{text:r,value:r,filter:"",density:"compact"},null,8,["text","value"])),64))]),_:1},8,["modelValue","error-messages"])]),e(se)]),_:1})]),_:1}),e(N,null,{default:t(()=>[e(o,null,{default:t(()=>[bl,e(fe,{modelValue:s(l).value.value,"onUpdate:modelValue":p[18]||(p[18]=r=>s(l).value.value=r),"error-messages":s(l).errorMessage.value,column:"",multiple:""},{default:t(()=>[e(ye,{value:"其他",text:"其他",filter:"",density:"compact"})]),_:1},8,["modelValue","error-messages"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(o,{cols:"12",md:"3",class:"text-center ps-6"},{default:t(()=>[xl]),_:1}),e(o,{cols:"12",md:"9"},{default:t(()=>[e(Ke,{style:{"white-space":"pre-line"},variant:"outlined",clearable:"",modelValue:s(v).value.value,"onUpdate:modelValue":p[19]||(p[19]=r=>s(v).value.value=r),"error-messages":s(v).errorMessage.value,"hide-details":""},null,8,["modelValue","error-messages"])]),_:1})]),_:1}),e(N,null,{default:t(()=>[e(o,{class:"text-center"},{default:t(()=>[e(ne,{type:"submit",class:"b-1 bg-accent mb-8",onClick:Le})]),_:1})]),_:1})]),_:1},8,["onSubmit","disabled"])])]),_:1})]),_:1},8,["modelValue"])],64)}}},Vl={class:"d-flex flex-row"},kl={class:"mx-auto mb-5 rounded-lg"},wl={class:"mx-auto mb-5 rounded-lg"},hl={class:"mx-auto mb-5 rounded-lg"},$l={class:"mx-auto mb-5 rounded-lg"},Pl={__name:"setting",setup(Y){const{api:me,apiAuth:B}=ge(),_=pe();n(null),n([]),n([]);const G=n([{title:"會員中心",disabled:!1,href:"/setting"},{title:"地標管理",disabled:!0}]),U=n([{title:"會員中心",disabled:!1,href:"/setting"},{title:"貼文管理",disabled:!0}]),k=n([{title:"會員中心",disabled:!1,href:"/setting"},{title:"活動收藏",disabled:!0}]),w=n([{title:"會員中心",disabled:!1,href:"/setting"},{title:"物資管理",disabled:!0}]),I=n("option-1"),q=n("true"),S=n([]),z=async()=>{try{const{data:m}=await B.get("/user/mark");S.value=m.map(y=>({...y,isFavorite:!0}))}catch(m){console.error("Failed to fetch favorite event details:",m)}},A=async m=>{try{await B.patch("/user/mark",{eventId:m}),S.value=S.value.filter(y=>y._id!==m),_({text:"取消收藏",snackbarProps:{color:"info"}})}catch(y){console.error("取消收藏失败",y),_({text:"取消收藏失败",snackbarProps:{color:"red"}})}};return et(()=>{z()}),(m,y)=>{const c=re("router-link");return $(),D(W,null,[e(it,{class:"b-1 text-center",width:"250"},{default:t(()=>[e(dt,{modelValue:I.value,"onUpdate:modelValue":y[0]||(y[0]=g=>I.value=g),color:"teal-darken-4",direction:"vertical","show-arrows":""},{default:t(()=>[e(we,{"prepend-icon":"mdi-account",text:"基本資料",value:"option-1",height:"100",class:"text-body-1 ms-1"}),e(we,{"prepend-icon":"mdi-lock",text:"地標管理",value:"option-2",height:"100",class:"text-body-1 ms-1"}),e(we,{"prepend-icon":"mdi-access-point",text:"貼文管理",value:"option-3",height:"100",class:"text-body-1 ms-1"}),e(we,{"prepend-icon":"mdi-book-cog",text:"活動收藏",value:"option-4",height:"100",class:"text-body-1 ms-1"}),e(we,{"prepend-icon":"mdi-package-variant-closed-check",text:"物資管理",value:"option-5",height:"100",class:"text-body-1 ms-1"})]),_:1},8,["modelValue"])]),_:1}),e(ce,{class:"h-100"},{default:t(()=>[u("div",Vl,[e(ke,null,{default:t(()=>[e(ut,{modelValue:I.value,"onUpdate:modelValue":y[1]||(y[1]=g=>I.value=g),class:"my-10"},{default:t(()=>[e(he,{value:"option-1"},{default:t(()=>[e(Jt)]),_:1}),e(he,{value:"option-2"},{default:t(()=>[e(ze,{items:G.value},{divider:t(()=>[e(qe,{icon:"mdi-chevron-right"})]),_:1},8,["items"]),e(_l)]),_:1}),e(he,{value:"option-3"},{default:t(()=>[e(ze,{items:U.value},{divider:t(()=>[e(qe,{icon:"mdi-chevron-right"})]),_:1},8,["items"]),u("div",kl,[e(jt)]),u("div",wl,[e(zt)]),u("div",hl,[e(kt)])]),_:1}),e(he,{value:"option-4"},{default:t(()=>[e(ze,{items:k.value},{divider:t(()=>[e(qe,{icon:"mdi-chevron-right"})]),_:1},8,["items"]),($(!0),D(W,null,te(S.value,g=>($(),D("div",{class:"w-66 mx-auto rounded-lg my-5",style:{border:"1.2px solid #000"},key:g._id},[e(ce,{variant:"flat",class:"rounded-lg"},{default:t(()=>[e(N,{class:"align-center my-4 ps-10"},{default:t(()=>[e(o,{cols:"3",class:"align-self-start"},{default:t(()=>[e(c,{to:"/event/"+g._id,style:{"text-decoration":"none"}},{default:t(()=>[e(be,{src:g.image,class:"b-1 rounded-lg",width:"250px",height:"280px",cover:""},null,8,["src"])]),_:2},1032,["to"])]),_:2},1024),e(o,{cols:"7",class:"align-self-start"},{default:t(()=>[e(_e,{class:"text-h5 font-weight-black"},{default:t(()=>[E(P(g.title),1)]),_:2},1024),e(tt,{class:"text-h6"},{default:t(()=>[E(P(g.organizer),1)]),_:2},1024),e(Pe,{class:"text-h6"},{default:t(()=>[E(P(g.date),1)]),_:2},1024)]),_:2},1024),e(o,{cols:"2",class:"align-self-start mt-2"},{default:t(()=>[q.value?($(),ie(ee,{key:0,id:"btn",text:"取消收藏","prepend-icon":"mdi-bookmark",variant:"outlined",style:{"background-color":"#F5B4B4"},onClick:b=>A(g._id),class:"font-weight-black text-body-1",width:"140",height:"40"},null,8,["onClick"])):lt("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))]),_:1}),e(he,{value:"option-5"},{default:t(()=>[e(ze,{items:w.value},{divider:t(()=>[e(qe,{icon:"mdi-chevron-right"})]),_:1},8,["items"]),u("div",$l,[e(Qt),e(Xt)])]),_:1})]),_:1},8,["modelValue"])]),_:1})])]),_:1})],64)}}},Gl=He(Pl,[["__scopeId","data-v-70fafcf3"]]);export{Gl as default};
